Progress in Oceanography 67 (2005) 84–159

Progress in Oceanography
www.elsevier.com/locate/pocean

The Lagrangian Ensemble metamodel for simulating plankton ecosystems
J.D. Woods
Department of Earth Science and Engineering, Imperial College, London SW7 2AZ, United Kingdom Received 1 June 2002; received in revised form 15 April 2005; accepted 20 April 2005 Available online 3 August 2005

Abstract
This paper presents a detailed account of the Lagrangian Ensemble (LE) metamodel for simulating plankton ecosystems. It uses agent-based modelling to describe the life histories of many thousands of individual plankters. The demography of each plankton population is computed from those life histories. So too is bio-optical and biochemical feedback to the environment. The resulting ‘‘virtual ecosystem’’ is a comprehensive simulation of the plankton ecosystem. It is based on phenotypic equations for individual micro-organisms.
LE modelling diﬀers signiﬁcantly from population-based modelling. The latter uses prognostic equations to compute demography and biofeedback directly. LE modelling diagnoses them from the properties of individual micro-organisms, whose behaviour is computed from prognostic equations. That indirect approach permits the ecosystem to adjust gracefully to changes in exogenous forcing.
The paper starts with theory: it deﬁnes the Lagrangian Ensemble metamodel and explains how LE code performs a number of computations ‘‘behind the curtain’’. They include budgeting chemicals, and deriving biofeedback and demography from individuals. The next section describes the practice of LE modelling. It starts with designing a model that complies with the LE metamodel. Then it describes the scenario for exogenous properties that provide the computation with initial and boundary conditions. These procedures diﬀer signiﬁcantly from those used in populationbased modelling.
The next section shows how LE modelling is used in research, teaching and planning. The practice depends largely on hindcasting to overcome the limits to predictability of weather forecasting. The scientiﬁc method explains observable ecosystem phenomena in terms of ﬁner-grained processes that cannot be observed, but which are controlled by the basic laws of physics, chemistry and biology. What-If? Prediction (WIP), used for planning, extends hindcasting by adding events that describe natural or man-made hazards and remedial actions. Veriﬁcation is based on the Ecological Turing Test, which takes account of uncertainties in the observed and simulated versions of a target ecological phenomenon.
The rest of the paper is devoted to a case study designed to show what LE modelling oﬀers the biological oceanographer. The case study is presented in two parts. The ﬁrst documents the WB model (Woods & Barkmann, 1994) and scenario used to simulate the ecosystem in a mesocosm moored in deep water oﬀ the Azores. The second part illustrates
E-mail address: j.woods@imperial.ac.uk
0079-6611/$ - see front matter Ó 2005 Elsevier Ltd. All rights reserved. doi:10.1016/j.pocean.2005.04.003

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

85

the emergent properties of that virtual ecosystem. The behaviour and development of an individual plankton lineage are revealed by an audit trail of the agent used in the computation. The ﬁelds of environmental properties reveal the impact of biofeedback. The ﬁelds of demographic properties show how changes in individuals cumulatively aﬀect the birth and death rates of their population.
This case study documents the virtual ecosystem used by Woods, Perilli and Barkmann (2005; hereafter WPB); to investigate the stability of simulations created by the Lagrangian Ensemble metamodel. The Azores virtual ecosystem was created and analysed on the Virtual Ecology Workbench (VEW) which is described brieﬂy in the Appendix. Ó 2005 Elsevier Ltd. All rights reserved.

Keywords: Plankton ecosystem modelling; Lagrangian Ensemble method; Mathematical simulation; Virtual ecology; Azores

1. Introduction
Mathematical simulation of the plankton ecosystem starts with the choice of metamodel.1 It provides the logical framework for the simulation. The speciﬁcations of (1) the model (set of equations), (2) the scenario (initial and boundary conditions), and (3) the method of integration must all comply with the chosen metamodel. It determines the internal functioning of the simulation and the nature of its emergent properties. Also, it aﬀects their stability and, therefore, determines the limits of predictability.
1.1. Metamodels
We can classify simulations of the plankton ecosystem in terms of three metamodels, which diﬀer in the way they aggregate the plankton. The ﬁrst is the box metamodel, which predicts changes in each population on average in some spatial component of the ecosystem, such as the mixed layer or the thermocline. The second is the ﬁeld metamodel, which describes each population in terms of a spatial ﬁeld. The third is the individual-based metamodel, which describes each population in terms of single organisms. The biological agents of box and ﬁeld models are populations; the agents of individual-based models are plankters. The computational complexity of a simulation increases with metamodel order, from box, through ﬁeld to individual-based. It has become possible to advance to the higher levels as more powerful computers have become available.
Twenty-ﬁve years ago, the ﬁrst supercomputers made it possible to consider realistic simulation of the plankton ecosystem with an individual-based metamodel. Implementation required some innovative software engineering. What emerged was a hybrid metamodel, which combined the ﬁeld and individual approaches. I named this the Lagrangian Ensemble (LE) metamodel because it uses biologically-lagrangian integration to follow the life history of each plankter, and ensemble statistics to compute the bulk properties of whole populations. It was ﬁrst used to simulate the response of phytoplankton to diurnal variation in the depth of the surface mixing layer (Woods & Onken, 1982). The LE metamodel has since been extended to permit comprehensive simulation of the ecosystems with any degree of complexity in the plankton community and environment.
1.2. Agents
The strength of the LE metamodel lies in its ability to compute ﬁeld properties like biofeedback and demography from the behaviour of individual plankters. It achieves that through agent-based computing.
1 A metamodel formalizes the process of modelling, just as WitgensteinÕs concept of a metalanguage makes it possible to analyse the meaning of language.

86 J.D. Woods / Progress in Oceanography 67 (2005) 84–159

Table 1 Some examples of diﬀerent metamodels Metamodel General review
Population-based equations
Box metamodel Individual-based
Lagrangian Ensemble

Publications
Carlotti et al. (2000) Totterdel (1993) Pinardi and Woods (2002)
Mangel (1988) Evans and Fasham (1993) Fasham et al. (1993) Popova et al. (1997) Baretta et al. (1997)
Truscott and Brindley (1994) Edwards and Brindley (1996, 1999)
Broekhuizen (1999) Carlotti and Nival (1992) Fikson & Carlotti (1998)
Woods et al. (see list in References) Carlotti & Wolf (1998) Miller et al. (1998) Gurney et al. (2001)

Each agent has two attributes. It behaves like an individual plankter, and it carries information about a dynamic sub-population of the plankton population.2 A further strength is automatic control of model errors by splitting or combining sub-populations (Table 1).
1.3. Equations
The choice of metamodel determines the nature of the equations used in the model. In box and ﬁeld models, the biological equations describe the interactions between populations, expressed through biomass concentration in each box, or in each cell of the mesh respectively. Population-based equations are familiar from theoretical population ecology (Beddington, Cushing, May, & Steele, 1994; May, 1981). They are inspired by observations of the bulk properties of populations.
The individual-based metamodel permits the use of biological primitive equations.3 These phenotypic equations describe the locomotion, behaviour (e.g. migration and foraging), photosynthesis and nutrient uptake (in phytoplankton), ingestion, egestion and excretion (in zooplankton), respiration, adaptation, growth, metamorphosis, reproduction and death of an individual organism. It is reasonable to assume in the case of a micro-organism that these equations are controlled directly by its genes; so they are ﬁxed throughout its life, or adapt rationally in ways that are also controlled by the genes. They do not include the learned behaviour and choice of behaviour found in higher organisms (ﬁsh, reptiles, birds, mammals).
As a branch of individual-based modelling, the LE metamodel embraces this use of biological primitive equations for micro-organisms, such as plankton. That gives it a solid scientiﬁc base, which is not found in

2 This technique was a precursor of what later came to be called ‘‘super-individual modelling’’ in the theoretical ecology literature (Scheﬀer, Baveco, DeAngelis, Rose, & van Nes, 1995).
3 The expression ‘‘primitive equation modelling’’ comes from meteorology. Richardson (1922) showed how the weather could be predicted using numerical integration of non-linear primitive equations, each of which rested securely on the results of reproducible experiments performed under controlled conditions. Woods (2003) showed that this method could be extended to ecosystems in which biological primitive equations described the physiology and behaviour of micro-organisms like plankton.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

87

population-based modelling. It means that the simulated ecosystem can be explained in terms of fundamental properties that are known to be true because they are derived from reproducible experiments on plankton cultures. That makes plankton modelling in biological oceanography as secure as physical modelling in weather forecasting.
The computational cost of agent-based modelling used to implement LE is high but increasingly aﬀordable as more powerful personal computers become available. Some authors have used LE modelling as a benchmark for assessing the performance of faster parametric modelling. This is attractive for simulating large-scale three-dimensional structure in the plankton ecosystem (Gurney, Speirs, Wood, Clarke, & Heath, 2001).

1.4. Emergence

The LE metamodel simulates observable properties of the plankton ecosystem from the growth and behaviour of individual plankters, which are governed by primitive equations. This procedure is an example of a scientiﬁc discipline called complexity science (Waldrop, 1992), the hallmark of which is ‘‘emergence’’ (Johnson, 2001). The actions by millions of agents yield emergent properties that are often counter-intuitive, when intuition was honed on simpler models in which those bulk properties are state variables of the governing equations. Reynolds (2001) has discussed emergence in the diagnosis of plankton communities. The Lagrangian Ensemble metamodel brings emergence to prognostic biological oceanography. It leads to the scientiﬁc discipline of Virtual Ecology, which seeks to understand and predict observable properties of the plankton ecosystem by modelling individual plankters.

1.5. This paper

This paper does three things. Firstly, it provides a technical description of the Lagrangian Ensemble metamodel. Secondly, it describes the practice of LE modelling. And thirdly, it uses a case study to show how LE modelling serves biological oceanography. This is the ﬁrst comprehensive documentation of the method, which was described only brieﬂy in the LE publications catalogued in the bibliography.

2. Metamodel
We start by introducing generic aspects of LE modelling that apply to all virtual ecosystems regardless of the speciﬁcation for model equations or the scenario for initial and boundary conditions.
2.1. The Virtual Ecology Workbench
Good modelling practice demands that the computer code used to create a simulation (i.e. a virtual ecosystem) clearly separates the key components: metamodel, model, scenario, integration, logging and job control. That is not as easy at it sounds. Close inspection of LE codes written a few years ago has revealed parts that fail to live up to this standard. My research group has since built a CASE4 tool – the Virtual Ecology Workbench (VEW) – which guarantees best practice by automating the generation of run-time code according to formal rules. The VEW epitomizes LE modelling. Its functions will be mentioned later when I introduce the practice of LE modelling. A brief description of the VEW is given in Appendix.

4 Computer-Aided Software Engineering.

88 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
The VEW includes a number of functions that act ‘‘behind the curtain’’, i.e. not visible to the user. Most importantly, these provide the link between the individual and the ﬁeld descriptions. They also control errors and log emergent properties for inclusion in the ﬁnal data set. The VEW also constrains the design of the model and scenario. It includes a software tool to simplify designing biological equations that comply with the LE metamodel.
2.2. Virtual mesocosm
This paper describes one-dimensional implementation of the LE metamodel for use in the open ocean where the water depth exceeds 1 km. It is designed to simulate the ecosystem in a virtual mesocosm, which has a vertical axis extending down from the sea surface to a depth of, typically, 0.5 km.5 The mesocosm can be moored or it can drift with the ocean circulation. Air–sea ﬂuxes of solar and infra-red radiation, sensible and latent heat, water vapour and other gases pass though the upper boundary of the mesocosm. The lower boundary is open, allowing detritus to sink through to the deep ocean. Water ﬂows freely through the (virtual) side walls. However, in the present version of the metamodel I make the simplifying assumption that this horizontal advection produces zero ﬂux divergence in every ecosystem property at all depths.
There is no need to dwell here on the justiﬁcation for using a one-dimensional model to simulate the plankton ecosystem, since it is used widely. There are two grounds. The ﬁrst is that the plankton live mainly in the seasonal boundary layer of the ocean,6 which has a structure controlled largely by vertical ﬂuxes. The horizontal correlation scale of environmental variables is usually two orders of magnitude greater than the vertical scale. That leads to the second ground for using one-dimensional simulation. Plankton are microorganisms that cannot usefully change their ambient environment by swimming horizontally.7 However, many species of plankton do change their ambient environment by swimming vertically. One-dimensional modelling provides a very good ﬁrst approximation to the large-scale structure of the plankton ecosystem. The principal source of error arises from neglect of mesoscale turbulence, which contains fronts with short horizontal correlation scales. Simulating the plankton ecosystem at mesoscale fronts requires a threedimensional version of the LE metamodel (Rogers, 2005).
2.3. Time
The virtual ecosystem is computed in (typically) half-hour steps of Greenwich Mean Time (GMT). The longitude of the virtual mesocosm determines the GMT of local noon. The exogenous data (ERA40, OCCAM and NOAA) are stored in GMT. A correction for longitude is made during generation of the time series of solar radiation through the sea surface. A similar correction is made automatically by VEW Analyser to display emergent properties of the virtual ecosystem in local time.
2.4. Fields
The environment within the mesocosm comprises ﬁelds of physical, chemical and biological variables. Each ﬁeld is deﬁned by values in a one-dimensional (vertical) array of cells. These are the layers in the virtual mesocosm (Fig. 1). Conventionally they have a thickness of one metre, and a horizontal cross-section of one square metre, giving them a volume of one cubic metre. However, the precise structure can be
5 The mesocosm must extend down into the permanent thermocline throughout the simulation. 6 The seasonal boundary layer of the ocean extends from the sea surface to the permanent thermocline, 0 < z < Hmax, where Hmax(h, /) is the annual maximum depth of the mixed layer at a geographical location deﬁned by the latitude (h) and longitude (/). 7 This is my deﬁnition of plankton. It is more precise than the usual ‘‘micro-organisms that drift with the ocean currents’’.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

89

Fig. 1. The virtual mesocosm used in one-dimensional LE modelling. The horizontal cross-section area is shown here to be one square kilometre. It can equally well be described as one square metre. Either way the virtual ecosystem in the mesocosm is taken to represent the mean conditions in the area of the ocean resolved by the scenario, which is typically one degree of latitude and longitude, or about 100 km square.
adapted to suit each simulation. For example, it is often necessary to use thinner layers near the sea surface to compute the proﬁle of solar heating accurately (Woods, Barkmann, & Horch, 1984).
The physical ﬁelds include temperature, salinity, density, and solar irradiance in a number of wavebands (typically 25, of which 12 lie in PAR, the photosynthetically active range 400–700 nm). The chemical ﬁelds comprise dissolved and particulate forms of elements in various chemical species; they include both nutrients and contaminants. The particulate components are carried in living and dead plankton and in fæcal pellets, all of which are described individually (i.e. by Agents). The biological ﬁelds include demographic variables for each plankton population: they include the number of organisms and its rates of change due to reproduction, natural mortality, predation and migration.
2.5. Agents
The LE metamodel uses agent-based computing. Each agent has two attributes. It behaves like an individual plankter, and it carries information about a dynamic sub-population of the plankterÕs species. The individual plankter responds to its ambient environment, which is deﬁned as the set of values that the environmental ﬁelds have at its location (depth in this one-dimensional simulation). The total biomass of each species in the mesocosm equals the sum of its constituent sub-populations; the units are g C/m2.
Each agent contains a dynamic pool of every chemical element present in the simulation (Droop, 1968). That is its contribution to the particulate component of those chemicals. The carbon pools rise in response to photosynthesis (in the phytoplankton) and ingestion (by the zooplankton); they fall in response to respiration, excretion (liquid) and egestion (solid fæcal pellets), reproduction and metamorphosis between growth stages. Nutrient and contaminant pools change similarly. In some LE biological models the chemical elements are stored in separate pools for diﬀerent components of the plankter. For example, a copepod may contain separate carbon pools for lipids, proteins and shell (Sinerchia, 2005). The ﬁrst two are volatile energy reserves, i.e. they can be consumed; the third is structural and is lost in moulting between stages.
The histories of dead plankton and fæcal pellets are also computed as agents in the simulation. They can be ingested by zooplankton. Otherwise, their chemical pools decline in response to microbial action, which slowly converts their particulate carbon into dissolved inorganic carbon; and similarly for other elements. The virtual ecosystem logs the residual ﬂux of chemicals in these detritus particles sinking through the open bottom of the mesocosm into the deep ocean.

90 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
2.6. Biofeedback
Biophysical feedback arises from the contribution that plankton make to the optical properties of the seawater. Biochemical feedback arises from conversion of chemical elements between dissolved and particulate forms. The metamodel code includes functions for computing biofeedback, i.e. the changes wrought in one time step by the plankton on the physical and chemical environment. It does this for each layer in the virtual mesocosm. To do so, it sums the contributions of each agent that spends all or part of the time step in that layer. Migrating zooplankton may spend only part of a time step in each of several layers.
2.7. Predation
The method of computing predation is one of the signature features of the Lagrangian Ensemble metamodel. Although plankters are described by agents in the simulation, predation is not computed by agent– agent interaction. To achieve acceptable accuracy in that way would require a very large number of agents; the computing cost would be too high. The LE metamodel economizes by computing the ingestion rate of a predator agent in terms of the prey concentration at its location. The latter is computed by summing over all prey sub-populations in that layer. The prey concentration is a component of the biological environment. It is this procedure that led me to describe the LE metamodel as a hybrid between the individualbased and the ﬁeld metamodels.
2.7.1. Depletion The number of prey eaten by each predator sub-population in a layer is computed as a function of four
factors: (1) the predatorÕs biochemical state, (2) its ambient environment, (3) the biological state of the prey, and (4) their concentration.8 This is repeated for all predators in the layer for all or part of the time step. That yields the probability of an individual prey plankter being eaten. The metamodel code converts that probability for one prey plankter into a depletion rate for the sub-population in its agent. This equivalence of probability and rate assumes that predation is an ergodic process. The total ingestion by all predators in the layer is extracted pro rata from the several prey sub-populations in the layer. This depletion rate has the units plankters/m2 per time step; so it does not need to be an integer.
2.8. Demography
The demographic properties of each plankton population are described by ﬁelds. They have values in each layer of the virtual mesocosm. The core variable is the number of plankters per cubic metre. The other demographic variables comprise the rates of change of that concentration due to various processes: reproduction, predation, natural mortality due to various causes (starvation, senescence, disease, etc.), and migration; in all cases the units are plankters per second per cubic metre. The metamodel code is responsible for computing the demography of each population every time step. It does so by analysing the changes in plankton sub-populations in each layer.
Thus, the demographic state of each population is an emergent property of the virtual ecosystem. It is a diagnostic property, like demography computed from observations. That is one of the hallmarks of simulations created by the LE metamodel. It diﬀers fundamentally from box and ﬁeld metamodels, which treat population concentrations as state variables in prognostic equations. Demography is not a biological property of Nature, but an artifact of science, or more precisely of theoretical population ecology. The LE
8 The predation function is featured in the model code, which will be described later. If, for example, the predator is using vision to ﬁnd its prey, that function will take account of the visibility of each prey plankter, which depends on its apparent size and ambient irradiance for the predatorÕs visual spectrum.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

91

metamodel respects that fact. It underpins the success of virtual ecology. For example, it produces the global stability of LE simulations (WPB). Virtual ecosystems are not prone to the artiﬁcial oscillations and chaos which are a hallmark of population-based models (May, 1973).

2.9. Plankter trajectories

Each agent in the computation describes the trajectory of an individual plankter as it moves up and down in the mesocosm under the inﬂuence of two processes: ﬂuid motion and its own behaviour. Fluid motion advects the plankter with the water: the plankterÕs behaviour moves it relative to the water. Behaviour is speciﬁed in the model code; it will be discussed later. The ﬂuid motion has two components. The ﬁrst is upwelling/downwelling, which is an exogenous property prescribed in the scenario (to be discussed later). The second is turbulence, which displaces the plankter randomly according to rules speciﬁed in the model. The metamodel contains a random number generator (RNG), which is used to control the displacement of particles (living and dead plankters and fæcal pellets) by turbulence. The VEW uses the Java ‘‘SecureRandom’’ RNG, which produces sequence of 1048 pseudo-random numbers, which do not repeat within the lifetime of a simulation. (An alternative is SPRNG, see http://sprng.cs.fsu.edu/).
This randomization of particle displacement in turbulent water (i.e. in the surface mixing layer) leads each plankton agent to follow a unique trajectory. Each has a diﬀerent history of depth, and therefore of ambient environment. At every time step the plankters in an agentÕs sub-population change their state according to biological equations that depend on their ambient environment. The biochemical state of every plankter in a sub-population is identical, because it depends on its previous history of ambient environment, and therefore on its trajectory.

2.10. Intra-population variability

The variation in trajectories created by turbulence produces a synoptic diversity in the biological state of plankters of the same species in any layer of the mesocosm. The statistical properties of those state variables are computed by the metamodel code. It includes the mean and standard deviation of each variable. These are properties of the population. Thus the weighted inter-sub-population variability in LE modelling simulates intra-population variability in nature. It has been pointed out by Lomnicki (1988, 1999) that neglecting intra-population variability can lead to biases in the demography computed in population-based modelling (i.e. in box and ﬁeld metamodels). That bias is largely avoided in LE modelling. The residual error can be controlled as follows.
The inter-sub-population variability provides a statistical estimate of the intra-population variability. The sampling error in that estimate depends on the number of sub-populations present in each layer. The error is smaller when the computation uses more agents to describe each population. Biofeedback and predation radiate these errors throughout the ecosystem, provoking errors in all the environmental and demographic ﬁelds.

2.11. Error management

The LE metamodel code makes it possible to limit the errors in emergent properties of the simulated ecosystem. The strategy is to ensure that each population is described by enough sub-populations with independent trajectories. This requires analysis and management of each population of agents. An agent is dropped from the computation when its sub-population falls to zero, which happens quite often. So, if nothing were done to correct it, the number of agents used to compute the biofeedback and demography of a population would decline, leading to poorer sampling of the intra-population variability.

92 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
The metamodel code includes a procedure for correcting this source of error. The procedure involves taking half of a sub-population associated with one agent and transferring it to a newly created agent, which then follows an independent trajectory. The user speciﬁes when such splitting should occur; for example, by requiring that the concentration of agents in any given layer should never fall below some minimum value, typically 200 agents/layer for a phytoplankton population. The agent with the most-populous sub-population is split. This reduces the range of sub-population sizes, and therefore the risk that demography will be biased by a small number of agents whose sub-populations have grown anomalously large. This happens by chance when they have trajectories that sample the environment favourably for demographic growth (i.e. more reproduction, less depletion by predation and natural mortality).
Computation eﬃciency requires that the number of agents should be no more than is required to achieve the speciﬁed accuracy in computing biofeedback and predation. The metamodel code includes a procedure for reducing the computation load by combining two or more agents that are in the same layer. They are replaced by a new agent with sub-population and chemical pools that combine those of the deleted agents. The plankters in the new sub-population have a biological state that is the weighted average of those that were combined. Their inter-sub-population variability is lost, so combination must be speciﬁed for conditions when that is not important; for example in the seasonal thermocline where there is no turbulence to generate trajectory diversity. Combination is particularly useful for agents that contain dead plankton, or fæcal pellets. Remineralization then acts on a single pool for each chemical in the combined agent, rather than separately for the constituent agents.
These procedures of agent splitting and combination are collectively called Particle management. It is a function of the LE metamodel, which controls errors and improves the speed of computation. The user speciﬁes the criteria for splitting and combination, but thereafter it occurs automatically without user involvement. The criteria do not aﬀect the design of the biological model.
However, the splitting and combination must be taken into account when computing the demography of a plankton population. That is done in two stages. During the run, a chronological register is created which logs all demographic events occuring in sub-populations including splitting and combination events. After the run, this register is analysed by the Lifespan program, which computes time series of life expectancy, birth rate, and death rate (for each cause of death), after correcting for artiﬁcial changes in sub-populations caused by splitting or combination (Brice, Lythgoe, & Woods, 1998).
2.12. Trophic closure
Realistic trophic closure is an essential part of the biological model, because every detail of the virtual ecosystem is sensitive to how closure is speciﬁed. It generates the trophic cascade in virtual ecosystems (Carpenter & Kitchell, 1993). The design of trophic closure must take account of the rules of the metamodel. The popular closure based on the square of the prey concentration (Steele & Henderson, 1995) is not permitted by the LE metamodel.
The LE metamodel requires trophic interaction to be expressed by an ingestion equation, in which the predator consumes its prey at a rate depending on prey concentration. The same rule applies to the top predators. Their prey are zooplankton that are described explicitly by a set of agents in the usual way. They are ingested by one or more populations of top predators. Each top predator population is deﬁned by the usual hierarchy of functional group/species/variety (see Fig. 2). A top predatorÕs ingestion equation featured in the biological model must comply with the rules of the LE metamodel. The ingestion rate of an individual top predator depends on four factors: (1) its biological state (e.g. size and the action spectrum of its visual pigments), (2) the ambient concentration of prey, (3) the biological state of the prey (e.g. its growth stage), and (4) the ambient environment (e.g. in the case of visual predation, solar irradiance in the spectral range of the top predatorÕs visual pigments). Depletion of each prey sub-population is computed in the normal way.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

93

Fig. 2. Generic plankton community, with its functional groups, species and varieties.
The population dynamics of top predators are deﬁned by three exogenous ﬁelds, the variables of which are (1) the biological state of the plankters, (2) the total number of top predators in the virtual mesocosm, and (3) the vertical distribution of that biomass. These properties are not aﬀected by processes in the virtual ecosystem: they are deﬁned by a special category of top predator (TP) equations. Because the properties are exogenous, these TP equations are speciﬁed as part of the scenario. They describe the variations of the three TP ﬁelds as functions of day of the year, time of day and depth. The latter two permit top predators to perform diel migration if that is deemed necessary.
The TP equations are derived from observations of the top predator species in the sea or in the laboratory. The designer can choose to make these functions as simple or as complex as necessary for a particular virtual ecosystem. In the Virtual Ecology Workbench, top predators are speciﬁed as functional groups in the plankton community (Fig. 2). The metamodel code recognizes any functional group that is identiﬁed as

94 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
a top predator and demands ingestion equations (in the model) and TP equations (in the scenario). Sinerchia (2005) has designed TP equations for squid feeding on copepods in his reformulation of the WB model.
2.13. Stochastic modelling
LE metamodelling is mainly deterministic. It is not based on the Monte Carlo method (Mangel & Clark, 1988) in which the outcome of predation events are determined stochastically. The LE metamodel avoids the need for that by basing predation on the concentration of prey, rather than on individual prey agents.
There is only one stochastic process in LE modelling, namely the displacement of a plankter by turbulence. The change in position is computed for each agent using a model of the turbulence and a random number generator (RNG). This leads the plankton agents of the same species to follow diﬀerent trajectories in the surface mixing layer. The resulting intra-population variability will be illustrated in the case study (Figs. 13 and 14).
The set of trajectories followed by the agents used to model a plankton population depends on the particular pseudo-random sequence of numbers created by the RNG. The sequence depends on the seed value used to initialize the RNG. Simulations that diﬀer only in seed value are called instances of the virtual ecosystem. WPB compare the statistics of an ensemble of such instances with inter-annual variability in a single instance. That measures the emergent ergodicity of the plankton populations in the virtual ecosystem.9
3. Model
The model code describes a set of equations and rules that comply with the LE metamodel. They include physical, chemical and biological variables. An LE model does not use partial diﬀerential equations, which deﬁne the continuous variation of a state variables, at least not in their raw state. The task of the LE equations/rules is to describe the values of state variables in the next time step. The process may be prognostic, in which case it is computed from the previous value plus a mean rate of change during the period of the time step, i.e. a ﬁnite-diﬀerence version of a diﬀerential equation. Or it may be diagnostic, in which case the new value depends only on the current state of the plankter and its ambient environment (i.e. the state of the environment at the location of the agent), which includes prey concentration. The change may also depend on rules involving Boolean statements. For convenience I shall refer in this paper to biological equations, which is taken to embrace both rules and equations, whether prognostic or diagnostic.
The form of every biological equation is constrained by the LE metamodel. The user must learn how to work within these constraints. The Virtual Ecology Workbench makes the task easy. It provides the Planktonica equation editor (Hinsley, 2005) which obeys the LE rules. The user assembles each equation from prescribed mathematical modules. The result is stored as a speciﬁcation ﬁle in XML. When complete, the VEW automatically interprets this XML to create a LaTeX version, which is used to display the equa-
9 Most metamodels silently make the ergodic assumption, which equates the probability of an event occurring in one individual to the rate at which it occurs in the population. Ergodicity works well in modelling turbulence, but it can lead to errors in modelling ecosystems, because biological processes are often non-ergodic. For example, inheritance of biological properties is governed by genetic rules, which are not ergodic. Assuming that inheritance is ergodic would require the oﬀspring to have attributes that do not depend on their parentsÕ. Inheritance is an important factor in shaping intra-population variability, which Lomnicki (1988) showed must be modelled accurately. Inherited attributes aﬀect how well an organism is ﬁtted to its environment. So adopting the ergodic assumption leads to demographic errors, which can be fatal in modelling natural selection by competition between species. The LE metamodel makes the ergodic assumption for each predation event at the level of the sub-population. But computing the demography of a whole population by summing over all sub-populations does not involve the ergodic assumption. So it is possible to compute the emergent ergodicity of each population (WPB).

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

95

tion in pdf format. What the user then sees on the screen has the familiar form as printed in a scientiﬁc publication. The biological equations displayed in the case study were generated by that procedure.

3.1. Physics

The physical state variables of the virtual ecosystem include the properties of seawater (temperature, salinity, pressure, density), solar irradiance, and turbulence (height of the biggest (energy-containing) eddies, their kinetic energy density, and energy dissipation rate). These physical properties of the ecosystem respond to external forcing by the sun and atmosphere, deﬁned by exogenous equations (e.g. for solar elevation) and data (e.g. the ERA40 data set for the atmosphere). They are also aﬀected by bio-optical feedback, in which the intrinsic optical properties of seawater vary with the concentrations of plankton pigments.

3.1.1. Optics An optical sub-model is used to compute the solar irradiance proﬁle in each of, typically, 25 wavebands,
of which a dozen may be in PAR. Over the years my research group has used three diﬀerent optical models. The ﬁrst is derived from MorelÕs (1988) empirical model; it has the advantage of being fast, but it is prone to rather large errors (Liu & Woods, 1998). The second model is based on the radiative transfer equation (Liu & Carder, 2002; Liu, Woods, & Mobley, 1999); this is accurate at all depths, but it is rather slow. The third uses the Monte Carlo method with one billion photons per waveband (Liu & Woods, 2004b); this is reasonably fast and accurate to a depth of 40 m. The ﬁrst method gives only the downwelling irradiance: the other two take account of scattering explicitly and compute three-dimensional irradiance.

3.1.2. Turbulence All LE models of the upper ocean ecosystem assume that turbulence is constrained to the surface mixing
layer, which has a lower boundary deﬁned by the turbocline. A one-dimensional mixed layer model is used to compute the depth of the turbocline and the kinetic energy of turbulence above it. Most mixed layer codes are compatible with the LE metamodel. I have used that of Woods and Barkmann (1986), which modularizes the codes for (1) solar heating, (2) convective adjustment, (3) entrainment by turbulence (computed separately for the two energy sources, convection and windstress), and (4) upwelling. The depth of the turbocline is computed progressively in sub-timesteps for each of these processes.

3.1.2.1. Turbulent diﬀusion. Above the turbocline, turbulence homogenizes seawater properties, including dissolved chemicals, every time step. So above the turbocline, these properties have zero vertical gradient. LE models do not permit diﬀusion of scalars below the turbocline, where the ﬂow is treated as laminar, and molecular diﬀusion is ignored (Woods, 2001).

3.1.2.2. Turbulent displacement of particles. The agents used to describe particles (including plankton – dead or alive – and fæcal pellets) are displaced vertically by turbulence when they lie above the turbocline. The LE metamodel permits the user to deﬁne the rules that determine the new depth of an agent at the end of a time step. All rules involve the use of a random number generator (RNG). The sequence is determined by the initial, or seed, value. This is chosen by the model designer.
The WB model (see Case study below) uses a rule for turbulent displacement that moves a particle randomly to a new depth anywhere between the sea surface and the turbocline. This assumes that there is no correlation between the depth of the agent in successive time steps. The assumption is justiﬁed if the time step of the integration is long compared with the integral time scale of the turbulence, which can be thought of as the over-turning time of the largest eddies. It is valid for most of the year. It fails in winter, when the turbocline is very deep, but that has negligible impact on the virtual ecosystem.

96 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
Sometimes it is necessary to use a time step that is shorter than the overturning time of the largest eddies. In that case, the agentÕs depth in successive time step is correlated. Turbulent displacement can then be computed as a random walk (Barkmann & Woods, 1996). Alternatively, the computation can be divided into two stages: the ﬁrst describes the displacement by the energy-containing eddy (which may be a Langmuir cell); the second adds a random element scaled to the kinetic energy in the turbulent cascade (Woods & Onken, 1982).
3.2. Chemistry
The LE metamodel code is responsible for budgeting chemicals. This is done automatically and is not described in the model equations. The budgeting is performed both at the level of chemical elements and at the level of each chemical species (molecule, ion) containing that element. The code for budgeting is added automatically whenever the model designer introduces a new element/molecule/ion. The budgets are computed in moles. VEW Designer includes a tool for converting units from, say, mg C/m3 to mmol C/m3.
The LE metamodel supports chemicals in solution, in plankton (various stages) and in detritus (dead plankton and fæcal pellets). It tracks the ﬂow of each chemical element between dissolved and particulate forms. Chemicals in each form are budgeted as they are taken up by phytoplankton, ingested by zooplankton, excreted to solution, egested in fæcal pellets and remineralized by bacteria acting on dead plankters and pellets.
A typical model includes three classes of chemicals: nutrients, contaminants and pigments. The nutrients are essential for growth. The contaminants may accumulate in some species of plankton giving concentrations much higher than in seawater. The pigments have action spectra, which inﬂuence photosynthesis, vision and appearance.
Air–sea ﬂuxes of gases are controlled by the diﬀerence in their partial pressures in the atmosphere and in the ocean mixed layer. The ocean partial pressure of carbon dioxide (OpCO2) is computed from the concentration of dissolved inorganic carbon, by means of a user-deﬁned model of carbon chemistry that also involves alkalinity, boron concentration and temperature. The atmospheric partial pressure of carbon dioxide (ApCO2) is speciﬁed in the scenario.
3.3. Biology
The LE metamodel supports plankton communities with unlimited biodiversity (Fig. 2). Each community comprises a set of functional groups. A group is deﬁned by its unique combination of phenotypic equations for the physiology and behaviour of individual plankters. A functional group can have several species, each diﬀerentiated by a set of values for the parameters in the biological equations. Thus each species occupies a unique location in multi-dimensional parameter space. Species can sport varieties deﬁned by relatively small diﬀerences in the values of one or more parameters. These anomalous values may be prescribed in the initial conditions, or they may mutate according to statistical rules deﬁned in the model. Finally, the LE metamodel also supports growth stages in each species. In phytoplankton, there are typically three stages: motile, cyst (or spore) and dead. In the zooplankton, there may be several stages (notably in copepods), with rules for hatching and moulting/metamorphosis between the stages, with rules for death leading to the ﬁnal stage (in which the plankton is a corpse).
Regardless of its functional group, species, variety or stage, a plankter contains pools for every chemical element in the virtual ecosystem. In some models these pools are divided into sub-pools for chemical species, such a lipids and proteins. That division permits more detailed physiological equations. Phytoplankton equations describe nutrient and contaminant uptake based on Droop (1968) dynamics. Zooplankton equations describe ingestion, digestion, etc. The chemical pools are depleted by respiration, excretion and egestion into

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

97

fæcal pellets after an appropriate gut passage time. We shall see later (Fig. 18) how this permits bio-transport of chemicals by migrating zooplankton.

3.3.1. Physiology Physiology includes functions for the uptake, excretion and egestion of chemicals, and their internal pro-
cessing leading to growth, metamorphosis and death. It also includes respiration, and the response to infection. The LE metamodel permits the designer to write equations/rules for these physiological functions of an individual plankter. They may be prognostic or diagnostic. In general they are functions of (1) the biological state of the organism and (2) its ambient environment. In the case of ingestion, the diagnostic equation also includes the biological state of the prey (e.g. its growth stage) and its ambient concentration.

3.3.1.1. Respiration. Every living plankter suﬀers a loss of energy by burning carbon, which depletes one or more of its pools of carbon molecules (lipids, proteins, etc.). One of the distinguishing features of the dead stage of a plankter is that it does not respire, nor does it take up chemicals from the seawater or by ingesting prey. The respiration equation is diagnostic. The speciﬁcation can be more or less complicated according to the needs of each investigation. At its simplest, respiration is a constant throughout the life of the plankter. This can be elaborated by making respiration a function of the plankterÕs biological state, such as body weight or growth stage. Then additional respiration can be added for the cost of ingestion, metamorphosis between stages, reproduction, and so on. Finally there can be a respiration cost associated with behaviour, such as migration, foraging and predator avoidance.
It is common modelling practice in biological oceanography to include respiration rules designed to prevent the phytoplankton populations becoming too sparse in winter.10 The LE solution is to have the phytoplankton metamorphose during winter into a cyst stage with reduced respiration. The model designer speciﬁes rules that determine when the phytoplankter changes to and from the cyst stage. The cues may be based on the ambient environment e.g. light or temperature.11 WPB showed that the virtual ecosystem is insensitive to the speciﬁcation of this bottom closure, so long as it prevents extinction. That is quite different from the extreme sensitivity of the virtual ecosystem to the speciﬁcation of trophic closure by top predators.

3.3.1.2. Photosynthesis. Phytoplankton perform photosynthesis when the ambient PAR is suﬃcient. Early LE models (such as WB used by WPB and for the Case study) used a simple photosynthesis–irradiance curve based on the work of Steele (personal communication, 1980) or Jassby and Platt (1976). More recently Sinerchia (2005) has used the Geider, MacIntyre, and Kana (1998) parametrization, which features a dynamic pool of chlorophyll to control photosynthesis according to the rate of nutrient uptake.

3.3.1.3. Photo-adaptation. The LE metamodel permits the designer to specify an equation for a phytoplankter to adapt its photosynthesis according to its recent history of ambient irradiance (Denman & Marra, 1986; Lande & Lewis, 1989). This is achieved by the metamodel code recording the previous state of photo-adaptation over a period of typically 10 h.

10 This is often done by reducing the respiration of individual plankters as the population density declines. The LE metamodel does not permit population-based respiration on the grounds that an individual plankter cannot know how large is the population of which it is but one member. However WPB showed how the procedure may be justiﬁed if natural mortality is largely due to disease, in which case the death rate would be lower in winter when the plankton are sparse, reducing the risk of infection. So, winter respiration can be reduced through equations for disease. 11 In extremis, the criterion may be the day of the year. This is permitted in the VEW, but it goes against the spirit of the LE metamodel, which seeks to avoid rules that are biologically unrealistic.

98 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
3.3.1.4. Predation. A zooplankter ingests its prey at a rate that depends on four factors: (1) the biological state of the predator, (2) the prey concentration, (3) the biological state of the prey, and (4) some property of the ambient environment. Feeding is computed separately for each prey species, variety and stage. So, for example, a model can specify that ﬁsh larvae of a particular size feed exclusively on a species of copepods only when it is in a particular growth stage (Sinerchia, 2005).
3.3.1.5. Satiation. The LE metamodel permits the model designer to specify satiation, a biological state variable that depends on its recent feeding history. Satiation parametrizes the concentration of enzymes in the zooplankton gut. The LE metamodel code records a zooplankterÕs ingestion for the last few time steps. Satiation is computed from this record. It is used to modulate a number of biological functions, including ingestion and behaviour.
An alternative approach (Sinerchia, 2005) modulates ingestion according to the capacity of the zooplankterÕs gut. The gut content is expressed in terms of the number of prey ingested during the time taken for digestion, typically an hour or so. Gut content equations describe the change in the zooplankterÕs chemical pools according to the rates of ingestion, digestion, respiration, excretion and egestion.
3.3.1.6. Excretion and egestion. A fraction of the chemicals ingested by a zooplankter are consumed in respiration, building body weight, metamorphosis, swimming and other functions. The surplus is either excreted as a liquid, or egested as a solid fæcal pellet. The model designer speciﬁes rules for those processes. The LE metamodel supports rules involving a delay between ingestion and egestion, with a speciﬁed gut passage time, which is typically about one hour. For this purpose the metamodel code automatically stores the digestion history of ingested prey for a few time steps. The number is speciﬁed by the model designer.
3.3.1.7. Remineralization. After it has been egested, each fæcal pellet is tracked as an agent in the computation. It is a package of chemical pools. The model designer speciﬁes the pelletÕs sinking speed and the rate at which attached bacteria extract chemicals from its pools, releasing them to solution. This process of remineralization is performed separately for each chemical species, allowing the model designer to control the stoichiometry of remineralization. (The same is true for remineralization of chemicals in the corpses of dead plankters.)
3.3.1.8. Reproduction. Phytoplankton reproduce by cell division when their nutrient and energy pools exceed prescribed levels. Although this is described in the LE model for a single plankter, it is represented in the metamodel code (invisible to the user) by a doubling of the number of plankters in the agentÕs sub-population.
Zooplankton reproduce when they reach the adult stage as deﬁned in rules speciﬁed by the designer. They then grow a clutch of eggs, the number of which depends on feeding success during gestation (or some similar rule). When these eggs hatch they are allocated to a new agent which follows a trajectory independent of the motherÕs.
The user can also specify the sex of the plankton in each sub-population, and write equations for sexual reproduction. In this case the oﬀspring are carried by two agents, one all-male and one all-female, which go their separate ways.
3.3.1.9. Natural mortality. Natural mortality can result from starvation, senescence or disease. Energy starvation occurs in phytoplankton when the energy pool becomes negative, and occurs in zooplankton when the energy reserves (lipid and protein) are both exhausted. The LE metamodel supports a rule for death by senescence in zooplankton; this is spread over a speciﬁed period of time after reproduction (20 days in the WB model). The model may also include bacteria or viruses that infect individual plankters, causing a disease which can be deadly.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

99

3.3.1.10. Infection. The LE metamodel permits the designer to specify populations of bacteria or viruses that can infect phytoplankton or zooplankton, causing them to become diseased. These may be represented by LE agents, with physiological equations to compute the demography of the population of bacteria/ viruses. The model must also include equations to compute the probability that an individual plankter becomes infected in a particular time step; that depends on its biological state, the concentration of the bacteria/viruses, and the ambient environment. Other equations describe the course of the disease. It may, for example, raise the plankterÕs digestion or respiration rate for some hours or days, which can aﬀect its growth, reproduction and mortality.

3.3.2. Behaviour The LE metamodel permits equations for the motion of individual plankters relative to the water. The
motion can be sinking under gravity, or ﬂoating up if the plankter is buoyant. Sinking applies to dead plankton and fæcal pellets, and to some species of living phytoplankton (e.g. diatoms). Or plankton behaviour can involve swimming, which typically has a maximum speed parametrized in terms of weight or growth stage. In a one-dimensional simulation, swimming is constrained to be up or down. Purposeful locomotion is classiﬁed as either foraging, migration, escaping from an incoming predator, or searching for a mate.

3.3.2.1. Foraging. Rules for foraging can be designed to make the predator hunt up and down through layers where prey have enhanced concentration (e.g. when grazing in the deep chlorophyll maximum of the seasonal thermocline). For visual predators they apply only when the ambient irradiance exceeds some threshold value.

3.3.2.2. Searching for a mate. LE models can be designed with the sexes represented explicitly. The male and female populations are treated as though they are separate varieties of the same species, diﬀerentiated by a sex parameter. An agent of one sex uses the foraging rule to home in on high concentrations of the other sex.

3.3.2.3. Predator avoidance. The LE metamodel does not permit explicit equations for predator-prey encounters. But the model can include a rule for the probability of a prey agent being approached by a predator. In the case of visual predators the probability is a function of the predator concentration and the prey visibility. The latter depends on its apparent size and ambient irradiance. The respiration cost of predator avoidance manoeuvres can be parametrized in terms of that probability.
It is known that a zooplankter may also perform avoidance manoeuvres when it encounters the pressure ﬁeld of a micro-gust in turbulent water. In this case the probability of the cue occuring depends on the turbulent viscous dissipation rate, which is used to compute enhanced respiration in the mixing layer.

3.3.2.4. Migration. The rule for diel migration can be based on pursuit of a target isolume. Winter migration into deep water (for zooplankton in the diapause stage) requires the user to specify cues for descent and ascent. The LE metamodel supports rules based on ambient environment (temperature, irradiance, etc.), or the biological stage of the zooplankter.12
The chosen migration rule can be optimized for annual production by adjusting its parameters (Fiksen & Carlotti, 1998). This involves trading the risk of being eaten by visual predators against the risk of starvation due to loss of daytime feeding on prey in the mixed layer. The net energy cost of migration can be

12 Another permitted cue is the day of the year. This must be used with caution when simulating the ecosystem in a mesocosm that drifts with the ocean circulation.

100 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
computed by budgeting respiration changes with ambient temperature and swimming. This procedure is determined by numerical experiments performed before the main simulation. The experiments involve competition between varieties with diﬀerent values of the migration parameters. They simulate natural selection between those varieties to reveal the one that is best ﬁtted to the model-scenario combination.
While migrating, zooplankton often swim several metres per hour. In one time-step they may pass through several layers of the grid used to deﬁne the ﬁeld of prey concentration. The LE metamodel automatically depletes prey sub-populations pro rata according to the fraction of the time step the predator spends spends in each layer.
4. Scenario
The scenario describes exogenous phenomena that inﬂuence the virtual ecosystem. It has three components: initial conditions, boundary conditions and events. These must be speciﬁed before integrating the model to create a virtual ecosystem.
4.1. Initial conditions
The integration that creates a virtual ecosystem is normally started at the end of winter, when the mixed layer is deep and the plankton are relatively inactive. The initial conditions comprise the values of all state variables in the virtual ecosystem on that day, usually at midnight local time. Initial conditions divide into two classes: resources and the rest. The development of the virtual ecosystem depends critically on the initial resources, i.e. the nutrients (see below). But ﬁrst I consider the others.
4.1.1. Attractor WPB showed that the plankton populations and their environment adjust to an attractor that does not
depend on the initial value of any non-resource state variable. That is important because we seldom have accurate empirical values for the initial conditions. And even where empirical data do exist, they are often unrepresentative of the 1° · 1° square simulated by a VE. In part this is because they are samples of a natural ecosystem that has mesoscale patchiness (Wiebe, 1971). Moreover, they sampled the natural ecosystem, which has a much richer biodiversity than the LE model. So observations cannot entirely answer the challenge of deﬁning initial conditions for a particular model with its limited plankton community. But that does not matter because the virtual ecosystem attractor depends only on the initial concentration of nutrients.
4.1.2. Nutrients Those sampling problems apply equally to observations of nutrients. But there is no alternative to using
the empirical data for resources because they control the virtual ecosystem. What is needed are values of nutrient concentrations in the mixed layer, averaged over one degree of latitude and longitude (or whatever is the resolution of the atmospheric data used for boundary conditions). It would be suﬃcient if the data comprised values for the last month of winter. The problem is that nutrients are seldom sampled in winter. The NOAA archives contain no February sample of nitrate within 500 km of the Azores (S. Levitus, personal communication). Nutrients are sampled more often in spring and summer, but those observations exhibit large variation within 1° · 1° due to mesoscale patchiness, and inter-annual variation in the rapid depletion of nutrients during the growing season. Unless there are reliable observations (e.g. at the BATS site), it is better to use indirect estimation to establish the nutrient concentration in the mixed layer at the end of winter at the geographical location of initialization.
The method starts with the proﬁle of annual mean nutrient concentration published in the NOAA world ocean atlas (Levitus, 1998). That proﬁle is based on data collected at any time of year. I assume that the

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

101

annual variation is negligible in the permanent thermocline (i.e. below the annual maximum depth of the mixed layer, which normally occurs at the end of the winter cooling season). The second piece of information is the depth of the mixed layer on initialization day (H0); that is derived from the virtual ecosystem when it is in balance with the boundary conditions. (Biofeedback has little inﬂuence on mixed layer depth in winter, so H0 is insensitive to nutrient concentration.) I ﬁt a curve to the nutrient concentration data that lie in the permanent thermocline. That curve is extrapolated upwards to H0. The value at H0 provides the best estimate of the nutrient concentration in the mixed layer on that day.13

4.2. Boundary conditions

The boundary conditions comprise ﬂuxes through the top of the mesocosm. The ﬂuxes include solar and IR radiation, sensible and latent heat, water vapour and other gases (nitrogen, oxygen, carbon dioxide, etc.) and dust. A boundary condition ﬁle, with values of the surface ﬂuxes at every time step of the planned virtual ecosystem, is generated before the model is integrated.
The heat and water ﬂuxes are derived from ERA40.14 They are interpolated in space and time to provide ambient ﬂuxes for each time step of the simulation, at the precise geographical location of the moored or drifting mesocosm. For some numerical experiments it is more convenient to work with monthly-mean climatological values derived from ERA40. An alternative for the North Atlantic is BunkerÕs climatology derived from ship observations (Isemer & Hasse, 1986), and water climate from Baumgartner and Reichel (1975) and Wijﬀels (2001). The VEW contains both synoptic and monthly mean versions of ERA40 for the whole globe, and the monthly-mean Bunker values for the North Atlantic, all at a resolution of 1° · 1°.

4.3. Ocean circulation

The virtual mesocosm may be moored at a ﬁxed geographical location, or it may drift with the ocean circulation. In the latter case it remains upright and is advected by the mean velocity in the top 100 m (or some other depth range chosen by the user). The track of the mesocosm is computed by integrating a velocity ﬁeld derived from a global ocean circulation model.15 This procedure is called Geographically-Lagrangian Integration (GLI). It permits a wide variety of investigations in which the development of the ecosystem depends critically on geographical variation of atmospheric forcing; for example, the transition from seasonal to permanent oligotrophy in water drifting from the zone of annual cooling to that of annual heating (Woods & Barkmann, 1985, 1995).
GLI assumes that the baroclinic component of the ﬂow passing through the drifting mesocosm produces no ﬂux divergence in any state variable of the virtual ecosystem at any depth. The error arising from that assumption is not signiﬁcant for many investigations, especially in regions where the ﬂow and horizontal scalar gradients are weak; as in the eastern (recirculation) side of gyres.
However, the error can be signiﬁcant at jets/fronts, where the ﬂow is fast and horizontal gradients are strong. Such jets contain most of the kinetic energy of mesoscale turbulence, which is responsible for patchiness in the plankton ecosystem (Woods, 1988). Three-dimensional simulations of the plankton ecosystem at mesoscale jets based on the ﬁeld metamodel (Martin, Richards, & Fasham, 2001) suggest that neglecting

13 VEW Data contains a global data set for each nutrient generated by that procedure. The data were computed on the assumption
that the annual maximum depth of the mixed layer published in the NOAA atlas provides a reasonable ﬁrst estimate of H0. 14 ERA40 is a global data set describing the synoptic state of the atmosphere every six hours at a resolution of one degree of latitude
and longitude. It was created at the European Centre for Medium-range Weather Forecasting by using their current forecasting model
and data assimilation procedure to re-analyse atmospheric observations collected during the period 1958–2002 (Simmons & Gibson,
2000). 15 VEW contains a global velocity ﬁeld derived from OCCAM. The user can substitute another.

102 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
baroclinic advection may lead to errors of order 10% in emergent properties. Investigations where patchiness is important must use a three-dimensional version of the LE metamodel that resolves the baroclinic ﬂow. My research group is developing a three-dimensional VEW (Maggiore, 2001; Rogers, 2005).
5. Prediction
Integrating the LE model requires a description of the state of the atmosphere over the mesocosm at every time step. In practice I derive those boundary conditions by interpolation from atmospheric data logged less frequently (six-hourly for ERA40 synoptic data; monthly for climatology).
5.1. Weather forecasting
It is sometimes suggested that the ecosystem can be predicted operationally using atmospheric data from a weather forecast (Zavatarelli, Baretta, Baretta-Bekker, & Pinardi, 2000). That might be eﬀective up to the limits of predictability of the atmosphere, about one week at present. To do so it would be necessary to initialise the ecosystem at the start of the weather forecast. The ecosystem must start in balance with prior atmospheric forcing. Achieving that balance requires an upstream simulation of several years to be sure that the legacy of initialization errors has decayed (WPB). Often that is not possible, in which case the virtual ecosystem responding to the weather forecast starts and remains oﬀ-attractor.
5.1.1. Weather events For most of the year the demographic processes occuring in the virtual ecosystem are so slow that they
play little part in its response to weather events, such as a storm.16 The response is largely mechanical. If the storm deepens the mixed layer for a few days, the chemicals and plankton are mixed deeper. After the storm, there remains a legacy of chemicals and plankton that have been subducted into the seasonal thermocline. Similar mechanical changes are experienced diurnally in response to solar elevation (Cushing, 1995 called this the Woods–Onken eﬀect). The LE metamodel simulates such mechanical changes more realistically than do metamodels that treat plankton as a continuum and parametrizes their displacement by diﬀusion. They will be illustrated in the case study.
5.1.2. Long-term weather prediction For some purposes, such as climate prediction, it is not essential that the simulated weather be con-
strained by the initial conditions, so long as it is dynamically realistic at all times. In that case the weather prediction model can be used to simulate the atmosphere for many years. That is useful for biological oceanography, because it allows time for the ecosystem to adjust to the ambient weather, i.e. to shed the legacy of initialization errors. There are two problems with this approach. The ﬁrst is that long-term weather prediction often exhibits climate drift, i.e. the simulated weather becomes progressively less realistic. The second is that running a global weather prediction model is computationally expensive. It is not aﬀordable to run such a model for each numerical experiment in virtual ecology. A cheaper solution is to use hindcasting.
5.2. Hindcasting
A virtual ecosystem takes years to adjust to its attractor for a given scenario. The time scale is set by the annual cycle of plankton reproduction. Eliminating initialization errors is a pre-requisite for most
16 The exception is at the peak of the spring bloom and during zooplankton spawning, when the local demographic changes due to reproduction can rival the migration induced by the weather.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

103

investigations. That takes several growing seasons. The state of the balanced virtual ecosystem on a date at a particular geographical location can be established by GLI starting several years upstream on a track that brings the mesocosm to the target location on the chosen date. That requires a time series for the boundary conditions during those upstream years. In principle that might be derived from meteorological observations on a ship following the prescribed track on the right days. But that is an unlikely scenario. The alternative is to synthesize the time series of boundary conditions by interpolation from the ERA40 global data set. After initialization errors have decayed, the development of the virtual ecosystem remains in balance with that atmospheric forcing. This procedure, called hindcasting, provides the boundary conditions for virtual ecology. Predicting how the ecosystem will develop in the future assumes that the sequence of weather will follow a pattern that has occurred in the past. The investigator selects an appropriate period from ERA40. The resulting simulation is just one instance of many that can be created by selecting diﬀerent periods of time from the ERA40 data set. Inter-instance variation arises from the diversity of weather found at any geographical location. Statistical analysis reveals the range of values that each emergent property can take.

5.2.1. User adjustments For some investigations it is necessary to alter the scenario derived from the global data sets. For exam-
ple, this might be required for sensitivity studies relating to exogenous variables, like nutrient concentrations. Or the scenario might include a progressive adjustment of the atmospheric concentration of carbon dioxide as predicted by the IPCC (see WPB).

5.2.2. Events Simple hindcasting may not suﬃce for some applications of virtual ecology. Consider three categories.
The ﬁrst includes natural events such as tsunamis. The second category comprises man-made events, such as pollution by shipwreck or the discharge of ballast water containing alien species. The third category comprises intervention to deal with the unwanted consequences of those natural or man-made events. Adding these events to the natural scenario leads to What-If? Prediction (see Section 7 Applications later).

5.3. Job control

Finally, the user sets up the job for the computer. This involves specifying whether the job is designed to create a single virtual ecosystem or a batch of VEs with diﬀerent values of model parameters, or exogenous forcing. Job control also speciﬁes which emergent properties are to be logged.

5.3.1. Batches and Ensembles Each job may involve a number of runs in which some of the model parameters, or scenario variables are
adjusted to create a batch of virtual ecosystems for sensitivity studies. A prediction may be supported by numerical experiments designed to measure the uncertainties in its
emergent properties. They are assessed by ensemble modelling, which involves multiple runs in which the seed value of the random number generator is varied randomly to create an ensemble of instances of the same Virtual Ecosystem. Each instance is a valid solution of the speciﬁed model and scenario. Each instance has a unique set of plankton trajectories, which control demography and biofeedback. So the instances diﬀer slightly in all their emergent properties. A mean virtual ecosystem is deﬁned by averaging each emergent property across the ensemble at every time step. The uncertainty in each property is computed from the standard deviations of the ensemble of synoptic values.

5.3.2. Logging Having speciﬁed the model and scenario, the next step is to specify which state variables are to be logged,
between which dates, and at what intervals of time. The logged data are stored in the VE archive. Later they

104 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
will be imported into VEW-Analyser. The output includes ﬁeld variables (environment and demography) and audit trails of selected agents.
5.3.2.1. Selecting audit trails. The virtual ecosystem may include millions of agents; in practice only 1000 or so audit trails are logged. The selection is made automatically according to criteria speciﬁed by the user. This involves constructing the histograms of agent properties, such as plankter body weight, or the subpopulation size. The user speciﬁes how that distribution is to be sampled. Options include the top/bottom thousand, or a selection that itself has a histogram with the same form as that of the whole population of agents.
5.3.2.2. Lifespan. Demographic, splitting and combination events occuring in every sub-population are automatically logged to create the chronological (‘‘Parish’’) register. The Lifespan program will be used later to analyse the completed register to compute demographic time series for each plankton population, including the life expectancy of its members.
5.3.3. Integration The ﬁnal task is to choose the computers to be used for integration of the model, and for storage of the
logged data. The user then pushes the RUN button. That triggers two actions. First, the speciﬁcation of the virtual ecosystem is recorded in the VEW archive, where it serves as a template for future numerical experiments. Then the VEW automatically logs into the designated computers, runs the job and stores the output on the speciﬁed ﬁle server.
5.3.4. Monitoring progress During model development it is helpful to monitor the emergent properties as the integration proceeds
step-by-step. VEW LiveSim provides that facility. This tool allows the user to integrate the model backwards as well as forwards. It provides graphical displays like those available in VEW Analyser, including audit trails of individual plankters, and proﬁles of environmental variables.
6. Virtual ecology
Virtual ecology seeks to advance biological oceanography by analysing the emergent properties of mathematical simulations, called virtual ecosystems, which are based on the Lagrangian Ensemble metamodel.
6.0. Observations
In virtual ecology the biological oceanographer no longer seeks to understand the plankton ecosystem by analysing observations. However, observations of the natural ecosystem are still needed. They serve four functions:
1. They stimulate hypotheses that can be tested by virtual ecology. 2. They provide data for initialization: nutrient concentrations and species lists. 3. They collect plankton that can be cultured for experiments to establish the phenotypic equations used in
LE models. 4. They provide data that can be used to determine empirical descriptions of ecosystem phenomena for
model veriﬁcation.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

105

6.1. The virtual ecosystem

The virtual ecosystem is a large data set. It comprises time series for each logged variable, potentially with values every time-step for the duration of the simulation, which may be many years. The longest simulations so far have been for one hundred years. The data set includes environmental and demographic variables; these are ﬁelds deﬁned by values in every layer of the mesocosm. It also includes an audit trail for every logged agent, and the ‘‘Parish’’ register of sub-population events. Together these comprise the emergent properties of the simulation.

6.2. Analysis

The data set is imported into VEW Analyser to plot graphs of selected variables. The data selected for plotting can also be exported for further analysis in Microsoft Excel.

6.2.1. Field data The ﬁeld variables can be plotted in three forms: (1) as a time series at a ﬁxed depth, (2) as a synoptic
proﬁle at a ﬁxed time step, or (3) as a depth-time contour plot.

6.2.2. Audit trails The agent data are plotted as audit trails comprising the agentÕs depth and ambient environment, the
biochemical properties of its plankton, and the demographic properties of its sub-population.

6.2.2.1. Lineages. Some biological properties of plankton are inherited through lineages. In the case of plankton species, whose oﬀspring are added to the sub-population of the parentsÕ agent, the audit trail follows the plankton lineage through successive generations in the same agent. The Lifespan program is used to analyse lineages of zooplankton for which successive generations are carried by separate agents.
Inheritance can either be speciﬁed in the model, or it may be an emergent property of the virtual ecosystem. For example, the model normally speciﬁes that mutated values of biological parameters, which deﬁne varieties, are inherited. The model may also contain statistical rules for a parameter to mutate infrequently at reproduction, whereupon the oﬀspring have a value slightly diﬀerent from that of its parent. The new value is then inherited through the lineage until another mutation event occurs. An example of emergent inheritance was reported by WPB. They found that the body weight of successive generations of copepods tends to be inherited through lineages, even though the model has no rule to specify such inheritance.

6.2.3. Natural selection The inheritance of biological parameter values permits simulation of natural selection in virtual ecosys-
tems (Al-Battran, Field, Wiley, & Woods, 1998; Nogueira & Woods, 2005). Here is one way to do so. The plankton community in a VE is speciﬁed to include a number of varieties of the same species. The varieties compete for the same resources. For example, varieties of a diatom species compete for nutrients, or varieties of a copepod species compete for their prey (diatoms). Because the varieties have diﬀerent values of a key parameter they produce diﬀerent emergent demography. The relative abundances of the varieties will change progressively, with some declining to extinction, and others taking a greater share of the limited resource. The time to extinction is an emergent property of the virtual ecosystem. The competitive advantage of each variety is an emergent property of the virtual ecosystem. It depends not only on the biology of the plankton, but also on the exogenous forcing. The variety that emerges as most abundant is by deﬁnition the one that is ‘‘best ﬁtted’’ to the recent history of ambient climate. Thus, the inheritance of biological parameter values through lineages in LE modelling permits a prognostic study of biodiversity.

106 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
6.3. Numerical experiments
A research project normally involves a sequence of numerical experiments, each comprising a set of virtual ecosystems. Their emergent properties are analysed to reveal ecosystem properties and processes. The ﬁrst step is to explore Ecosystem properties. These emergent properties can, in principle, be observed at sea. They are targets for veriﬁcation by the Ecological Turing Test (see Veriﬁcation below). Examples will be presented in the case study. The second step is to explain those ecosystem properties in terms of Ecosystem processes. These are deﬁned as ﬁner-grained phenomena that cannot be observed. The boundary between observable and non-observable phenomena depends on observing technology; it will shift in the future as new instruments become available.
The LE metamodel provides a powerful diagnostic tool for virtual ecology: audit trails of individual agents. Each audit trails comprises three sets of time series. The ﬁrst comprises the agentÕs depth and ambient environment.17 The second comprises the biochemical state of the agentÕs plankters (alive or dead) or fæcal pellet. The third comprises the demography of the agentÕs sub-population.
6.3.1. Balanced ecosystem One of the pre-requisites for successful numerical experimentation is that the virtual ecosystem is in bal-
ance with exogenous forcing. Suﬃcient time must have passed upstream for the legacy of errors in the initial conditions to have decayed until they are lost in the noise caused by turbulence. In other words the virtual ecosystem must have relaxed to an attractor consistent with the model and the scenario. The relaxation time is governed by reproduction in the plankton, most of which occurs during a growing season that lasts only a small fraction of the year. WPB showed that relaxation is completed within three growing seasons when the exogenous forcing has a stationary annual cycle and the plankton community has no competition. It takes longer for a drifting virtual mesocosm experiencing inter-annual variation in the forcing as it follows a geographical track. And it takes very much longer for competition to eliminate all but the best-ﬁtted species. But eventually the virtual ecosystem settles to a geographically-lagrangian attractor in balance with model, scenario and track. The protocol for any numerical experiment includes preliminary research to establish that the virtual ecosystem is on attractor.
6.3.2. Perturbation experiments The goal of a numerical experiment can be to discover how a virtual ecosystem will respond to an arti-
ﬁcial change in the model or scenario. The response is expressed in terms of observable properties. Diagnosis of audit trails will reveal the internal processes responsible for the response. Theories about the ecosystem can be tested by this combination of perturbation, emergent response in ecological properties, and audit trails. For example, Arrese (2002) discovered that the date of the autumn bloom depends on zooplankton fertilization of oligotrophic primary production. And Hinsley (2005) showed how an oil slick changes a virtual ecosystem.
6.4. Veriﬁcation
The credibility of a Virtual Ecosystem rests on three factors. First, it is trustworthy because it has been built from primitive equations based on reproducible experiments. Second, the internal noise is known from ensemble simulations. Third, some of its emergent properties can be compared with observations. The third factor is called veriﬁcation. It requires a data set derived from measurements of the natural
17 The ambient environment is deﬁned as the set of values that all ﬁelds of environmental and demographic variables have at an agentÕs position. The phenotypic equations used to model the physiological changes and behaviour of the plankter are functions of its ambient environment.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

107

ecosystem. Only a few properties are candidates for veriﬁcation. They must be observable with acceptably low experimental uncertainty: measurement and sampling errors must not be too large. And the target must be an emergent property of the simulation with acceptably low noise. For the test to be successful, the diﬀerence between observed and simulated values of the target property must not be masked by the errors and noise. When that condition is satisﬁed, veriﬁcation may reveal that the simulation is diﬀerent from nature. Steps can then be taken to reduce the diﬀerence by improving the model and/or scenario. When there is no signiﬁcant diﬀerence between the observation and simulation, the test fails to refute the hypothesis that the VE provides a realistic representation of nature, in so far as it is known from observations. Woods (2001) called this procedure the Ecological Turing Test (ETT). Liu and Woods (2004) veriﬁed the WB model by comparing ocean colour in the Azores VE and in satellite observations.

7. Applications
LE modelling creates comprehensive simulations of the plankton ecosystem from a primitive-equation model and a scenario for exogenous forcing. The simulation – a virtual ecosystem – constitutes a resource that can be used for a number of applications, from scientiﬁc research and teaching to planning marine operations. The emergent ecological properties of the VE can be explored in the same way that one might explore a data set derived from observations. It has a number of advantages: its emergent properties have no gaps, and they include a richer set of variables. In particular, they include properties that cannot be observed, including the life histories of individual plankters. Provided it has been veriﬁed, the VE is more worthy of study than the best empirical description of the ecosystem. That leads to a strategy for virtual ecology in which observations are collected solely to initialize and verify the simulation. That practice has proved successful in other scientiﬁc disciplines, notably meteorology.
7.1. Scientiﬁc understanding
Scientiﬁc research on the plankton ecosystem has long beneﬁted from numerical experiments designed to explain observed phenomena. The investigator analyses the relationship between emergent properties of a simulation and the science contained in the model used to create it. The aim is to discover whether the embedded science leads to the observed phenomenon. This started with the box metamodel. The models were deliberately simpliﬁed to include only the processes believed to cause the target ecological phenomena. An early example was SverdrupÕs (1953) demonstration that the spring bloom occurs when the mixed layer becomes shallower than the photosynthetic compensation depth. The problem with such process studies, is that they do not demonstrate the process operating in a comprehensive virtual ecosystem. That can be achieved in Virtual Ecology. Woods and Barkmann (1993) tested SverdrupÕs conclusions in the context of the Azores VE (see Case study). They found that although the science was basically correct, the simple relationship between compensation depth and mixed layer depth was lost because of diurnal variation.
In general, the goal is to understand the ecological properties of the VE. Scientiﬁc understanding comes from showing how those observable properties are created by ecological processes, which involve ﬁnegrained emergent properties that cannot be observed. The latter are revealed by audit trails of individual plankters. The credibility of this approach comes from the fact that the ﬁne-grained properties are controlled by phenotypic equations, which accurately represent the physiology and behaviour of individual plankters.
Scientiﬁc understanding comes from numerical experiments in which the investigator designs a model and scenario to permit the virtual ecosystem freely to express the phenomenon under investigation and

108 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
the processes controlling it. The metamodel must not artiﬁcially constrain the relaxation of the virtual ecosystem to the imposed scenario. The LE metamodel approaches that ideal closer than the box and ﬁeld metamodels. Free relaxation requires the ﬁne-grained internal activity associated with individual plankters. It is missing from population-based modelling.
The simulation must be generated under realistic exogenous forcing. That is provided by selecting a period of years from ERA40, and by using the output of an ocean circulation model driven by the same atmospheric data. The VE is just one instance of many that can be created by selecting diﬀerent periods of time from the ERA40 data set. Inter-instance variation arises from the inter-annual variation in ambient weather.
7.2. Teaching
Virtual ecosystems provide a rich resource for teaching biological oceanography and theoretical population ecology. They are an example of artiﬁcial life, a branch of computing science. The LE metamodel is better than many used by the artiﬁcial life community because it accurately computes the demography of populations and their biofeedback to the environment. Teachers can use the emergent properties of virtual ecosystems to illustrate familiar paradigms. Course work can require the student to discover the causes of ecological phenomena by analysing audit trails. The VEW makes it easy to tailor virtual ecosystems to the curriculum.
7.3. What-If ? Prediction
Apart from scientiﬁc understanding, the motivation for simulating the plankton ecosystem comes mainly from planners seeking information on which to base remedial action when some future disaster will occur, whether natural or man-made. The concern is to reduce the risk of side-eﬀects from the remedial action; for example, damage to ﬁsh from dispersants used to clear oil pollution. Numerical experiments in virtual ecology have shown that unexpected consequences can ﬂow from perturbing the ecosystem (see for example the nutrient enrichment experiment in WPB).
What-If? Prediction (WIP) involves systematic scanning of possible remedial actions designed to deal with events that are likely to have unwanted consequences. The procedure involves a number of steps. The ﬁrst is to design an ecosystem model with a plankton community that has relevant plankton species. The second is to design a scenario for the atmosphere by selecting a time window from ERA40. The third is to introduce the causative event into the scenario. The fourth is to introduce the proposed remedial action as an additional event in the scenario. The ﬁfth step is to deﬁne a batch of simulations spanning variations in one of the above speciﬁcations, i.e. for the plankton community, weather, or remedial action. The resulting set of virtual ecosystems is analysed to reveal how well the remedial action dealt with the problem, as judged by a portfolio of emergent properties that have unwanted consequences.
8. Case study – (1) Design
We now present a case study to demonstrate the power of the LE metamodel. It is important to state at the outset that the aim is not to create a realistic simulation of the plankton ecosystem at a particular place. The VEW makes it straightforward to create models with complex plankton communities, but they are not needed for this case study. I deliberately used a simple classical food chain model (Cushing, 1995). So many

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

109

Fig. 3. The WB model used in the case study.
of the emergent ecosystem properties should be familiar from previous NPZD modelling using simpler metamodels.
8.1. The WB model
The virtual ecosystem was created by integrating the WB model (Woods & Barkmann, 1994) (Fig. 3). It contains one limiting nutrient, nitrogen, which occurs in two forms: nitrate and ammonium. The plankton community has explicit functional groups of phytoplankton and herbivorous zooplankton, and implicit populations of bacteria and carnivorous zooplankton. The phytoplankton are represented by a single species of diatoms. The herbivores are represented by a single species of calanoid copepods. The bacteria are attached to detritus particles that are also tracked as LE agents. The carnivores are the top predators used for trophic closure; they are visual feeders.
8.2. Physics
The physical environment is computed from two sub-models for light and turbulence respectively. It uses a simple equation of state for the variation of seawater density with temperature and salinity.
8.2.1. Light The optical sub-model is based on MorelÕs (1988) empirical code. The spectrum follows Woods et al.
(1984); it has 25 wavebands (Table 2). The proﬁle of downward irradiance is computed in each waveband, with the divergence dependent on the intrinsic optical properties of the seawater and chlorophyll concentration. The total energy ﬂux is computed by summing over all wavebands. Solar heating of the water is computed from the divergence of that energy ﬂux. The spectrum of downwelling irradiance is also used to compute photosynthesis and the visibility of copepods.

110 J.D. Woods / Progress in Oceanography 67 (2005) 84–159

Table 2 Parameters of the pigments in the WB model

Spectral band

Range of wavelengths (nm)

1 300–357.5 2 357.5–387.5 3 387.5–412,5 4 412.5–437.5 5 437.5–462.5 6 462.5–487.5 7 487.5–512.5 8 512.5–537.7 9 537.7–562.5 10 562.5–587.5 11 587.5–612.5 12 612.5–637.5 13 637.5–662.5 14 662.5–687.5 15 687.5–712.5 16 712.5–737.5 17 737.5–787.5 18 787.5–900 19 900–1100 20 1100–1300 21 1300–1500 22 1500–1700 23 1700–1900 24 1900–2100 25 2100–2300

Photosynthesis, v1
0 0 0.121 0.1 0.095 0.077 0.061 0.047 0.041 0.035 0.035 0.041 0.045 0.049 0.034 0 0 0 0 0 0 0 0 0 0

Vision, v2
0 0 0.121 0.1 0.095 0.077 0.061 0.047 0.041 0.035 0.035 0.041 0.045 0.049 0.034 0 0 0 0 0 0 0 0 0 0

Turbidity, e
1 1 0.677 0.702 0.702 0.703 0.695 0.673 0.65 0.618 0.628 0.65 0.672 0.685 0.62 1 1 1 1 1 1 1 1 1 1

8.2.2. Turbulence The mixed layer model is based on Woods and Barkmann (1986), which diagnoses the density proﬁle in
ﬁve stages within each time step of the integration. These stages take account of: (1) solar heating, (2) cooling to the atmosphere, (3) convective adjustment, (4) entrainment by turbulence powered by convection and the wind stress, and (5) upwelling. The model also computes the turbulent kinetic energy in the mixing layer and the depth of the turbocline. It assumes that the ﬂow is laminar and diﬀusivity is zero below the turbocline, i.e. in the diurnal, seasonal and permanent thermoclines.
8.2.3. Ekman upwelling The WB model includes Ekman upwelling. It is zero at the sea surface, then increases linearly with depth
to the base of the mixed layer, below which it is uniform with depth. This implies that the horizontal divergence of mass ﬂux is uniform with depth in the mixed layer, and zero below. The upwelling speed at the base of the mixed layer is determined by the wind stress curl featured in the scenario. For the case study, upwelling was set to zero at all depths.18
8.3. Chemistry
The WB chemical model has pigments and nutrients. The latter occur as nitrogen and carbon. Oxygen is not a variable in the model.

18 The WB model does not include upwelling due to mesoscale turbulence; that needs a three-dimensional model (Rogers, 2005).

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

111

8.3.1. Pigments The WB model features two pigments: chlorophyll in diatoms and visual pigments in top predators
respectively. In the case study they have identical action spectra deﬁned by v values in each of the wavebands used in the optical model. Bio-optical feedback is computed from the chlorophyll pigment with a spectrum of e values for turbidity.

8.3.2. Carbon Carbon has dissolved and particulate components. The former has one chemical species (DIC). The
model includes equations for diagnosing the partial pressure of dissolved carbon dioxide (OpCO2) from the concentration of DIC, temperature, pH and borate concentration. The last two are held constant in the case study, so OpCO2 varies only with DIC and temperature. The local concentration of DIC is reduced by 4.6 · 10À4 lg C per new diatom when the phytoplankton reproduce, and it is increased by zooplankton excretion and by remineralization of dead plankton and fæcal pellets. Top predators also return ingested carbon to the seawater in the same way as copepods (by excretion and fæcal pellets). Carbon dioxide ﬂows between the sea and air at a rate governed by the diﬀerence in their partial pressures: emergent OpCO2 minus scenario ApCO2.
8.3.3. Nitrogen Nitrogen is the limiting nutrient. It occurs in inorganic dissolved (DIN) and particulate forms. The model
contains two inorganic species in solution: nitrate and ammonia. Every agent has Droop pools for these chemicals.19 Nitrate and ammonia are taken up equally by the diatoms. When a zooplankter eats a diatom it ingests the nitrogen in the prey pools. The excess not needed for zooplankton growth is excreted partially as liquid ammonia or egested in the nitrogen pool of a fæcal pellet.
The model is initialized on 1st March with a prescribed concentration proﬁle of nitrate and zero ammonia. The plankton nitrogen pools are empty at initialization, but once the virtual ecosystem settles to its attractor each pool has a ﬁnite mass of nitrogen on 1st March, as do those in the dead plankton and fæcal pellets.

8.3.3.1. Stoichiometry. Each diatom has an implicit carbon pool, which varies in step with its nitrogen pool, following a prescribed Redﬁeld ratio. That ﬁxed C:N ratio is maintained in the transition between dissolved and particulate forms. Thus WB biology is nitrogen-driven. There is no link between this implicit carbon pool and the diatomÕs energy pool, which varies in response to photosynthesis, respiration and cell division. The obvious shortcomings of this simpliﬁed stoichiometry are addressed in more complex models (Sinerchia, 2005). Meanwhile, the WB version suﬃces to illustrate LE modelling.

8.3.3.2. Nitriﬁcation. Another weakness of the WB model is neglect of nitriﬁcation, the microbial process by which ammonium is converted to nitrate with a half-life of about one month. In the sea, nitriﬁcation ensures that each growing season starts with the dissolved nitrogen mainly as nitrate. Neglecting this process leads to an unrealistic transfer of nitrogen from nitrate to ammonium each year. This will be seen in the emergent properties (Fig. 7). Happily that does not aﬀect any other property of the ecosystem because WB diatoms do not discriminate between nitrate and ammonium.20

19 This facilitates diagnosis of regenerated production and f-ratio. 20 VEW Designer makes easy to introduce the missing process of nitriﬁcation, and that is featured in other models (Sinerchia, 2005). It
is worth noting at this point that the WB also omits the microbial conversion of nitrogen gas dissolved from the atmosphere into chemical species that can nourish phytoplankton. But it is not interesting to identify all the biochemical processes that are not featured
in the WB model. Their omission does not hinder our aim of illustrating LE modelling.

112 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
8.4. Biology The biological functions of diatoms, copepods, top predators and bacteria are illustrated in Fig. 4. The
corresponding equations and parameter values are listed in Appendix. 8.5. Phytoplankton
The WB model has a single functional group of phytoplankton with one species (Fig. 5). They are diatoms with three growth stages: motile, cyst and dead. Despite its conventional name, the motile stage has no locomotion; it just sinks through the water. Respiration varies only with ambient temperature. It takes up nitrogen, equally in the two available forms, nitrate and ammonium, until its nitrogen pool is full. Photosynthesis follows a parametrization recommended by John Steele. It ﬁlls the energy pool at a rate that depends on the ambient PAR and on the action spectrum of the diatomÕs chlorophyll. Photo-adaptation depends on the ambient PAR during the previous 4 h. Reproduction occurs when the two pools (nitrogen and energy) both exceed speciﬁed values. 8.5.1. Motion
The diatoms sink through the water at 1 m/d (about 2 cm per half-hour time step). They are also advected by the upwelling motion (zero in the case study), and they change depth randomly in response to turbulence, when they are in the mixing layer. Advection is computed before behaviour in each time step.
Fig. 4. Biology in the WB model. P = Phytoplankton (diatoms), Z = herbivorous zooplankton (copepods), Zc = carnivorous zooplankton (top predators), D = dead plankton, F = fæcal pellets, B = bacteria (remineralization), DIN = dissolved inorganic nitrogen, DIC = dissolved inorganic carbon, CO2 = carbon dioxide, SR = solar radiation, PAR = photosynthetically active radiation (400–700 nm). P, Z, D and F are explicit (represented by agents), and B and Zc are implicit (their demographies are prescribed).

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

113

Fig. 5. Physiology of motile phytoplankters in the WB model.
8.5.2. Energy 8.5.2.1. Energy pool. Every diatom agent has an energy pool. The content of the pool is the product of two dynamic variables: (1) the number of plankters in the sub-population, and (2) the energy per plankter. The level of the energy pool varies with input from photosynthesis and output to respiration and reproduction.
8.5.2.2. Respiration. Diatom respiration varies with ambient temperature (Ti). The energy pool is reduced every time step by Eresp = RL[0.3 + 0.7(Ti/Tr)], where the respiration parameter RL = 0.2 lJ/h and the reference temperature parameter Tr = 10 °C. When the diatom is in the cyst stage the respiration parameter is reduced to RL = 0.01 lJ/h.
8.5.2.3. Photo-adaptation. The photo-adaptation variable Im of a diatom depends on the history of its ambient irradiance (PAR) over the adaptation period, ta = 4 h in the case study.
Im(t) = Im(t À 1) + (Ii À Im) Æ (Dt/ta), where Ii is the diatomÕs ambient irradiance.
8.5.2.4. Photosynthesis. The energy pool of the ith diatom increases each time step by an amount Ephoto (J), which depends on its cross-section area (pA2i in m2), the ith diatomÕs ambient irradiance and the photoadaptation variable. Ai is the radius of the diatomÕs equivalent spherical volume.
Ephoto ¼ kF pA2i Ii exp½ÀðIi=ImÞ Á Dt; where the photosynthetic parameter kF = 0.63 W/m2 per W/m2 of PAR.
8.5.3. Nutrients Planktonica automatically adds a Droop pool to each diatom agent for every chemical speciﬁed by the
user. The level of each nutrient pool equals the product of the nutrient mass of each diatom and the number

114 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
of diatoms in the sub-population. The pool (lmol N per diatom) increases as the result of nutrient uptake, which depends on its ambient concentration of the nutrient: nitrate (N) or ammonia (A), both in mmol N/m3.
In one time step (Dt) the increase in a nutrient pool per diatom (Npool i or Apool i) of the ith diatom agent is given by
DN pool i ¼ U N ½N i=ðN i þ kN ÞDt and DApool i ¼ U A½Ai=ðAi þ kAÞDt; where UN = UA = 4 · 1010 mmol N/h, and kN = kA = 0.5 mmol N/m3.
The total nitrogen per diatom is calculated by summing N and A. The WB model forbids a diatom from having more than 7.6 · 10À9 mmol N. The uptake of N and A in any time step is scaled back to prevent the pool overﬂowing. This reduction is important for computing the depletion of dissolved nutrients.
8.5.4. Reproduction The diatoms in the sub-population reproduce simultaneously when the energy and nitrogen pools both
exceed their respective threshold values. The number of diatoms in the sub-population is then doubled, and the energy pool is reduced by DE = 140 lJ per new diatom. The total nitrogen pool for the sub-population is unchanged. When reproduction is light-limited, the nutrient pool exceeds the threshold before reproduction and the surplus is left in the pool.
8.5.4.1. Energy reserve parameter. Light-limited reproduction occurs most frequently in the afternoon (Fig. 15b). That leaves little time for the diatom to recharge its energy pool before sunset. There is a risk that the energy stored is insuﬃcient to cover the loss by respiration during the night. When that happens all the diatoms in the sub-population die, and the agent is removed from the computation. The energy reserve parameter e was introduced into the WB model to reduce the incidence of this ‘‘infant mortality’’. Doing so involves a demographic cost. Reproduction is delayed until the energy pool exceeds the threshold for reproduction plus e. Using natural selection, Al-Battran et al. (1998) found that the optimal value for e = 16 lJ in the Azores VE. However e = 0 in the case study. The consequences of this simpliﬁcation can be seen in Fig. 15(d).
8.5.5. Weight Each diatom has a prescribed weight Wd = 4.6 · 10À4 lg C. That is the carbon ingested by a copepod
when it eats a diatom.
8.5.6. Cyst stage The criteria for a diatom to metamorphose to and from the cyst stage is based on day of the year (dyear)
in the case study. The dates speciﬁed for the case study were 1st November and 31st January respectively. The carbon content of the cyst is the same as for a motile diatom. The nitrogen pool is conserved, the energy pool is slowly reduced by respiration.
8.6. Zooplankton
The functional group of herbivorous zooplankton in the WB model has the equations for a calanoid copepod. In the case study it has a single species like Calanus ﬁnmarchicus. The explicit population in the mesocosm is divided into six hundred sub-populations per generation, each associated with one agent in the computation. The physiology of a copepod is illustrated in Fig. 6.
8.6.1. Life cycle Copepods in the WB model have seven stages: eggs, hatchling, juvenile, diapause, adult, senescent and
dead.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

115

Fig. 6. Physiology of copepods in the WB model.
An adult copepod produces a single clutch of eggs during its lifetime, then dies. The eggs are hatched in one time step. Thereafter they constitute the sub-population in a new agent of the computation. The audit trail of that agent records the decline in the number of copepods in the sub-population, the result of predation by carnivorous zooplankton (the WB top predators). It also records the ambient concentration of the diatoms on which the copepods prey. And it records the staged growth and behaviour of the copepods in this sub-population until the survivors reproduce and die.
A juvenile copepod ingests diatoms at a rate that depends on its size (expressed in lg C), and on the ambient concentration of prey (diatom/m3). It puts on weight at a rate equal to 10% of the ingested carbon. It also retains enough of the nitrogen in the ingested diatoms to maintain the uniform Redﬁeld ratio found in WB plankton. Each time step the surplus carbon and nitrogen are either excreted as a liquid (DIC and DIN) or egested in a fæcal pellet. A copepod increases its weight by a factor of 500 between hatchling and adult, from 0.2 to 100 lg C. This is a continuous process, i.e. it is not staged. The WB model does not distinguish between carbon used for body structure and energy reserve.
Most of the copepods in a sub-population die before they attain a body weight of 100 lg C. Those that do, become adults. These adult copepods continue to ingest diatoms as in their youth, but they do not increase body weight. The retained carbon goes into growing a clutch of eggs. This continues for 20 days. The number of eggs in the clutch depends on the number of diatoms ingested during this gestation period. The clutch contains typically about 1000 eggs per copepod. At the end of 20 days, the eggs are hatched and the adult progresses to the next stage, senescence.
In this senescent stage, a copepod continues to prey on diatoms at a rate that depends on its body weight, which now resumes growing as during the juvenile stage. However, its days are numbered. Senescence lasts for only twenty days. During that period, for any agent in the computation, the WB model prescribes that

116 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
the number of copepods in any sub-population decreases linearly until the last one is dead. The agent is then removed from the computation.
The eggs from the copepods in an adult sub-population all hatch in the same time step. These hatchlings become the sub-population of a new agent, which follows an independent trajectory. During this stage, which lasts only one time step, the hatchlings suﬀer extraordinary loss to top predators; only 10% survive. The survivors become juveniles and pursue the life history described above. The carbon and nitrogen removed by predation on hatchlings are returned to the seawater.

8.6.2. Respiration A copepodÕs carbon pool declines by respiration at a rate that depends on its weight, G, and ambient
temperature.

DC ¼ ðRbas þ RassÞDt;

where the basal Rb = 0.3 · 10À3 g C/h

respiration = 0.8 lg C/s;

Rbas and

¼ Rb½kbGm0.a7x þ ðT =T rÞG0.7 in the cost of assimilating ingested

which diatoms

the Rass

basal parameter, = RskakcIg, where Ig

is the number of diatoms ingested per second, the three dimensionless parameters Rass = 0.3, ka = 1, kb = 0.1, and the carbon content of each diatom is kc = 4.6 · 10À4 lg C.

8.6.3. Excretion 8.6.3.1. Carbon. The basal and ingestion-dependent respiration are excreted each time step as DIC.

8.6.3.2. Nitrogen. In the WB model, excretion maintains a ﬁxed carbon:nitrogen ratio. So the loss of nitrogen from the nitrogen pools (nitrate and ammonium are represented separately following the Planktonica convention) is determined by the respiration rate. The lost nitrogen is excreted each time step as DIN (ammonium).

8.6.4. Egestion
Each time step a copepod egests a fæcal pellet that contains two-thirds of the carbon ingested in that time step, plus nitrogen at the standard C:N ratio. Carbon content of the pellet Cpellet = 1 À ka(1 À Rs)kcIgDt Nitrogen content of the pellet Npellet = AcCpellet The Redﬁeld ratio Ac = 106C:16N

8.6.5. Fæcal pellets The fæcal pellet is modelled by a new agent, which sinks at 1m/d. It contains Droop pools for carbon and
nitrogen. An implicit population of bacteria attached to the pellet slowly remineralizes its carbon and nitrogen. Its C and N pools decline at a rate proportional to their content at each time step. This rule is like that used to model radio-active decay. Most of the C and N is remineralized before the pellets reach a depth of 500 m, when they sink through the lower boundary of the mesocosm. Pellets are then removed from the computation, and their remaining C and N are lost to the deep ocean.
8.6.6. Motility A juvenile, adult or senescent copepod swims at a speed w that is determined by its weight, G. The ver-
tical displacement in one time step is given by
Dz ¼ ÆV maxW TGDt;

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

117

where the maximum swimming speed is a model parameter Vmax = 0.0125 m/s; WTG = 0.3 + 0.7(T/Tr) (G/Gmax)0.7, for juvenile and adult copepods (G 6 Gmax), or WTG = 0.3 + 0.7(T/Tr), for senescent copepods (>Gmax); T is the copepodÕs ambient temperature; and the reference temperature Tr = 10 °C is a model parameter.
The copepod uses this motility to migrate diurnally and in winter.

8.6.6.1. Diel migration. A motile copepod migrates down in the morning/forenoon, reaches a maximum depth at noon, and then migrates up during the afternoon/evening. The WB rule for this diel migration is based on the idea that the copepod is pursuing a target isolume with irradiance in the range 1 < It < 2 W/m2 of PAR. The target isolume has an irradiance that depends on the copepodÕs satiation, S (deﬁned below).
The migration behaviour depends on the diﬀerence DI between the copepodÕs ambient irradiance IV (W/m2 of PAR) and its target irradiance It = Ir(2 À S), where Ir = 1 W/m2 is the target isolume when the copepod is not hungry.
The direction of swimming is determined by min[max(DI À 1), 1]. The copepodÕs swimming speed V depends on three factors: the ﬁrst (G/Gmax)0.7 represents its cross-section area, the second (T/Tr) represents it ambient temperature, and the third is the maximum possible speed for copepods, Vmax.
V ¼ ½0.3 þ 0.7ðG=GmaxÞ0.7ðT =T rÞV max.
The change in depth in one time step due to diel migration is given by
Dzdm ¼ min½maxðDI À 1Þ; 1V Dt.
8.6.6.2. Foraging. When I < It the copepod switches from diel migration to nocturnal foraging. The target isolume ascends so rapidly in the afternoon that the transition can occur when the copepod is still in the thermocline (Fig. 11). The foraging rule is designed to maximize the copepodÕs ingestion in the thermocline where the prey concentration varies with depth. (It is homogenous in the mixing layer.) That is achieved by reversing the swimming direction when the prey concentration is decreasing.

8.6.6.3. Hibernation. In autumn the copepod enters the diapause stage and migrates down to the winter depth zOW = 350 m. It descends at its swimming speed V = VmaxWTG. It starts its descent on 1st November and starts its ascent on 1st March. While in diapause the respiration is 10% of the juvenile rate for its weight (based on Mauchline, 1998.)

8.6.7. Ingestion A copepod feeds on diatoms. It ingests Ig diatoms per second. The carbon assimilation rate is Ig · Wd,
where each diatom yields Wd = 4.6 · 10À4 lg C.
If P 6 Pmin, Ig = 0. If P > Pmin, Ig = F(s1 + s2S)WTGPMDt.
The eﬀective prey concentration (PM diatom/m3) takes account of variation in diatom concentration P(z) encountered by the migrating copepod during one time step (Table 3). PM = Integral from z(t) to z(t + 1) of
½ðP ðzÞ À P minÞ Á fðP ðzÞ À P minÞ=ðP ðzÞ À P minkI Þg=½maxf1 Â 10À5; zðtÞ À zðt À 1Þg.

118
Table 3 Ingestion parameters
Parameter
Filtrate rate Half saturation ingestion Threshold concentration Maximum ingestion

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

Symbol
F kI Pmin s1 s2

WB value
1 · 10À3 4 · 106 1 · 105 4.2 3.2

Units
m3/s diatom/m3 diatom/m3 diatom/s diatom/s

8.6.7.1. Ingestion during migration and foraging. The copepod feeds normally while migrating and foraging. It often swims so fast that it passes through several of the one-metre-thick layers used to deﬁne the environmental ﬁelds in the mesocosm. It spends a fraction of the time step in each layer. The number of diatoms ingested in each layer takes account of that fraction.
8.6.7.2. Satiation. A copepodÕs satiation is computed from its feeding success during the previous period tm = 4 h:
SðtÞ ¼ Sðt À 1Þ þ ½ðIg=Ig maxÞðDt=tmÞ.
8.6.7.3. Weight. The weight G of a copepod is deﬁned by its total carbon content (Table 4). Growth during the juvenile phase is not staged (i.e. no moulting).
CAss ¼ kcIgdt; where the carbon content, kc = 4.6 · 10À4 lg C/diatom. If CAss P R,
GðtÞ ¼ Gðt À 1Þ þ ½CAssðtÞ À RðtÞDt.
8.6.7.4. Cannibalism. If CAss < R, G(t + 1) = G(t). The number of copepods in the sub-population is reduced to make up the carbon deﬁcit:
N cðtÞ ¼ N cðt À 1Þð1 þ ðCAssðtÞ À RðtÞÞ=Gðt À 1Þ.
8.7. Top predators
The WB model includes an implicit population of carnivorous zooplankton which prey on the copepods.21 They are visual feeders. Their ingestion equation has ﬁve factors: (1) the size of the predator, (2) the action spectrum of its visual pigments, (3) the ambient irradiance in the spectral bands of those pigments, (4) the apparent size of the prey plankter, deﬁned by G2/3, and (5) the concentration of prey. The ingested carbon and nitrogen are excreted immediately as DIC and DIN, or egested as fæcal pellets, which are remineralized in the same way as copepod pellets. That is the chemical closure of the WB model.
The total number of copepods ingested by these carnivores in each layer of the mesocosm depends on the above ingestion formula and the concentration of top predators in the layer. The number is computed by summing over all copepod sub-populations in the layer (for all, or – if they are migrating – for part of the time step). The depletion is allocated to each copepod agent in proportion to the size of its sub-population. That is the trophic closure of the WB model.

21 Remember that an implicit population is not described by agents, but as a ﬁeld.

Table 4 Body weight of a copepod (Gi)
Stage
Egg Hatchling Juvenile
Minimum Maximum Adult Senescent Minimum Dead Initial

J.D. Woods / Progress in Oceanography 67 (2005) 84–159
WB weight (lg C) 0.2 0.2 0.2 100 100 100 Weight at death

119
Comment Fixed Fixed Dynamic growth; no moulting Fixed Dynamic increase (as Juvenile) Decline with remineralization

Top predator equations in the scenario deﬁne seasonal variation in the size of top predators and their concentration per square metre in the mesocosm, and their distribution with depth. These exogenous properties are not inﬂuenced by the ingestion of copepods. The size and concentration are independent of time and depth in the case study.
8.8. The Azores scenario
The model is integrated with initial and boundary conditions derived from the scenario. They are computed from global data sets for exogenous properties. The principal data sets describe the atmosphere, ocean circulation and nutrient concentration. The case study used the Azores scenario described here.
8.8.1. Mesocosm The scenario is designed to simulate the ecosystem in a mesocosm moored north of the Azores at [41°N,
27°W] where the ocean is deeper than 1 km. The mesoscosm is a tube with a vertical axis (Fig. 1). Its upper boundary lies on the sea surface, allowing air–sea ﬂuxes of radiation, heat and carbon dioxide. Its lower boundary lies 500 m below the sea surface. It is open to allow particles to sink freely into the deep ocean. It was assumed that advection through the side wall produce no ﬂux divergence in any ecosystem variable at any depth. Furthermore, all particles are constrained to move only in the vertical direction; so no particle can pass through the side wall.
8.8.2. Boundary conditions The virtual ecosystem adjusts over a few years to an attractor that is in balance with the boundary con-
ditions, the model and the resource (nitrogen). The boundary conditions provide exogenous forcing throughout the integration. They comprise a time series of ﬂuxes through the upper boundary of the mesocosm at every time step of the integration. This large data ﬁle is prepared before the integration begins. It describes the surface ﬂuxes of solar radiation and heat, and the partial pressure of carbon dioxide in the atmosphere (ApCO2).
8.8.2.1. Solar radiation. Solar radiation enters the mesocosm through its upper boundary as vertical irradiances in 25 spectral bands (Table 2). They are computed from a solar beam comprising a set of irradiance vectors with a common direction computed from an astronomical formula for solar elevation as a function of latitude, longitude, local time of day and day of the year. SnellÕs law is used to correct the vector for refraction at the air-sea interface. The along-beam irradiance entering the sea is computed in each waveband from the solar spectrum, atmospheric losses due to Rayleigh and particulate scattering, ozone and

120 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
clouds, and the albedo of the sea (Woods, Barkmann, & Horch, 1985). Light entering the sea after scattering in the atmosphere is ignored in the case study.
8.8.2.2. Air–sea heat ﬂuxes. The ocean loses heat to the atmosphere as the result of air–sea ﬂuxes of sensible, latent and net IR radiation. The scenario extracts values for these ﬂuxes from the ERA40 monthly-mean data set. There is no signiﬁcant diﬀerence between ERA40 and BunkerÕs climatology at the site of this case study.22 The choice of monthly-mean data has a number of advantages for the case study. The aim is to show how biological processes aﬀect the diurnal and seasonal variations in the emergent properties of the virtual ecosystem. That task would have been more diﬃcult if the scenario had included weather-induced ﬂuctuations. The results of the case study can be related better to the stability investigation by WPB, who exploited the fact that this monthly-mean scenario provides a stationary annual cycle of exogenous forcing.
8.8.2.3. Carbon dioxide. In this case study, the atmospheric concentration of carbon dioxide was 355 ppmv. The net IR ﬂux takes account of this constant CO2 concentration. WPB also reports a numerical experiment in which it doubled over 50 years. That decreased net IR cooling to the atmosphere by 5 W/m2. The ecological impact of this change was a reduction in winter mixed layer depth, and therefore in the nutrient resource in the euphotic zone.
8.8.3. Initial conditions Integration of the WB model was initialized at midnight on the 1st March, which is a few days before the
end of the cooling season when the mixed layer attains its annual maximum depth at the Azores. The initial conditions were based on a combination of climatological data and the experience of preliminary numerical experiments. I noted earlier that after a few years the virtual ecosystem adjusts to an attractor in balance with the boundary conditions. There is then no legacy from initialization errors. There is one exception to that rule. The attractor is shaped by the resource available to the ecosystem. Any error in the initial value of nutrient concentration does not decay.
8.8.3.1. Nutrients. That resource is deﬁned by the initial proﬁle of nitrate concentration on 1st March, which was synthesized from the annual mean proﬁle in the NOAA world ocean atlas by the method described (Section 4.1.2) earlier. The mixed layer concentration on 1st March was 5.4 mmol N/m3.
8.8.3.2. Other initial conditions. A preliminary numerical experiment was run to discover the state of the ecosystem for that nutrient concentration on 1st March. The state of the Azores virtual ecosystem on 1st March in the sixth year was recorded. It was known from WPB that the virtual ecosystem would then be on-attractor. This state of the virtual ecosystem on 1st March was used to initialize all further simulations in this case study.
8.9. Particle management
The following criteria were used to split sub-populations in the case study. For diatoms, the largest subpopulation was split whenever the number of agents fell below 200 per metre in the mixed layer. The largest
22 This is interesting given the fact that the two climatologies are derived from quite diﬀerent kinds of observation. BunkerÕs comes from ship observations in the days when overseas trade was carried by many more, but smaller ships than today. ERA40 comes from global modelling fed largely by terrestrial observations, plus satellite observations in recent years (Garnier, Barnier, Siefridt, & Beranger, 2000).

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

121

copepod sub-population was split whenever the total number of agents in the mesocosm fell below 600 in each generation of living copepods.

8.10. Integration

The Azores virtual ecosystem was created by integrating the WB model under the Azores scenario for six simulated years. (This took about 6 h on a 2 GHz personal computer with 2 Gb of RAM). The legacy of initialization errors decayed over the ﬁrst three years. By the fourth year the VE was in balance with the scenario for (1) the surface boundary conditions, (2) the top predator equations, and (3) the initial resource (nutrient load). Thereafter the VE exhibited a stationary annual cycle on this attractor.

8.11. The data set

The following variables were logged every half-hour in the sixth year (17,520 time steps). The resulting time series of emergent properties were exported to VEW Analyser.

(1) Environmental ﬁelds. Temperature, solar irradiance, seawater turbidity, turbocline depth, concentrations of nitrate, ammonium, dissolved inorganic carbon, and OpCO2.
(2) Audit trails. Biochemical state and activity (e.g. respiration and ingestion rates), sub-population demography, depth and ambient environment of all copepod agents (600 per generation) and 1000 diatom agents (selected from the total population of order 100,000).
(3) Demographic ﬁelds. The following data were computed from the sub-populations of individual plankton in each layer of the mesocosm. The demographic variables comprised: number of plankters, birth rate, death rate by natural mortality, death rate by predation, rate of change due to migration.

The total data set for one year was approximately one Gigabyte each for the ﬁeld data and the audit trails.

9. Case study – (2) Emergent properties
9.1. Introduction
I now explore the emergent properties of the Azores virtual ecosystem. The aim is to illustrate the potential of LE modelling by a case study using familiar NPZD biology. The illustrations show time series of diurnal and annual variation in the sixth year of a simulation. The ecosystem is then in balance with the scenario for exogenous forcing; it is on-attractor.
The ﬁrst group of illustrations describe ecological phenomena, deﬁned as those emergent properties that can in principle be observed. The ﬁgures show changes in an emergent property at one depth, or in a synoptic proﬁle (i.e. the vertical distribution of that property in the mesocosm), or in a depth-time contour plot. Fig. 7 shows how environmental variables vary diurnally and annually. The variables are turbulence, stratiﬁcation, turbidity, solar radiation, nitrogen and carbon. The next section (Fig. 8) presents a classiﬁcation of the plankton habitats, based on diurnal and annual variation of turbulence and nutrients. It will be used to relate ecosystem phenomena to ecological processes.
I then turn to the unique emergent property of LE modelling, the audit trail. An audit trail comprises a set of time series for one agent. It describes changes in the agentÕs location (depth, latitude and longitude), its ambient environment, the biochemical state of the plankters in its sub-population (they are identical in every respect), and the demography of its sub-population. The audit trails are present in four groups showing the diurnal and seasonal variation in phytoplankton and zooplankton. Figs. 9 and 10 document

122 J.D. Woods / Progress in Oceanography 67 (2005) 84–159 Fig. 7. Diurnal and annual variation of the environment in the Azores virtual ecosystem.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

123

phytoplankton agent 860408. Figs. 11 and 12 shows two generations in one zooplankton lineage (agents 3001 and 3601 respectively).
The third section concerns variability within the plankton populations, which is illustrated by comparing the audit trails of seven phytoplankton agents (Fig. 13) and three zooplankton agents (Fig. 14). The following sections describe the annual change in the biological environment. This is deﬁned as the synoptic proﬁles of demographic properties for each population of plankton population and detritus. Fig. 15 shows demographic proﬁles for the phytoplankton population, including the concentration of diatoms, and their rates of change due to reproduction, natural mortality and grazing. The demographic proﬁles for zooplankton are presented in Fig. 16. They include the concentrations and biomass at noon and midnight (illustrating diel migration), the generation of stragglers by turbulence, and losses to carnivores (top predators). Fig. 17 illustrates the proﬁles of detritus (dead plankton and fæcal pellets) in terms of their nitrogen content. The uncertainty in these emergent properties is discussed brieﬂy with reference to the analysis of demographic noise presented in WPB.
Finally, I show how an unexpected property of the ecosystem can be explained in terms of ecological processes (Fig. 18). The procedure is illustrated by analysing the three-week modulation of primary production during summer oligotrophy. It is shown that this arises from fertilization by migrating zooplankton.

9.2. Environment

The environment in the water column is represented by time series of synoptic proﬁles of the following
variables: solar irradiance, turbulent kinetic energy, temperature, salinity, density, concentrations of dis-
solved nitrate, ammonia and inorganic carbon, and concentrations of living and dead phytoplankton
and zooplankton, and fæcal pellets. Fig. 7 illustrates the diurnal and annual variation of the physical and chemical environment in the top 100 m.23

9.2.1. Turbulence (Fig. 7(a)) Fig. 7(a) shows the diurnal variation of the surface mixing layer and PAR isolumes on 9–11 May. The
surface mixing layer is continuously turbulent between the sea surface and the turbocline (0 < z < h). The turbocline depth varies diurnally in response to solar heating, with a minimum at noon and a maximum about one hour after sunrise. The ﬂow is laminar below the turbocline. The daily minimum and maximum depths of the turbocline are labelled. The diurnal thermocline lies between them in the depth range hmax(d) > z > h(d, t).24 The seasonal thermocline lies below the daily maximum, hmax(d), which is deﬁned as the mixed layer depth, H(d). The target isolumes for zooplankton migration lie in the diurnal thermocline for most of the hours of daylight at this time of year.

9.2.1.1. Cooling season. The mixed layer begins to deepen after the summer solstice (Fig. 7b–f). The maximum rate of deepening approaches but never exceeds 1 m/d. So phytoplankton, detritus and fæcal pellets, which all sink at 1 m/d, can never be entrained into the mixed layer. However, seawater is entrained from the seasonal thermocline into the mixed layer as H increases in autumn and winter. The diurnal thermocline disappears during November and December when solar heating is weaker than cooling to the atmosphere throughout the day. It reforms after the winter solstice, and extends upwards as the day length increases. Stratiﬁcation in the diurnal thermocline permits primary production to increase during winter, while the mixed layer is deepening (Woods & Barkmann, 1993; WPB Fig. 11).

23 Deﬁnitions: mixing layer, 0 < z < h(d, t); mixed layer, 0 < z < hmax(d) = H(d); diurnal thermocline, h(d, t) < z < H(d); seasonal
thermocline, H(y, d) < z < Hmax(y); permanent thermocline, z > Hmax(y). 24 Nomenclature: y is the year, d is the day of the year, t is the local time.

124 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
9.2.2. Temperature (Fig. 7(b)) The temperature of the mixed layer rises to a maximum in late August. The isotherms show how sub-
duction creates thermal stratiﬁcation in the seasonal thermocline as the mixed layer shoals during spring. Isotherms are vertical in the mixed layer, where turbulence homogenizes the temperature each night. There is no turbulent diﬀusion of heat in the seasonal thermocline where the ﬂow is laminar. The isotherms would be horizontal in the seasonal thermocline if it were adiabatic. The downward slope indicates superior solar heating, which is modulated by the annual cycles of solar elevation, cloud cover and the seawater turbidity. Divergence of isotherms indicates solar heating in the thermocline. Note the ﬂattening of the isotherms during May and June when the turbidity is greatest (Fig. 7(c)).
9.2.3. Turbidity (Fig. 7(c)) During April, May and June the phytoplankton concentration in the top 40 m becomes so high that the
absorption of solar radiation by plankton exceeds that by seawater. The turbidity of the water is computed in the WB model from the chlorophyll concentration, which exceeds 5 mg C h l/m3 in mid-May. One month after the spring bloom peaks, the water has been cleared by grazing.
9.2.4. Photosynthetically-active radiation (PAR) (Fig. 7(d)) If there were no plankton in the water column, the annual variation of solar irradiance in the upper
ocean would be governed by the annual cycle of solar elevation and the cloudiness of the atmosphere. The depth of each isolume would then vary sinusoidally, with a maximum at the summer solstice and a minimum at the winter solstice. Turbidity modiﬁes that annual cycle. The isolumes are displaced upward during the period of the spring bloom (Fig. 7(d)). At the peak of the bloom the 1 W/m2 isolume lies just below the base of the mixed layer. Almost all of the solar heating occurs above that isolume, with the consequences for isotherms displayed in Fig. 7(b). The classical criterion for phytoplankton reproduction is that the mixed layer must be shallower than the isolume with 1% of the surface irradiance (ca. 300 W/m2 at noon). Fig. 7(a) shows that this compensation depth is shallower than the mixed layer in May. We shall see in Fig. 15b that primary production almost stops during that period due to self-shading.
The diurnal migration of zooplankton follows a target isolume of 2 W/m2 (Fig. 11). It lies in the mixed layer, in late April and early May (Fig. 7(a)). During this period zooplankton in the diurnal thermocline are nearly invisible to predators even at noon. So they can safely graze day and night on the rich concentration of phytoplankton in and just below the mixed layer. This ‘‘Darkness at noon’’ phenomenon explains the remarkably high daily ingestion rate of herbivores during the spring bloom, which has long puzzled biological oceanographers (Cushing, 1995).
9.2.5. Nitrate (Fig. 7(e)) Fig. 7(e) shows the annual cycle of nitrate concentration (mmol N/m3). Vertical isolines in the mixed
layer show homogenization by turbulence. Horizontal isolines in the seasonal thermocline show the absence of reproduction by phytoplankton (due to self-shading or low population). Downward sloping isolines in the thermocline reveal phytoplankton reproduction in the deep chlorophyll maximum (see also Fig. 15(c)).
As the mixed layer deepens in autumn and winter, it entrains nitrate-rich water from the seasonal thermocline. The surface concentration reaches a maximum in late February (see WPB Fig. 11). Phytoplankton take up nitrogen, reducing nitrate concentration in the mixed layer at a rate that increases with primary production. By mid April the nitrate concentration is declining noticeably, and on the 5th May is has fallen to zero in the mixed layer. That marks the onset of summer oligotrophy. As nitrate declines in the mixed layer, water is subducted shallower into the seasonal thermocline with progressively lower values of nitrate concentration. This produces a nutricline in the vertical proﬁle of nitrate concentration at a depth of about 30 m.
The upper bound of the nutricline is conveniently marked by the contour for 0.1 mmol N/m3. The depth of this contour starts at 27 m, and during May it is horizontal, indicating that there is no primary produc-

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

125

tion at this depth during the self-shading hiatus. However, production resumes below the nutricline after grazing has cleared the water, allowing light to penetrate the thermocline (Fig. 7(d)). The contours in the nutricline start to descend at the end of May, indicating that nitrate is again being consumed by phytoplankton. These are energy-rich/nitrogen-starved diatoms sinking down from the oligotrophic mixed layer where their population is sustained by zooplankton fertilization (Fig. 18). Later in the summer the slope of the isolines decreases with the decline in the ﬂux of energy-rich/nutrient starved diatoms sinking into the nutricline (Fig. 15(a)).
Biological oceanographers sometimes deﬁne annual new production by the mass of nitrogen consumed between the dates of Nmax and onset of summer oligotrophy (Eppley, 1989). There is already some regenerated growth in that period of light-limited reproduction, due mainly to remineralization of dead phytoplankton (Fig. 17). New production continues throughout the summer below the nutricline. The zone of phytoplankton growing below the nutricline is normally referred to as the ‘‘deep chlorophyll layer’’.
The mixed layer deepens in autumn, passing through the nutricline on 4th November. Thereafter, as the mixed layer deepens, nitrate is entrained from the seasonal thermocline into the mixed layer at a rate faster than it is consumed by the phytoplankton, with the result that the surface nitrate concentration rises. According to the traditional deﬁnition, the slow consumption of nitrate by phytoplankton during this cooling period is also a part of the annual new production, but it is small compared with the spring bloom and therefore not normally included in the annual budget.
The diurnal thermocline rises above the compensation depth in mid-February. The rate of nitrate consumption then exceeds the rate of gain from entrainment, and the mixed layer concentration begins to decline. This occurs two weeks before the mixed layer depth reaches its annual maximum Hmax(y) (see WPB Fig. 11(b)).
The surface concentration of nitrate is lower on 28th February than it was on the previous 1st March. The diﬀerence represents the annual conversion of nitrate to ammonia. As I noted earlier, the WB model does not include microbial regeneration of nitrate from ammonia. This shortcoming does not aﬀect the biological processes, because the phytoplankton do not discriminate between nitrate and ammonia.25

9.2.6. Ammonia (Fig. 7(f)) Fig. 7(f) shows the annual cycle of ammonia concentration in contours of Log10(mmol N/m3). The sum-
mer increase of ammonia below the nutricline comes from zooplankton excretion and from microbial action on fæcal pellets and dead plankton. That source exceeds the rate of consumption by phytoplankton.
The initial conditions for the simulation contained no ammonia, but the stock in the VE increases each year with a commensurate decline in nitrate. Fig. 7(f) shows how the vertical distribution of ammonia changes during the sixth year. The pattern echoes that of nitrate, with a nutricline formed in early May at 25 m, and stabilizing at 30 m. So the nutriclines for nitrate and ammonia (as deﬁned by 0.1 mmol N/m3) coincide within the 1m vertical resolution of the environment. However, the proﬁles diﬀer signiﬁcantly because of the ammonia source term. Below the nutricline, the ammonia concentration has a broad maximum between 30 and 60 m. The rate of generation exceeds the consumption by primary production below the nutricline.
Above the nutricline the concentration is much lower, but unlike nitrate it is not zero. Its structure is revealed by the logarithmic scale in Fig. 7(f). All primary production above the nutricline is fertilized by nitrogen from zooplankton. This ammonia was formed during the previous month; so primary production above the nutricline is ‘‘regenerated’’. The monthly-mean concentration of ammonia in the mixed layer de-

25 The total nitrogen in the mixed layer follows a stable annual attractor, despite this net annual transfer from nitrate to ammonia.

126 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
clines during summer oligotrophy. It also ﬂuctuates with a period of 2–3 weeks due to periodic change in the depth of zooplankton foraging. This will be explained later (Fig. 18).
9.2.7. Dissolved inorganic carbon (Fig. 7(g)) Dissolved inorganic carbon (DIC) is consumed by phytoplankton during photosynthesis. It is released
by zooplankton respiration and excretion, and by microbial action on dead plankton and fæcal pellets. DIC is homogenized by turbulence in the mixing layer. Fig. 7(g) shows how the proﬁle of DIC changes during the year. The source term for DIC below the nutricline is similar to that for DIN (Fig. 7(f)) reﬂecting the fact that the N:C ratio is constant in excretion, egestion and remineralization. The distribution of DIC differs from that of DIN because it depends not only on biological processes, but also on the ﬂux of carbon dioxide through the sea surface. That ﬂux depends on the changing partial pressure of CO2 in the mixing layer. The DIC-sparse layer in the seasonal thermocline was subducted during the spring bloom when DIC was depleted by primary production in the mixed layer faster than it could be replaced by inﬂow from the air.
9.2.8. Partial pressure of dissolved carbon dioxide (Fig. 7(h)) The partial pressure of carbon dioxide dissolved in seawater (OpCO2) increases with DIC and temper-
ature. At the Azores, OpCO2 exceeds ApCO2 during summer and is less in winter, so carbon dioxide outgases in summer and ﬂows into the ocean during winter. The annual cycle of OpCO2 is modulated by summer heating and the consumption of DIC by phytoplankton and its release by zooplankton and bacteria. The WB model includes chemical equations for computing OpCO2 from DIC and temperature. The annual cycle in the proﬁle of OpCO2 is shown in Fig. 7(h). The seawater depleted of DIC by the spring bloom is subducted from the mixed layer into the seasonal thermocline where the temperature remains fairly steady (it rises slightly due to deep solar heating, see Fig. 7(b)). Primary production in the deep chlorophyll maximum (below the nutricline) causes further depletion of DIC. During summer oligotrophy, primary production is low in the mixed layer so changes in surface OpCO2 depend mainly on the temperature rise. OpCO2 begins to decline in the autumn as the temperature falls, but drops rapidly when the deepening mixed layer reaches the nutricline and starts to entrain the DIC-depleted water. That sharp decline in
Fig. 8. Annual cycle of environment of the habitats deﬁned in Table 5. N(d) is the nutricline, H(d) is the mixed layer depth, h(d, t) is the turbocline depth (shown for t = local noon).

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

127

Table 5 Habitats

No. Name

Depth range

Flow

Light

Nutrient

Eutrophic (i.e. rapid recharging of diatom nitrogen pool; see Fig. 13)

Ia Mixing layer

0 < z < h(t) when h(t) > N(d)

Ib Diurnal thermocline

h(t) < z < H(d) = maximum value of h in

last 24 hours, when h(t) > N(d)

1c Lower summer thermocline N(d) < z < Hmax(y) = maximum value of H(d) in last 365 days

III Permanent thermocline

Z > Hmax(y)

Turbulent Laminar
Laminar
Laminar

Very strong Strong
Medium
Very low

High High
High
High

Oligotrophic (i.e. very slow recharging of diatom nutrient pool; see Fig. 13)

IIa Mixing layer

0 < z < h(t)

IIb Diurnal thermocline

h(t) < z < H(d) = maximum value of h in

last 24 hours

IIc Upper summer thermocline H(d) < z < N(d) = nutricline depth

Turbulent Very strong Fertilized by zooplankton

Laminar Strong

Fertilized by zooplankton

Laminar Low

Fertilized by zooplankton

OpCO2 is enhanced by the consumption of DIC in the autumn bloom triggered by the entrainment of nutrients from below the nutricline (Fig. 15b).
9.3. Habitats
The long-term survival of the zooplankton population is due in part to the ability of its members to migrate and forage in diﬀerent habitats. In VEs based on the WB model, zooplankton migration is driven by predator avoidance. They descend each forenoon in pursuit of a target isolume, the depth of which depends on the changing proﬁle of phytoplankton concentration due to bio-optical feedback (Fig. 7(c)). Foraging also depends on the proﬁle of phytoplankton concentration. So it is appropriate to deﬁne habitats in terms of the conditions that control primary production: turbulence, light and nitrogen.
Such a scheme is illustrated in Fig. 8 with deﬁnitions in Table 5. The phytoplankton have diﬀerent reproductive success in the various habitats. The growing season starts soon after the winter solstice when the diurnal thermocline (Ib) starts to provide daytime stratiﬁcation above the photosynthetic compensation depth (Woods & Barkmann, 1993). As the mixed layer (Ia and Ib) becomes shallower, light-limited primary production accelerates until the nutrients are exhausted on 4th May.
That event marks the annual maximum in the phytoplankton population (Pmax), and the transition to summer oligotrophy (habitat II). A fortnight before that the concentration of phytoplankton has become so high that self-shading (Fig. 7(b)) stops reproduction below the mixed layer (Fig. 15(d)). During this period of high turbidity, the target isolume for zooplankton diel migration rises into the mixed layer (Fig. 7(a)), so copepods can feed day and night in the food-rich habitat Ia,b with low risk of being seen and eaten by predators. The resulting rapid grazing clears the phytoplankton canopy. The copepods continue to put on weight quickly and reproduce within two weeks of the onset of oligotrophy. As the water clears the target isolume for zooplankton diel migration again reaches 100 m at noon. The new generation of copepodites cannot swim fast enough to track the target isolume, and they suﬀer high losses to predators. But the survivors put on weight fast and within a few weeks they are strong enough to swim down into the dark during the day and so reduce the risk of being seen and eaten.
Summer oligotrophy persists in habitats IIa,b,c from 4th May when the mixed layer nitrogen is exhausted until 10th November when the deepening mixed layer penetrates the nutricline and entrains nitrogen. The nutricline marks the base of the oligotrophic regime. Its initial depth (25 m) was set by the depth of the mixed layer on the day that nutrients ran out. Thereafter it descends at a rate controlled by primary production in the deep chlorophyll maximum located just below the nutricline,

128 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
where the two pre-requisites for diatom cell division (light and nutrients) are both satisﬁed. In the WB model reproduction in the deep chlorophyll maximum occurs in energy-rich/nutrient-starved diatoms that sink through the nutricline.26
Above the nutricline (habitats IIa,b,c) diatoms tend to have full energy pools but empty nitrogen pools. They can only reproduce in these habitats if nitrogen is injected. That is done by zooplankton, which migrate up at night carrying nitrogen in their bodies. Some of this living particulate nitrogen is released into the water as ammonia when copepods are eaten. Additional ammonia is released when the copepods eat some of the few diatoms remaining in habitat II. Microbial action on the fæcal pellets egested by grazing copepods and their predators also releases ammonia into this oligotrophic habitat. Copepods eaten above the nutricline sacriﬁce all their nitrogen. In these ways zooplankton fertilize the phytoplankton in habitat II. We shall see later that this process follows a three-week cycle. The changes occuring in zooplankton subpopulations as they migrate through these diﬀerent habitats are most clearly revealed by audit trails (Figs. 11 and 12).
9.4. Audit trails
Audit trails are the signature products of Virtual Plankton Ecology. They eliminate the need for speculation about the causes of bulk phenomena. They document intra-population variation. And they provide a bridge of understanding between biological primitive equations and emergent demography.
Each audit trail comprises a set of time-series documenting the life history of a plankton agent and its sub-population. It has four parts: (1) location (latitude, longitude, depth), (2) ambient environment, (3) the biochemical state of its plankters, and (4) the demography of the sub-population. The location changes in response to advection by the water, random displacement by turbulence, and the motion of the plankton relative to the water (sinking or swimming). The ambient environment comprises the values of the physical, chemical and biological ﬁelds at the location of the sub-population. The plankters in a sub-population are identical in all biochemical properties, including their state of adaptation. That is because they have followed the same trajectory and therefore sampled the environment identically.
The life history of every plankter in a sub-population is computed using the biological equations, which describe its response to the ambient environment. The primary demographic variable of the sub-population is the number of plankters. The secondary demographic variables are the contributions made to change in that number by reproduction and death (classiﬁed by various causes: starvation, disease, being eaten, senescence). The audit trails also reveals demographic changes caused by particle management (splitting and combination of sub-populations) which are not ecological, but a feature of the LE metamodel. I now discuss some of the main features revealed by audit trails of typical phytoplankton and zooplankton subpopulations.
9.4.1. Diurnal variation in a phytoplankton sub-population (Fig. 9) We start with the audit trail of a phytoplankton sub-population (No. 860408). It contains diatoms whose
forebears were all born and reproduced in the mixed layer since the simulation began ﬁve years earlier. Many of them were eaten by copepods; others died of natural mortality. In the latter case the whole sub-population died, so its agent disappeared from the simulation. However, some diatoms of the same lineage (descendents of those in an agent created at the start of the integration) had been split oﬀ into new sub-populations. So diatoms in the same lineage can live in sub-populations with code numbers diﬀerent from the original one. That is the case with agent 860408, which did not feature on the initial list; it was
26 Other individual-based models (notably that of Broekhuizen, 1999) contain dinoﬂagellates, motile phytoplankton adapted to exploit the nutricline, which are observed to be relatively abundant in summer.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

129

Fig. 9. Diurnal variation in a phytoplankton audit trail.
created later by splitting. Despite these technical complications, the original statement is valid: all the ancestors of the diatoms in sub-population 860408 lived in the mixed layer. Migration into the seasonal thermocline is a death sentence for diatoms; they cannot return to the mixed layer (given the sinking speed used in this case study).
9.4.1.1. Turbulence (Fig. 9(a)). The diurnal variation of the mixed layer was discussed earlier. Fig. 9(a) shows how the depth of sub-population 860408 is aﬀected by diurnal variation of the turbocline depth h(d,t) during the ﬁrst 10 days of May. The trajectory has two regimes. In the turbulent mixing layer it jumps randomly each time step to a new depth anywhere in the range 0 < z < h(d, t). In the diurnal thermocline it sinks at 4 cm/h through laminar ﬂow. Transition between the two regimes depends on the processes of subduction during the morning and forenoon, and re-entrainment during the afternoon and evening.
If its small sinking speed is ignored, the sub-population enters the diurnal thermocline when by chance it lies in the layer that is subducted during that time step, h(d, t À 1) > z > h(d, t). A few hours later the subpopulation is either re-entrained into the mixing layer, or subducted into the seasonal thermocline depending on whether or not it lies in the depth range H(d) < z < H(d + 1) + Ddz, where Ddz < 1 m is the distance the particle sinks through the water during the hours its resides in the diurnal thermocline. Occasionally a particle remains in the mixing layer all day. The probability that it does so (i.e. that it is not subducted) is given by [hmin(d)+wDt]/hmax(d), where the plankter sinks at w m/s relative to the water. During the ﬁrst 10 days of May the probability that a diatom remains in the mixing layer is about 40%.

130 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
Sub-population 860408 remains in the mixed layer during the ﬁrst 10 days of May. On four of the 10 days (May 1, 6, 7 and 8) it remains all day in the turbulent mixing layer above the turbocline. On the other six days it is subducted into the diurnal thermocline, where it spends most of the daylight hours at a nearly constant depth. The depth to which the sub-population is subducted into the diurnal thermocline varies randomly from one day to the next. It resides deeper in the diurnal thermcoline when it is subducted earlier in the day.
9.4.1.2. Number of diatoms in the sub-population (Fig. 9(a)). The lower curve in Fig. 9(a) shows the number of diatoms in the sub-population. There are three reproduction events which double the sub-population on the 1st, 6th and 8th May. Between these events the number of diatoms declines due to grazing by copepods. The grazing rate is independent of depth in the mixed layer. It rises on the 6th of May causing the downward slope to increase. This is due to a change in the zooplankton population in the mixed layer, brought about by their periodic foraging behaviour (see below Fig. 18). LE particle management produces a splitting event on 8th May, shortly after reproduction (marked by a *). This halves the number of diatoms in this sub-population; the other half are allocated to a new sub-population which follows a diﬀerent trajectory. During the ﬁrst 10 days of May, the sub-population rose from 0.8 to 5 million diatoms; of which, 2.8 million were transferred to new sub-population (by splitting), 0.5 million were eaten by copepods; none died by starvation.
9.4.1.3. Nutrients (Fig. 9(b)). The ﬁrst 10 days of May see a rapid decline in the nitrogen concentration in the mixed layer, due to consumption during the spring bloom. Nitrate is exhausted on 9th May, and ammonia is reduced to one-third of its winter concentration. Ammonia regeneration since the start of the growing season contributes to its slower depletion. The bottom panel shows that each diatom in this sub-population spends most of the time replete with nitrogen, and that it replenishes its nitrogen pool within a few hours of a reproduction event. However replenishment after the third reproduction event takes twice as long as after the ﬁrst, because the ambient nitrogen concentration has declined.
9.4.1.4. Light adaptation (Fig. 9(c)). Phytoplankton in the WB model adapt to their recent history of ambient irradiance. The upper curve in Fig. 9(c) shows the ambient irradiance experienced by this sub-population during the ﬁrst 10 days of May. On days when it was subducted into the diurnal thermocline the ambient irradiance follows the astronomical variation of light at the subduction depth. Observations show that turbulence in the diurnal thermocline produces negligible vertical displacements (Lewis, Horne, Cullen, Oakey, & Platt, 1984; Woods, 2001); they are zero in the WB model. When a plankter passes the day in the mixing layer, its ambient irradiance is much brighter and ﬂickers as it is displaced up and down by turbulence. This phenomenon must be taken into account when estimating primary production from incubation experiments in the sea (Barkmann & Woods, 1997). Even on subduction days, there are often brief ﬂashes of ambient irradiance as turbulent gusts carry the sub-population up near the surface between sunrise and subduction.
The lower curve shows how the diatoms adapt to their recent history of ambient irradiance. On 4th May photo-adaptation optimizes photosynthesis in the relatively low ambient irradiance at its subduction depth of 24 m. The large variation of ambient irradiance from day to day was the evolutionary driver for the plankton to acquire photo-adaptation (Denman & Marra, 1986). Because the subduction depth is random (and therefore unpredictable) plankton have evolved a strategy for adaptation that tracks the astronomical change at the subduction depth each day. Natural selection has yielded an optimal adaptation time of a few hours. See the nocturnal relaxation in Fig. 9(c).
9.4.1.5. Energetics (Fig. 9(d)). The lower curve of Fig. 9(d) shows how the level of the energy pool of this sub-population changes during the ﬁrst 10 days of May. It declines at the same rate each night due to respiration. It rises during the hours of daylight while photosynthesis exceeds respiration. It falls to zero after reproduction, because the energy reserve parameter is zero, e = 0, in this version of the WB model. On the 4th of May the sub-population was subducted deep in the diurnal thermocline so the ambient irradiance

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

131

Fig. 10. Seasonal variation in a phytoplankton audit trail.
(upper curve) was weak, and energy uptake during the day barely covers the energy loss to respiration over 24 h. On 1st, 6th, 7th and 8th of May the sub-population remained in the mixing layer giving them high ambient irradiance, so their energy uptake greatly exceeds respiration, and the level of the energy pool rose substantially. The fastest rise was on the 7th of May, which supplied more than half of the energy needed for reproduction. The 6th and 8th of May were also days of high energy uptake, with the result that successive reproduction events occurred within less than 48 h. Normally the interval is longer at this time of year. Because the nitrogen pool was already full, reproduction occurred in each of these three occasions as soon as the energy pool reached the required level. Light-limited reproduction can only occur during the hours of daylight. This fact allows us to discriminate between light-limited and nutrient-limited production in plots of birth rate (see Fig. 15b).
9.4.2. Seasonal variation in a diatom sub-population Fig. 10 illustrates the life history of the same sub-population from 1st March to 3rd August in year six of
the simulation. This branch of the lineage, which has survived in the mixed layer for ﬁve years, is ﬁnally extinguished after being subducted into the seasonal thermocline.
9.4.2.1. Trajectory (Fig. 10(a)). The upper curves in Fig. 10(a) show the depths of the mixed layer and the sub-population at noon each day. The mixed layer has its annual maximum depth (Hmax = 230 m) on the 20th of March.27 The mixed layer starts to shoal on the day when solar heating ﬁrst exceeds cooling to the
27 The depth and date diﬀer slightly from those in the balanced Azores VE described in WPB, because here the correction terms DB = DN = DT = 0.

132 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
atmosphere. This is the start of the heating season. H(d) reaches a minimum at the end of June. The history of H(d) is modulated slightly by bio-optical feedback, with short-term noise because of the relatively small number of agents used to create this VPE.
Sub-population 860408 remains in the mixed layer until 30 May when it is subducted into the seasonal thermocline. Turbulence changes the noon depth randomly from day to day while it remains in the mixed layer. The ﬂow in the seasonal thermocline is laminar, so after subduction the trajectory is described by the planktersÕ slow descent through the water at one metre per day.
9.4.2.2. Number of diatoms in the sub-population (Fig. 10(a)). The lower curve in Fig. 10(a) shows the number of diatoms in the sub-population at noon each day. The number doubles at reproduction events marked by upward jumps in the curve. (The magnitude of the jump is independent of population because the scale is logarithmic.) The ﬁrst reproduction occurred just three days after the mixed layer started to shoal. The mixed layer and the sub-population were then much deeper than the depth at which the irradiance was 1% of the surface value, which is conventionally taken to indicate the population-mean compensation depth. That emphasizes the importance of intra-population variability. The star (*) marks a splitting event which occurs soon after reproduction on 28 March.
There are 13 reproduction events between the 1st March and the sub-populationÕs demise on the 4th of August. Eleven of them occur in 60 days during the light-limited phase of the spring bloom, before the transition to oligotrophy in May. There is a mean interval of three days between cell divisions in April. The interval increases to 18 days during summer oligotrophy. The last (light-limited) reproduction event occurs (by chance) at the summer solstice, when the sub-population is at a depth of 50 m and sinking slowly through laminar ﬂow in the seasonal thermocline.
Grazing reduces the number of diatoms in the sub-population between reproduction events. The rate is indicated by the declination of the curve. The rate is negligible early in the growing season, but increases during the spring bloom. During summer oligotrophy, grazing exceeds reproduction and the number of diatoms in the sub-population declines. The grazing rate increases sharply at the end of May after the new generation of copepods hatch (see Fig. 12). That happens a few days after this sub-population has been subducted into the seasonal thermocline. Grazing has reduced the sub-population to 60,000 diatoms on 3rd August when the survivors all die simultaneously by energy starvation. Natural mortality occurs only once in the life history of a sub-population. Up to that moment only two biological processes changed the number of diatoms in the sub-population: continuous grazing and occasional reproduction events. The intervention of natural mortality before all the diatoms have been eaten represents a loss of potential secondary production because zooplankton do not eat dead diatoms in the WB model. The seasonal rise and fall in this sub-population is similar to that of the whole population (Fig. 15 and WPB Fig. 11).
9.4.2.3. Ambient irradiance (Fig. 10(b)). The upper curve in Fig. 10(b) shows the ambient PAR at noon each day. Four factors inﬂuence the ambient irradiance: astronomical variation of solar elevation, cloud cover, turbidity of the overlying water column, and the depth of the agent. While it remains in the mixed layer, random changes in the agentÕs depth modulate the ambient irradiance more than the other three factors. However, increasing solar elevation and decreasing cloud cover (as the Azores anticyclone becomes established) slowly increase ambient irradiance during the early part of the spring bloom. The rise in the envelope of minima is due to the shoaling of the mixed layer, which limits the subduction depth each day. Later, the phytoplankton population in the mixed layer becomes suﬃciently dense to reduce light penetration signiﬁcantly (see Fig. 7(c) and (d)). The random variation of noon ambient irradiance stops when the sub-population is subducted into the seasonal thermocline on the 30th of May. Solar elevation is changing slowly at this time of year (near the summer solstice); so, too, is cloud cover (in the Azores anticyclone). The sub-populationÕs ambient irradiance at noon depends on two factors: its depth and the changing clarity of the overlying water. Initially the noon ambient irradiance increases each day, as grazing reduces turbid-

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

133

ity. But after 10th June the water is again clear and thereafter the noon ambient irradiance of the sub-population declines as its depth increases.

9.4.2.4. Energetics (Fig. 10(b)). The lower curve in Fig. 10(b) shows the history of the energy pool of diatoms in this sub-population at noon every day. Respiration causes the energy level to decline, photosynthesis makes it rise, and the level is reset to zero after each reproduction event. The variation from day to day is seen most clearly before the ﬁrst reproduction event. On days when the sub-population is deep during the day (top panel) the ambient irradiance is too low to balance respiration, so the energy level declines. The reproduction events produce sharp falls in energy level. The magnitude of the fall varies, because the curve samples the energy pool at noon, by which time it has replenished somewhat after reproduction at some time during the previous 24 h. Energy replenishment is slow in the seasonal thermocline, where the ambient irradiance declines each day as the sub-population sinks deeper. (This is after the solstice, so the noon solar elevation has begun to decrease each day.) On the 12th of July the daily energy gain from photosynthesis just balances the daily respiration rate, and thereafter the energy level falls ever faster. On the 3rd of August it becomes negative, causing the simultaneous death by energy starvation of the 60,000 diatoms then remaining in the sub-population.

9.4.2.5. Ambient nitrogen concentration (Fig. 10(c)). The upper curve of Fig. 10(c) shows the ambient ammonia concentration for the sub-population. Note that the right-hand scale is logarithmic. On the 1st of March the sub-population is in the mixed layer where the concentration of total nitrogen (ammonia plus nitrate) is 5.4 mmol/m3. This is the annual maximum value in the mixed layer, the result of winter entrainment from the seasonal thermocline. As the spring bloom progresses, the nitrogen in the mixed layer is depleted, becoming less than 1% of the winter concentration on 5th May. That marks the onset of summer oligotrophy and the end of ‘‘new’’ production in the mixed layer. The nutricline is created by subduction at a depth of 25 m on that day (Fig. 7(d),e). For the next 37 days the plankton in this sub-population experience summer oligotrophy. During that period the sub-populationÕs ambient concentration of nitrogen is provided by zooplankton excretion, and remineralization of fæcal pellets and dead diatoms. This nitrogen has already passed through at least one diatom since 1st March, so it is ‘‘regenerated’’ nitrogen.
After the sub-population has entered the seasonal thermocline (on the 30th of May) it sinks through ammonia ﬁne-structure, which is evolving in response to consumption and regeneration (Fig. 7(e)). So the planktersÕ ambient nitrogen concentration changes from day to day. On 12th June it rises sharply by a factor of 100 as the sub-population sinks through the nutricline. The sub-population is now immersed in a combination of new and regenerated nitrogen. The ambient concentration is higher than it was in the mixed layer on 1st March because ammonia has accumulated in the seasonal thermocline below the nutricline (Fig. 7(f)). The progressive accumulation is due to the fact that the light is so dim below 30 m (Fig. 7(c)) that primary production cannot consume ammonia as fast as it is being generated by microbial action (Fig. 17).
9.4.2.6. Nitrogen pool (Fig. 10(c)). The lower curve in Fig. 10(c) shows the noon value of the nitrogen pool in each diatom of the sub-population. The pool ﬁlls (up to a prescribed maximum value 7.5 pmol N/diatom) at a rate controlled by the ambient DIN concentration (regardless of whether it is in the form of nitrate or ammonia). At reproduction events, it falls by the threshold amount for cell division, 5.5 pmol N. Before the onset of summer oligotrophy, the replenishment time is so short that it reaches the maximum value before the next noon, so the curve (which samples the nitrogen pool only once per day at noon) does not normally show a downward blip at reproduction events. Exceptions occur on 7th and 30th April when reproduction occurred just before noon. However, replenishment of the nitrogen pool takes several days during summer oligotrophy (when the ambient nitrogen concentration is less than 1% of that on 1st

134 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
Fig. 11. Diurnal variation in a zooplankton audit trail.
March). Reproduction is then nitrogen-limited. There is time for only two nutrient-limited reproduction events to occur before the diatoms plunge through the nutricline. Their nutrient pool then quickly reﬁlls. It recovers so fast after the one remaining reproduction event that no blip is seen in the history of noon samples. Once below the nutricline, reproduction is light-limited.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

135

9.5. Diurnal variation in a zooplankton sub-population

Fig. 11 illustrates diurnal variation in the audit trail of a zooplankton sub-population (No. 3601) in midJune.

9.5.1. Migration and satiation (Fig. 11(a))
In mid June the mixed layer is just 16 m deep and the diurnal thermocline extends up to 6 m at noon. The
copepods in this sub-population pass each night in the mixed layer. Soon after sunrise they begin to migrate downward in pursuit of the 2 W/m2 isolume. The choice of target isolume ranges between 2 W/m2 when the satiation index is zero (starving) and 1 W/m2 when it is one (replete); the 2 W/m2 isolume was selected by
the copepods in this sub-population because they had a satiation index of less than 0.001, the consequence
of poor feeding in summer. This relatively bright isolume descends half an hour later than the dimmer 1 W/m2 isolume, allowing the copepods to prolong nocturnal feeding. But they are more visible and therefore
experience a higher risk of being eaten by predators. This behavioural response to very low satiation trades
losses to cannibalism against losses to visual predators.

9.5.2. Food supply (Fig. 11(b) right) There are about 10 diatoms/ml in the mixed layer (Fig. 11(b) right). The concentration is higher in the
seasonal thermocline above 50 m. The food proﬁle does not vary smoothly with depth. It has ﬁnestructure, dominated by two thick maxima peaking at 20 and 38 m. These plumes of living diatoms sinking at 1 m/d can be traced back to earlier temporal maxima of phytoplankton biomass in the mixed layer. (The cause of this temporal variation in the oligotrophic mixed layer will be discussed later, see Fig. 18.) As the diatomrich layers sink slowly through the thermocline their biomass is modiﬁed by grazing and by reproduction, which increases after they enter the nutrient-rich water below the nutricline (Fig. 15). There is no food below 60 m, because the diatoms that are not eaten before reaching that depth soon die of energy starvation (natural mortality).

9.5.3. Foraging (Fig. 11(a) and (b)) The copepods ingest diatoms as they swim up and down through the water. In the WB model they
always swim at their maximum speed. In one half-hour time step they normally pass through several one-metre-thick layers deﬁning ﬁnestructure in food concentration. So their ingestion is computed for the fraction of the time-step spent in each layer. In Fig. 11(a) you can note steps in the ascent of the copepods. These occur just before sunset, when copepod behaviour switches from diel migration to nocturnal foraging. Safe from visual predators, they can pause to graze in the maxima of the food concentration. In this case the copepods soon continue their ascent to the mixed layer where they pass the night feeding while being tumbled by turbulence. Later in the summer the copepods sometimes spend all night in the seasonal thermocline foraging on the deep chlorophyll maxima (see Fig. 14(a)).

9.5.4. Ingestion rate (Fig. 11(c)) The zooplankton feed at a rate that depends on the ambient food concentration in each one-metre-thick
layer. The diurnal variation of ingestion rate for the copepods in sub-population 3601 is shown in Fig. 11(c). On average each copepod consumes one diatom every 10 min in the (oligotrophic) mixed layer. The ingestion rate has a double peak as the copepod migrates down through the ﬁne structure maxima in the food concentration. Feeding stops for 7 h while the copepod is below 60 m where there is no food. During that period the satiation index falls by a factor of 5. After noon, the copepod starts to swim back up. During its ascent it encounters the food maxima. We saw earlier (Fig. 11(a)) that its ascent is interrupted brieﬂy to forage in the maximum at 40 m. The ingestion rate during this period (just after dusk) peaks at nearly one diatom per minute. But it does not linger for more than one hour in the deep chlorophyll max-

136 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
imum. Then it continues upward into the mixed layer where it feeds all night. The decrease in ambient ingestion rate in successive nights is due to depletion of the food supply.
9.5.4.1. Depletion of the food supply. The proﬁle of diatom concentration is adjusted for grazing losses in each layer at the end of the time step. That adjustment is made after all the copepod sub-populations have fed at a rate determined by the food concentration proﬁle established at the end of the previous time step. There is no intra-time-step computation of the depletion by each individual sub-population. This avoids a bias in favour of the sub-populations treated ﬁrst in the computation.28
This procedure diﬀers from the Lokta–Volterra formulation in which grazing immediately aﬀects the food population for the zooplankton population as a whole. In LE modelling depletion by grazing does not involve immediate feedback from prey to predator. The feedback occurs next day when the copepod swimming down through the phytoplankton concentration proﬁle ﬁnds its ambient food supply has been reduced by the previous nightÕs grazing. That asymmetric interaction between predator and prey populations is a key feature of the LE metamodel. It contributes to the stability of the virtual ecosystem (WPB).
9.5.5. Body weight (Fig. 11(c)) The respiration rate for these copepods is equivalent to 10 diatoms per hour. They can only put on
weight if they feed faster than that. Nocturnal feeding in the mixed layer barely covers respiration. The copepods put on weight slowly during the ﬁrst night, but ingestion only just covers respiration after midnight on the second night and throughout the third night. Feeding in the seasonal thermocline is better, and most of the daily growth occurs in two spurts, morning and evening, as the copepod passes through the food maxima during diel migration. The increase in weight is less on the way down, because it occurs in daylight, when foraging is not permitted. It is more during the ascent, because the sun sets as the copepod encounters the food maximum, permitting foraging. The copepods in this sub-population are still growing slowly, but they are approaching their ﬁnal weight for this year. The growing season terminates when they can no longer ﬁnd food at any depth with a concentration suﬃcient for ingestion to exceed respiration. Thereafter, survival depends on cannibalism.
9.5.6. Losses to predators (Fig. 11(d)) Diel migration in the WB model was designed to reduces losses to carnivorous zooplankton that are visual
predators. For simplicity the latter are assumed to be distributed uniformly with depth, so the probability of a copepod being eaten varies only with its visibility, which is the product of its ambient irradiance and apparent size. Each time step the number of copepods in the sub-population is reduced according to this probability.29 There is no loss to visual predators at night. During the day, the loss is negligible if the copepods have an ambient irradiance less than 1 W/m2. That is their target isolume if they are replete (satiation index S = 1). But these copepods are hungry (S < 1) so they pursue the 2 W/m2 isolume. The time series of their ambient irradiance shows that they fail to keep up with the target isolumeÕs descent; so they remain more brightly illuminated throughout the day (3–4 W/m2). The rate of loss to visual predators is correspondingly enhanced.
9.5.6.1. Stragglers. Fig. 11(a) shows that the copepods are in the mixing layer when the sun rises in the morning. When their ambient irradiance exceeds 2 W/m2 they start to swim down. On some days, by
28 When the model is integrated on a parallel computer with each processor handling many sub-populations, the information about depletion is collected from all processors and the total depletion is used to compute the new biological environment, which is then broadcast to all processors before the next time step. Optimal parallelization depends on programming this process eﬀectively (AlBattran et al., 1998). 29 As was noted earlier, the plankton population in a sub-population does not have to be an integer, because it represents the number of copepods per square metre.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

137

Fig. 12. Seasonal variation in the audit trails of a copepod and its oﬀspring.
chance, turbulence displaces them upwards as they start to swim down, delaying their descent for one or more time steps. These stragglers are exposed to light that is much brighter than their target isolume. So the predation rate is greatest at dawn. During the 48 h shown in Fig. 11(d) the sub-population loses 22 out of 1014 copepods/m2 or about 1% per day. These losses are almost totally due to visual predators. Losses to cannibalism occur when respiration exceeds ingestion, which it does for about half of the time shown (Fig. 11(b)), but the losses are fewer than to predators.
9.6. Seasonal variation in a zooplankton sub-population
Fig. 12 illustrates the seasonal variation in a sub-population of copepods (3001) during the growing season, which ends in August. It shows reproduction and development of the oﬀ-spring. The latter are grouped into a new sub-population (3601), which is also featured in Fig. 11. Sub-populations 3001 and 3601 carry successive generations of the same lineage.
9.6.1. Depth (Fig. 12(a)) The trajectories of the mother and daughter sub-populations are sampled each day at 7 a.m. local time.
Reproduction occurs on the 27th of May. The swimming speed of the copepods depends on their weight, so initially those in the new generation migrate less deeply than those in the mother sub-population.
9.6.2. Number of copepods in the sub-population (Fig. 12(b)) Predation almost wipes out the mother sub-population before it reproduces; only eight copepods survive
to hatch the next generation. However, together they produced 1200 juveniles. During the next twenty days the number of adult copepods (in sub-population 3001) declines by senescence. The new generation have

138 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
ample food to cover respiration and put on weight rapidly. So their losses were not due to starvation, but to visual predation by carnivores.
9.6.3. Feeding rate (Fig. 12(c)) Fig. 12(c) shows the feeding rate each day at 7 a.m. local time. For the parent generation it reﬂects the
change in food concentration during the spring bloom. The demand to satisfy respiration depends on body weight; it is approximately 10 diatoms/h. That is ﬁrst exceeded in mid-April allowing the copepods to start putting on weight (Fig. 12(d)). Feeding rate varies with G2/3 and with food concentration. So it is lower for the new generation of juveniles than for their parents. It remains fairly steady as increasing body weight compensates for declining food concentration. Slow growth continues during summer oligotrophy, but it is almost ended in August.
9.6.4. Body weight (Fig. 12(d)) On 1st March, the copepods in the sub-population still have the same weight as in the previous August.
They have not eaten enough during autumn and winter to cover their carbon loss by respiration. They make up the deﬁcit by cannibalism, which contributes to the reduction in the number of copepods in the sub-population (Fig. 12(b)). However, they abandon cannibalism and start to put on weight from mid April when their daily ingestion of diatoms exceeds respiration. They become adults on the 28th of May when their weight reaches 100 lg. For the next twenty days surplus ingestion goes into making eggs, the ﬁnal number depending on how well they feed during that period of gestation. Then the eggs all hatch simultaneously. The hatchlings are allocated to a new sub-population (3601), which follows an independent trajectory (Fig. 12(a)).
The new generation starts with a birth weight of 0.2 lg. They hatch when the food supply is close to its maximum concentration (i.e. just after the peak of the spring bloom), so they put on weight fast. Their growth rate then declines as the food supply is depleted. At the end of August, they stop growing and switch to cannibalism. In this way the survivors retain their end-of-season weight until next April when the spring bloom allows them to complete their growth to maturity.
9.7. Intra-population variation
Lomnicki (1989/1999) pointed out that the demographic histories of populations are sensitive to intrapopulation variability. That is represented in VEs by the variation between sub-populations. All subpopulations of a particular species (diatoms or copepods in WB) start with the same biological state. Diﬀerences arise because they follow diﬀerent trajectories and therefore experience a diﬀerent history of ambient environment. The trajectories diﬀer because turbulence in the mixed layer displaces particles randomly. Figs. 13 and 14 illustrate inter-sub-population variation during the ﬁrst 10 days of July.
9.7.1. Phytoplankton Fig. 13 shows audit trails for seven sub-populations of diatoms. They occupy diﬀerent habitats (see Fig. 8).
Sub-population 864727 lies mainly in the mixed layer (habitat IIa,b), 876248 lies in the seasonal thermocline above the nutricline (habitat IIc), the other ﬁve lie progressively deeper in the seasonal thermocline (habitat Ic). Sub-populations 881481 and 902715 are so deep that they are close to death by energy starvation.
9.7.1.1. Trajectories (Fig. 13(a)). The mixed layer shoals from 15 to 12 m during the ﬁrst 10 days of July. Fig. 13(a) shows the diurnal variation of turbocline depth. At noon the diurnal thermocline extends up to 5 m. Sub-population 864727 lies in the mixed layer until soon after sunrise on the 9th July, when it is subducted so deep into the diurnal thermocline that it sinks irreversibly into the seasonal thermocline. On three previous days (1st, 5th and 8th July) this sub-population passes the whole day in the mixing layer. On all

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

139

Fig. 13. Variation between phytoplankton sub-populations.
other days (2nd, 3rd, 4th, 6th and 7th July) it is subducted into the diurnal thermocline during the morning but is later re-entrained into the mixing layer. The subduction depth varies randomly from day to day. The other sub-populations in Fig. 13(a) had previously been subducted into the seasonal thermocline and are now sinking through it at 1 m/d (hence the identical slopes of their trajectories.) The nutricline lies at 30 m. Sub-population 876248 lies above it, and is therefore oligotrophic (i.e. nutrient-limited, as is 864727). The other ﬁve sub-populations have already sunk below the nutricline, so they are eutrophic (i.e. their growth is light-limited).

140 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
9.7.1.2. Light adaptation (Fig. 13(b)). As we saw in Fig. 9(c) the phytoplankton adapt to their recent history of ambient irradiance. Photo-adaptation is correlated with the sub-populationÕs depth. In Fig. 13(b) it is shown that the shallowest (864727) is adapted to an irradiance twenty times greater than that of the deepest (9002715).
9.7.1.3. Reproduction (Fig. 13(c) and (d)). The diatoms in a sub-population all reproduce simultaneously when the levels of both energy and nitrogen pools exceed critical values. The two pools ﬁll at diﬀerent rates depending on the ambient light and nitrogen concentration. If one pool has less than its critical value for reproduction, the other can ﬁll beyond its critical value, stopping when the prescribed maximum is reached. A sub-population experiences light-limited growth when its energy pool exceeds the critical value after its nutrient pool; and vice versa. Primary production in the summer depends on a combination of light-limited and nutrient-limited sub-populations. After reproduction the energy and nitrogen pools fall by their critical amounts. When a light-limited diatom reproduces, its nitrogen pool has more than the minimum needed for reproduction and the surplus is shared between the two cells (conversely for nutrient-limited reproduction). After reproduction the two pools reﬁll at rates that depend on the ambient irradiance and nitrogen concentration. The respective reﬁll-times indicate light or nitrogen limitation. Fig. 13(b) and (c) show these signatures in the seven sub-populations.
The diatoms in sub-population 864727, located in the mixed layer, reproduce on the 1st, 3rd and 6th July. After reproduction it takes them a few hours of daylight to replenish their energy pools (replenishment is delayed on the 6th July when night intervenes). Their energy pools are full for most of the ten-day period. Reproduction is postponed by the much longer replenishment time for nitrogen. So the diatoms of agent 864727 are nutrient-limited during these 10 days.
The next deeper sub-population (876248) reproduces on the 4th and 7th July. It has lower ambient irradiance than 864727, so energy replenishment is slower. It takes 3 days after the ﬁrst reproduction. The replenishment time for nitrogen is only slightly longer. So on this occasion the phytoplankton in sub-population 876248 reach the energy threshold just before sunset on the 7th July, and nutrient threshold a few hours later, with the result that reproduction occurs at night. After that reproduction, nutrient replenishment is completed early on the 11th July, but energy replenishment has at least one more day to go. So the diatoms in sub-population 876248 switch from nutrient-limited reproduction on 7th July to light-limited reproduction on 11th July. This change in the balance of conditions for reproduction occurs while the sub-population is oligotrophic; it remains above the nutricline in water where ambient nitrogen comes from zooplankton fertilization.
The only other sub-population to reproduce during these 10 days is 896248. It does so on 1st July. Reproduction occurs just before sunset, allowing a brief period of energy replenishment before nightfall. It lies below the nutricline, so the nitrogen pool reﬁlls in a few hours. However, the ambient irradiance is so low at that depth that the daily energy gain by photosynthesis barely exceeds respiration, and the net energy gain gets less each day, with the result that the energy pool never reﬁlls completely. There is no prospect of a further reproduction event for this sub-population before its surviving diatoms die of energy starvation, like those in Fig. 10.
The same is true for the other four sub-populations. During the period 1–10 July, the shallowest (889676) is still gaining energy, the next deeper (860408) is in balance (daily photosynthesis balances respiration), and the remaining two (881481 and 902715) lying at the same depth, are both losing energy. All four have full nitrogen pools.
9.7.1.4. Sub-population size (Fig. 13(e)). All sub-populations were initialized with the same number of diatoms. But they have quite diﬀerent sizes by the 1st March of year 6. The set of seven sub-populations in Fig. 13(e) range from 60,000 (in 864727) to 550,000 (in 889676). The ranking of sub-population size is not correlated with that of depth or of other biological state variables. It is the result of diﬀerent life histories in the previous ﬁve years. It is also aﬀected by splitting sub-populations. For example,

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

141

864727 splits on 1st July (marked by *). Splitting ensures that the range of sub-population sizes does not become so large that it would bias the population statistics in favour of a few very large sub-populations. The largest sub-population (889676) is subducted into the seasonal thermocline in early June after growing well in the spring bloom. The two deepest sub-populations (884181 and 902715), which follow almost identical trajectories during this period, diﬀer by a factor of two in the number of diatoms. That is the legacy of the former having one more reproduction event than the latter when they were both in the mixed layer.

Fig. 14. Variation between zooplankton sub-populations.

142 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
The sub-populations all decline due to grazing (Fig. 13(e)). Those below the nutricline decline at the same rate. Those nearer the surface, which beneﬁt from reproduction events, experience more rapid losses due to grazing. The fastest loss occurs in the shallowest sub-population 864727 on the night of 8/9 July, when it encountered heavy grazing in the mixed layer. We shall see below (Fig. 18) that this was due to copepods migrating up into the mixed layer to feed; the food supply had been enhanced by primary production (Fig. 13(e)) fertilized by nitrogen left by zooplankton during their previous visit two weeks earlier. Note that the shallowest sub-population (864727) suﬀers no decline on the nights of 3/4 and 4/5 July, showing that the zooplankton were not feeding in the mixed layer on those nights. These periodic changes become clear when we examine the audit trails for copepods.
9.7.2. Zooplankton Fig. 14 reveals the diﬀerences between three sub-populations of copepods during the ﬁrst 10 days of July
in the sixth year of the Azores VE.
9.7.2.1. Trajectories (Fig. 14(a)). Although all the zooplankton obey the same rules of behaviour, they follow diﬀerent trajectories. Unlike phytoplankton, these diﬀerences between zooplankton are not just due to turbulence, but also to their diﬀerent body weights, which control swimming speed and feeding rate. Fig. 14(a) shows the trajectories of the three sub-populations. They do not graze in the mixed layer on the nights of 3/4, 4/5 and 5/6 July, choosing instead to graze in the seasonal thermocline on a layer of phytoplankton, which they encounter deeper each night. On the other nights one or more of the sub-populations graze in the mixed layer. This periodic grazing behaviour will be explained later (Fig. 18).
9.7.2.2. Swimming speed (Fig. 14(b)). The three sub-populations follow this periodic behaviour with different phasing. That arises from diﬀerences in their swimming speeds (Fig. 14(b)). The heaviest copepods (in 3601) swim fast and overshoot the ﬁnestructure maximum in the food concentration in the seasonal thermocline. The lightest copepods (in 4200) swim more slowly. They tarry in the deep chlorophyll maximum as it is becomes depleted. The heavier/faster copepods respond earlier to its depletion and pass through it to feed in the mixed layer on the night of 6/7 July. Next night they are joined by the copepods of middling weight/speed (sub-population 3701), and two nights later by the lightest (4200).
9.7.2.3. Ingestion and satiation (Fig. 14(c) and (d)). Fig. 14(c) shows the ingestion histories of the three copepod sub-populations. They feed better when passing the night in the seasonal thermocline, grazing on diatoms in the deep chlorophyll maximum. Nevertheless, food is scarce, and the satiation index is around 0.1% of optimal (Fig. 14(d)). Ingestion rate and satiation are ranked with body weight.
9.7.2.4. Body weight (Fig. 14(e)). The copepods in all three sub-populations gain weight during the ﬁrst ten days of July (Fig. 14(e)). However, the lightest (4200) grow more slowly than the others, reﬂecting their lower ingestion rate. The fact that they are putting on weight slowly shows that they have nearly attained their ﬁnal body weight for this yearÕs growing season. It is remarkable that although the copepods were all initialized with the same body weight on the 1st March ﬁve years earlier, they have since developed a spread from 2.5 to 11 lg C. This is the consequence of positive feedback amplifying small random changes caused by turbulence in the ﬁrst year. Once a ranking of body weights becomes established, it persists through the generations (WPB Fig. 8).
9.7.2.5. Number of copepods in the sub-population (Fig. 14(f)). All sub-populations are initialized with the same number of copepods. They subsequently develop diﬀerently, because the random displacements in the mixing layer make them follow diﬀerent trajectories and therefore experience diﬀerent histories of ambient environment. As the result they reproduce diﬀerently and suﬀer diﬀerent losses to predators and starvation.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

143

The ranking of sub-population size (Fig. 14(f)) does not follow the current body weight. The decline due to predation by carnivores is slower for the smallest copepods. (They are still growing so they have not yet succumbed to cannibalism.) This is a consequence of two factors. First, because they spend fewer nights in the mixed layer, they are less frequently exposed to high ambient irradiance at dawn, when turbulence delays their downward migration (see the discussion of stragglers illustrated by Fig. 11(c)). Second, the lower body weight produces a lower visibility at the same ambient irradiance; and all three sub-populations accumulate roughly the same history of ambient irradiance as they migrate along similar trajectories each day.

9.8. Biological environment

Each environmental ﬁeld is described by a set of values for layers in the mesocosm. There are environmental ﬁelds for physical, chemical and biological variables. The biological variables include the mean values of the biochemical state of the plankton in each species, its biomass and demographic rates in each layer. These proﬁles are calculated at each time step from the properties of the sub-populations that happen to be in, or passing through, each layer. The proﬁles of diatom and copepod numbers per cubic metre are emergent properties of the simulation. Each has a sampling error. The signal-to-noise ratio increases with the number of agents (sub-populations) per layer.
Figs. 15 and 16 show the annual cycle in biological environment for the phytoplankton and zooplankton respectively. They do so in terms of the following variables: (a) phytoplankton biomass, (b) primary production, (c) natural mortality rate, (d) grazing rate, (e) zooplankton biomass, (f) detritus (dead plankton), and (g) fæcal pellets. The plots show the biological response to the physical and chemical environment illustrated in Fig. 7.
The emergent phytoplankton and zooplankton biomasses are consistent with published climatologies near the Azores (Longhurst, 1998), after mapping them onto the diatom and copepod speciﬁcations used in the WB model. The realism of those ecological properties implies that two key ecological processes are modelled realistically. The ﬁrst is remineralization, which controls regenerated primary production. The second is grazing eﬃciency, which determines the ratio of secondary to primary production.
The prey concentration used in computing predation by zooplankton is part of the biological environment. The biological environment is also used to compute bio-optical feedback to the environment. Biochemical feedback in each layer is based on the dissolved inorganic nitrogen and carbon consumed by the phytoplankton sub-populations, or released by the zooplankton sub-populations, or remineralized by the microbial action in dead plankton and fæcal pellets.

9.9. Phytoplankton demography

9.9.1. Concentration of diatoms Fig. 15(a) Fig. 15(a) shows the concentration of diatoms every day of the year at local midnight. The upper curves
show the concentration (diatoms/m3) in the mixed layer (at a depth of 10 m) and in the seasonal thermocline (at 30 m). The spring bloom is marked by a monotonic rise to a maximum of six diatoms per ml in mid-May, followed by a matching decline ending one month later. In summer the phytoplankton in the mixed layer exhibit a periodicity consistent with the oligotrophic cycle of fertilization–growth–grazing described in Fig. 18. At 30 m the spring bloom reaches nearly 3 diatom/ml, before plateauing as the plankton are subducted into the thermocline. The oligotrophic cycle has a larger amplitude at 30 m than in the mixed layer, starting with a peak of 5 diatom/ml. The autumn bloom is not perceptible in these time series. This suggests it is grazed down as fast as it is generated.
The lower panel of Fig. 15(a) shows the changing vertical distribution of phytoplankton biomass, on a logarithmic scale. The corresponding linear plot can be found in Fig. 7(c). The lower limit (at 1000 diatoms/ m3) provides a rough indication of the depth at which the last plankton sub-populations die of energy

144 J.D. Woods / Progress in Oceanography 67 (2005) 84–159 Fig. 15. Phytoplankton demography as a function of depth and day of the year.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

145

Fig. 15b. Diurnal variation of primary production (diatoms/ml per half-hour) in spring and summer.
starvation (see also Fig. 15(c)). This occurs at about 100 m in the summer, but at 45 m at the end of May, when self-shading reduces photosynthesis (see Fig. 7(c)).
The distribution of phytoplankton in the seasonal thermocline is marked by a succession of plumes originating in temporal maxima in the mixed layer during the spring bloom and the oligotrophic cycle. The slope of these plumes is 1 m/d, the sinking speed of the diatoms. Phytoplankton sinking out of the spring bloom all die before the end of August. Once a diatom has sunk into the seasonal thermocline it can make no direct contribution to the plankton population next year. However late it is subducted, it is fated to die in the thermocline; it sinks too fast to be overtaken and re-entrained into the mixed layer as the latter deepens in autumn. Of course, subducted diatoms do make an indirect contribution to next yearÕs growth by nourishing zooplankton which transport their nitrogen back up to the mixed layer, where it fertilizes primary production. That process sustains the tiny population of phytoplankton that do not leave the mixed layer. They seed the spring bloom next year.
9.9.2. Primary production (Figs. 15 and 15b) The diurnal variation of primary production is shown in Fig. 15(b). Light-limited production can occur
only during the hours of daylight; it peaks at 3 p.m. (in April and below the nutricline in July). Nutrientlimited production can occur at any time of day and night (above the nutricline in July).
Fig. 15(c) shows the annual variation in primary production sampled at 3 p.m. each day. It is noisier than Fig. 15(a) because reproduction occurs as infrequent events in sub-populations. Primary production in the mixed layer is light-limited until the 5th of May when the dissolved nitrogen has all been consumed. It is limited to the upper part of the mixed layer from mid-April to mid-May. This is easily understood in terms of audit trails (Fig. 10); sub-populations subducted into the diurnal thermocline below the compensation depth cannot acquire suﬃcient energy to reproduce. The high turbidity during the spring bloom raises the compensation depth into the mixed layer (Fig. 7(a) and (c)).
Primary production in the mixed layer drops sharply to zero after nitrogen runs out on the 4th May. The hiatus in mixed layer primary production lasts for 10 days. It ends when ammonia provided by zooplankton fertilizes oligotrophic (nutrient-limited) growth. Production continues in the mixed layer at a low level. It is stronger just below the nutricline (at 35 m), where primary production is light-limited. Once grazing has reduced turbidity, allowing the sunlight to reach the nutricline, growth there depends on the ﬂux of diatoms arriving from above. That ﬂux occurs in plumes. The ﬁrst comes from the spring bloom. Subsequent plumes come at intervals of about three weeks from the oligotrophic cycle fertilized by migrating zooplankton. The enhanced rate of cell division below the nutricline is clearly visible in the lower panel of Fig. 15(c).
9.9.2.1. Autumn bloom. Also visible in Fig. 15(c) is the autumn bloom in the mixed layer. It occurs when the deepening mixed layer reaches the nutricline. As we saw in Fig. 7(e) and (f), nutrient-rich water is then

146 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
entrained into the mixed layer and DIN rises rapidly in the well-lit surface waters, fertilizing light-limited production for the next month. (Remember that diatoms cannot be entrained into the mixed layer to seed the autumn bloom.) The autumn bloom ends when the deepening mixed layer descends below the compensation depth. At that time of year there is no diurnal thermocline to sustain primary production by daytime laminar ﬂow.
9.9.2.2. Primary production in winter. Primary production declines to a minimum at the end of December. It recovers in January as the diurnal thermocline is re-established. That allows an increasing fraction of the diatom population to remain above the compensation depth for several days until their energy pools are full. Fig. 15(c) shows an increase in production above the noon depth of the turbocline during January, February and March. Below that depth primary production remains low until the mixed layer becomes shallower than the compensation depth at the beginning of April. That marks the start of the spring bloom, according to the classical model of Sverdrup (1953). However, in this VE the growing season (deﬁned by increasing phytoplankton biomass in the mesocosm) began three months earlier (WPB Fig. 11).
9.9.3. Natural mortality (Fig. 15(d)) Fig. 15(d) shows the vertical distribution of natural mortality due to energy starvation in the Azores VE,
sampled at 7 a.m. each day. We saw earlier that when starvation occurs it simultaneously kills all the diatoms in a sub-population. So Fig. 15(d) is based on the number of diatoms in sub-populations that reach the end of their lives. The result is rather noisy, because this VE has relatively few sub-populations. Despite that noise, the distribution of natural mortality at a depth of 90 m shows the losses in the deep mixed layer during winter. The hiatus in spring is due to self-shading which causes energy starvation to occur around 40m. The resumption in late summer marks the arrival of phytoplankton that have sunk through the deep chlorophyll maximum. The late autumn hiatus in natural mortality at 90 m was caused by two factors: (1) astronomical variation in solar elevation, and (2) the autumn bloom, which increases turbidity. Together they raise the compensation isolume killing diatoms by energy starvation at around 80 m.
The lower panel of Fig. 15(d) sets the time series for 90 m into context. It also shows the absence of natural mortality in the oligotrophic habitats (IIa,b,c) where the light is suﬃcient to power photosynthesis at a rate that exceeds respiration. Finally it reveals an extensive layer of ‘‘infant mortality’’ (A), which occurs in diatoms that reproduce late in the afternoon so that photosynthesis during the remaining hours of daylight cannot reﬁll the depleted energy pool suﬃciently to cover respiration during the next night. Infant mortality can be eliminated by setting the energy reserve parameter, e > 12 lJ. Many of the diatoms produced in A died by energy starvation in their ﬁrst night because e = 0 in this version of the WB model.
9.9.4. Grazing (Fig. 15(e)) Fig. 15(e) shows the annual cycle of grazing rate at midnight. It ﬁrst becomes signiﬁcant in the mixed
layer during April. The time series at 10 m shows the rise in grazing as the food supply increases. During this period ingestion per copepod increases fast enough to compensate for the decline in the number of copepods. However that balance changes during the ﬁrst week of May, when oligotrophy stops primary production. The food concentration and the number of copepods then both decrease causing a sharp decline in grazing rate. That is reversed when the surviving copepods reproduce, increasing the number of zooplankton grazing on what is now an oligotrophic phytoplankton population. The upper curve in Fig. 15(d) shows the variation of grazing in the seasonal thermocline at a depth of 30 m. The monthly-mean grazing on the deep chlorophyll maximum exceeds that in the mixed layer during summer. Monthly mean grazing rate in the oligotrophic cycle declines monotonically.
The lower panel of Fig. 15(e) shows the oligotrophic cycle, in which the zooplankton switch nocturnal grazing between the mixed layer and the seasonal thermocline with a three-week period (Fig. 16). We see how grazing in the seasonal thermocline follows the plumes of phytoplanklton sinking at 1 m/d from their

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

147

Fig. 16. Annual cycle of zooplankton biomass at (a) midnight and (b) noon.
source in the mixed layer. That source is fertilized periodically by nitrogen transported up by migrating zooplankton (Fig. 18). The last plume originates in the autumn bloom. In mid November the zooplankton switch to feeding on that plume of phytoplankton in the seasonal thermocline. That switch produces a corresponding reduction in grazing in the mixed layer. So the mechanism that creates the oligotrophic cycle in the summer persists in the autumn bloom when the primary production in the mixed layer no longer depends on fertilization by zooplankton. Turning back to Fig. 15(c) we see a corresponding modulation of primary production rate during the autumn bloom.
9.10. Zooplankton demography
9.10.1. Zooplankton biomass at midnight (Fig. 16(a)) Fig. 16(a) shows the annual variation in the distribution of zooplankton at midnight. The two curves in
the upper panel show the variation in the mixed layer from two perspectives: the biomass and the number of copepods in the mixed layer. The biomass is dominated in spring by the greater weight of the adults

148 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
compared with the hatchlings of the next generation (2000:1). The number is dominated by the number of juveniles per breeding adult (>100). The changing vertical distribution of biomass shown in the lower panel supports the interpretation of the grazing rate (Fig. 15(e)).
9.10.2. Zooplankton biomass at noon (Fig. 16(b)) The diel migration of the zooplankton is illustrated by their distribution at noon (Fig. 16(b)). In March
they migrate down through the diurnal thermocline to congregate in a layer between 100 and 120 m. When the turbidity of the spring bloom has raised their target isolume (Fig. 7(c)) the zooplankton pass the day in the mixed layer, where they can feed throughout the daylight hours with minimal risk of being seen by visual predators. At this time of year (May) the zooplankton are split into two parts, one in the mixed layer and the other in the seasonal thermocline, centred at 40 m. The latter concentration is an unrealistic artifact of the migration routine in the WB model, which has been corrected in later versions. It arises from the rule that requires copepods to migrate at their maximum swimming speed (see Fig. 11(b)). That leads the fast swimming copepods to overshoot their target isolume. During the day they swim rapidly up and down through the target isolume, just as they hunt up and down through a maximum in the food concentration during nocturnal foraging. This illustrates the way that studying emergent properties reveals shortcomings of the model used to create it.
During summer the zooplankton concentrate at their target isolume around 90 m. (The upper curve shows a time series for zooplankton biomass at noon at 90 m.) The oligotrophic cycle produces periodic extensions above the main concentration. These are populated by copepods with lower body weights, which do not swim so fast, and fail to reach their target isolume by noon; see Fig. 14(a).
When the diurnal thermocline disappears in autumn the zooplankton distribution extends through the mixed layer, apart from the top 5 m, which is evacuated by their swimming down. Remember that in each time step the model ﬁrst computes the random displacement by turbulence, and then the migration by swimming. So those copepods which turbulence transports to within 5 m of the surface at noon migrate down from it before their distribution is sampled for this plot. The thickness of the empty surface layer equals the distance that the smallest copepods can swim in half an hour.
The same rule allows copepods to migrate out of the mixed layer into the seasonal thermocline. Such emigration is permitted for those copepods that turbulence transports to a depth from which they can swim through the base of the mixed layer. The copepods that escape from the mixed layer are then free to pursue their target isolume undisturbed by turbulence. The high concentration at noon around 75 m in November shows that many copepods reach the safety of darkness.
9.10.2.1. Stragglers. However, above that maximum there is a tail extending up to the mixed layer. This tail is populated by stragglers that escaped the mixed layer too late to catch up with their target isolume as it descended during the forenoon. The copepods eaten by visual predators are mostly stragglers whose ambient irradiance signiﬁcantly exceeds their target isolume (see Fig. 11(c)).
9.10.2.2. Winter. The depth of the target isolume is modulated by the astronomical cycle of solar elevation, so the zooplankton do not have to migrate so deep at the winter solstice (Fig. 7(c)). Its depth also depends on the turbidity, which rises in the autumn bloom, and is cleared only slowly by grazing. These two factors (astronomy and turbidity) make the target isolume descend more slowly than the base of the mixed layer, with the result that from mid-January it lies inside the mixed layer. Moreover, the diurnal thermocline becomes re-established at the end of December. So at noon the ﬂow is laminar in this lower portion of the mixed layer. Zooplankton that migrate below the turbocline can then swim down to their target isolume. The result is a high concentration of zooplankton at noon in a band inside the mixed layer. This band slowly descends until mid-March as the turbidity decreases.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

149

Fig. 17. Annual cycle of (a) dead plankton and (b) fæcal pellets.
9.11. Detritus
9.11.1. Dead plankton When a phytoplankton sub-population dies it is reclassiﬁed as a detritus particle which contains all the
carbon and nitrogen of the dead diatoms. This particle sinks through the water at 1 m/d. While in the surface mixing layer z < h(d, t), it is also displaced randomly by turbulence. Bacteria attached to the particle extract its carbon and nitrogen at a rate proportional to their masses, releasing them into the seawater as DIC and DIN. The carbon:nitrogen ratio is constant at all times in the detritus particles. Once detritus particles have sunk into the laminar ﬂow regime of the seasonal thermocline, they are combined into one large particle per layer to reduce computation.
Fig. 17(a) shows the annual variation of the proﬁles of particulate nitrogen in detritus particles. Although the source of detritus (natural mortality) varies with depth in the mixed layer (Fig. 15(d)), turbulence quickly homogenizes the distribution of detritus particles. The residual inhomogeneities are due to the relatively small concentration of (living) phytoplankton, and the small fraction dying each day by energy starvation. The upper curve in Fig. 11(a) shows the annual variation at a depth of 10 m, which lies in the turbulent mixing layer z < hmin(d) during all seasons. The time series has two broad maxima during the spring and autumn blooms. Comparing the phase of these peaks with those of Fig. 15(a) and (c), we observe that the detritus peak leads that of the phytoplankton biomass by a few days. This emergent property reﬂects the changing budgets of the respective sources (mortality; reproduction) and sinks (grazing, energy starvation and emigration; remineralization and emigration). Infant mortality links

150 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
reproduction and natural mortality (see discussion of Fig. 9(c)). The incidence is lower in the oligotrophic habitats (IIa,b,c) where reproduction is nutrient-limited and, therefore, occurs at any time of day. It occurs in late afternoon in the eutrophic habitats (Fig. 15b). The source of detritus is low in oligotrophic habitats. But the fall-out from early summer mortality accompanies the plumes of living diatoms from the oligotrophic cycle. Reproduction increases sharply when these plumes pass through the nutricline. It is light-limited, occuring in late afternoon; so infant mortality resumes, giving the plumes of enhanced particulate nitrogen seen in habitat Ic. These plumes sink too fast to be overtaken by the mixed layer as it deepens in autumn and winter. Note the reduction of detritus fall-out from the autumn bloom.
9.11.1.1. The carbon pump. The particles created by natural mortality at z < 100 m take more than four months to reach the permanent thermocline at Hmax = 230 m. Before reaching that depth the particles have lost most of their nitrogen and carbon to seawater as DIN and DIC. The remaining particulate nitrogen and carbon sinks out from the seasonal boundary layer. The carbon is replaced automatically by inﬂowing carbon dioxide. The lost nitrogen is replaced artiﬁcially in the balanced Azores VE by winter injection of DN = 0.1 mmol N/m3 y in the mixed layer. In the WB model detritus does not aggregate into larger particles that sink faster to the ocean ﬂoor. The enhanced concentration of detritus in the mixed layer during the autumn bloom reminds us that primary production is light-limited and therefore has a higher incidence of infant mortality in that habitat.
9.11.2. Fæcal pellets Particulate carbon/nitrogen also occurs in fæcal pellets egested by copepods and by the carnivores that
eat them. Once formed, fæcal pellets are simulated in the same way as dead plankton. They are combined into large particles that sink at the same speed as individual pellets (1 m/d). Bacteria extract carbon and nitrogen from these particles, releasing them to seawater as DIC and DIN.
Fig. 17(b) shows the annual variation in the proﬁle of particulate nitrogen originating as fæcal pellets. The distribution diﬀers signiﬁcantly from that of detritus (Fig. 17(a)). Fæcal pellets originate where zooplankton graze or are eaten (Fig. 16(d)); detritus where phytoplankton die of starvation (Fig. 15(c)). Remember that in this version of the WB model, the copepodÕs gut passage time was zero; at the end of each time step they egest a fraction of the carbon/nitrogen ingested during that time step. Adult copepods swim about 5 m in one half-hour time step (Fig. 14(b)), so ingestion during migration through ﬁve layers produces a fæcal pellet in the last one. This means that egestion is displaced at most 3 m from the centre of ingestion; that displacement is not signiﬁcant for the present discussion.
The most notable feature of Fig. 17(b) is the fact that the fall-out of particulate nitrogen persists through the period of summer oligotrophy. This is a result of primary production being sustained in the oligotrophic habitats (IIa,b,c) by zooplankton fertilization. The copepod pellets come from grazing on regenerated growth in these habitats. Carnivore pellets come from copepods that are eaten there, stragglers whose diel migration was fatally delayed by turbulence.
9.12. Uncertainty
In the LE method, the demographic time series for each plankton population (number, birth rate and death rate for each cause of death) are emergent properties of the simulation computed by summing over all sub-populations every time step. This is the demography of one instance of the VE. Investigations by Al-Battran et al. (1998) and Hurt (2001) have shown that there is signiﬁcant variability between the demographies of diﬀerent instances of the same VE. The best description of the demography is provided by creating an ensemble of, say, 16 instances, and averaging the 16 values for each time step to produce

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

151

Fig. 18. Periodicity in primary production, grazing and fertilization in the oligotrophic habitats due to upward transport of nitrogen by migrating zooplankton: (a) ammonia concentration (contours of Log10[mmol N/m3]); (b) phytoplankton biomass (contours of Log10[diatoms/m2]); (c) zooplankton numbers (contours of Log10[copepods/m2]); (d) grazing rate (contours of Log10[diatoms/m2 per half-hour]).
an ensemble mean demography for the VE. WPB (Fig. 13) plot the ensemble mean and inter-instance standard deviation for each day of the year. I give the name demographic noise to the inter-instance variation of demographic variables. The signal:noise ratio of about 10 (WPB) is suﬃcient to describe the annual cycle.
9.12.1. Demographic noise Demographic noise originates in the turbulent displacement of plankton particles. Its magnitude de-
pends on the number of particles used in the simulation. Even if it were possible to use one particle per plankter in a water column of one square kilometre cross-section area, the demographic noise would not be zero, but it would be smaller than in the present simulations. The number of agents (sub-populations) per layer ranges seasonally from 109 to 1012. The demographic noise declines as more parti-

152 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
cles are included in the VE. Computer power limits the number of agents to about one million per processor.
9.13. Fertilization of the oligotrophic habitats
Figs. 14 and 16 exhibited a periodicity in which zooplankton switch their behav-iour to graze and fertilize phytoplankton alternately in the oligotrophic mixed layer (habitats IIa,b) and seasonal thermocline (Ic and IIc) with a period of about three weeks. Fig. 18 illustrates this periodic behaviour in more detail.
9.13.1. Decline of the phytoplankton Primary production in the deep chlorophyll maximum, where both light and nitrogen are available, de-
pends on the downward ﬂux of energy-rich/nitrogen-starved diatoms from the oligotrophic habitat above. If there were no primary production in habitats IIa,b,c they would soon become depleted by emigration. One of the emergent properties of the Azores VE is the persistence of a small but important population of phytoplankton in these oligotrophic habitats, sustained by the injection of nitrogen from migrating copepods. This involves an upward transport of nitrogen from the eutrophic habitat (Ic) below the nutricline, where the zooplankton ﬁnd more abundant food.
9.13.2. The biological transport mechanism The copepods ingest nitrogen while grazing in the deep chlorophyll maximum. They then migrate up into
the oligotrophic habitat where they release nitrogen to the seawater in three ways.
(1) In the WB model, excretion and egestion occur in the layer in which the copepod sub-population is located at the end of the half-hour time step. As it migrates a copepod grazes on the phytoplankton in each layer it passes through during one time step. So it eats in several layers and releases some of the ingested nitrogen into the last layer. The rest of the ingested nitrogen is stored in the copepodÕs body.
(2) There can be a delay between ingestion, on the one hand, and excretion and egestion, on the other. This is known as the gut passage time, which can be an hour or more for calanoid copepods depending on species (Mauchline, 1998). Gut passage time was zero in the version of the WB model used to create the Azores VE. Arrese (2002) showed that adding gut passage time to the WB model signiﬁcantly increased oligotrophic production.
(3) There is a risk that the copepod will be eaten by a predator during the daylight hours. When that happens the predator releases the ingested nitrogen in two ways: (1) by excretion as DIN, and (2) by egestion in a fæcal pellet. Copepods migrating to their death in the mixed layer make the main contribution to biotransport of nitrogen in this case study.
Whether egested by a copepod or by a predator, fæcal pellets sink through the water at 1 m/d. Bacteria extract nitrogen from them as they sink, releasing it as ammonia. The pellets are tracked explicitly in the VPE during this remineralization process.
Upward biological transport of nitrogen fertilizes primary production in the oligotrophic habitats during summer, sustaining a diatom population against losses by grazing and emigration. The phytoplankton population in the mixed layer still declines during the summer, but more slowly than it would without fertilization. Arrese (2002) has revealed another emergent property of this fertilization process. The mixed layer phytoplankton fertilized by migrating zooplankton increase the turbidity of the water suﬃciently to modify the physical environment. He showed that the maximum temperature in summer

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

153

and the timing of the autumn deepening of the mixed layer are sensitive to the value of the gut passage time.

9.13.3. Periodicity in the fertilization process The zooplankton responsible for this upward transport of nitrogen adjust their pattern of diel migration
in response to the proﬁle of food concentration. The result is a circa three-week cycle in which the copepods feed alternately in the mixed layer and in the seasonal thermocline. While grazing in one habitat the zooplankton do two things: they deplete the phytoplankton; and they release DIN (directly or indirectly). When the phytoplankton have been grazed below the threshold concentration for grazing in one habitat, the zooplankton switch to feeding in the other. That permits regrowth in the fallow (ungrazed) habitat, fertilized by DIN injected during grazing. The model contains no equation for such behaviour; it is an emergent property of the VE. It arises from the equations/rules for ﬁve processes: (1) diel migration, (2) ingestion, (3) foraging, (4) depletion of phytoplankton by grazing, and (5) fertilization. The three-week period is governed by the time diatoms in the mixed layer take to migrate down (by sinking at 1 m/d) to the nutricline where they seed the deep chlorophyll maximum, the main food supply for the zooplankton during summer oligotrophy.

9.13.3.1. Signiﬁcance for sustainability. Transporting nitrogen up into the well-lit oligotrophic habitats increases annual (regenerated) production. Some of the diatoms sink from the mixed layer to the nutricline where they seed the deep chlorophyll maximum. The enhanced food supply helps prevent zooplankton extinction.

9.13.3.2. Observations. The oligotrophic fertilization mechanism has not yet been observed in the sea. If it exists, the signal will tend to be masked by space–time patchiness due to mesoscale turbulence. So experimental veriﬁcation is diﬃcult. However, the point of this study is not to make a case for the existence of a new phenomenon in biological oceanography: it is to demonstrate how careful diagnosis of the emergent properties of a virtual ecosystem can lead to explanations of puzzling ecological phenomena.

10. Conclusion
‘‘The current method of choice for simulating physiologically structured populations in advective environments is the Lagrangian Ensemble.’’ (Gurney et al., 2001)
LE modelling uses agent-based computation. The agents represent individual plankters whose growth and behaviour are governed by phenotypic equations. Each agent also carries information about a dynamic sub-population of identical plankters. The demography of each population is an emergent property computed from its sub-populations. So, too, is the biofeedback to the physical and chemical environment.
The Lagrangian Ensemble metamodel provides a secure basis for simulating the plankton ecosystem. This paper described a one-dimensional implementation of LE modelling. It describes the ecosystem in a virtual mesocosm, which may either be moored at a ﬁxed site, or drift with the ocean circulation.
The science of LE modelling is called virtual ecology. It explains observable ecological phenomena in terms of ﬁnescale emergent properties that cannot be observed, but which are themselves directly controlled by the basic laws of nature expressed through primitive equations. The most powerful diagnostic tool is the audit trail, which describes the life history of individual plankters and their ambient environment.

154 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
This paper provided the ﬁrst comprehensive documentation of LE modelling. It showed the power of the method. It used a virtual ecosystem based on a simple NPZD model, and a scenario for the nutrients and atmospheric climate at a site near the Azores. The ecological properties of this virtual ecosystem were explained in terms of audit trails and demography. The stability of this virtual ecosystem is analysed in the accompanying paper by Woods, Perilli, and Barkmann (2005).

Acknowledgements
The techniques of Virtual Plankton Ecology summarized in this appendix have been developed by members of the research group directed by the author. I take this opportunity to acknowledge the contributions of members of the group, past and present: Wolfgang Barkmann, Alan Brice, Tony Field, Wes Hinsley, Matteo Sinerchia, Reiner Onken, Lucas Partridge, Adrian Rogers, Sarah Talbot, Roger Wiley and Uli Wolf.

Appendix. The Virtual Ecology Workbench (VEW)

The VEW is a software tool designed to automate LE metamodelling. It is written in Java. It automatically compiles the speciﬁcation of a VE to create run-time code for any computer (MacOS/Linux/Windows) with Java 4.1.2 or higher. The user needs no knowledge of computer programming. The required skill level is similar to that required to run MS Excel.
We are currently using version 3 of the VEW. The software engine for this VEW3 is provided by Planktonica (Hinsley, 2005), which manages the LE metamodel functions ‘‘behind the curtain’’ and provides the equation builder for VEW Model designer. VEW Controller (Rogers, 2005) adds model parameters (for species), provides access to VEW Scenario designer, and job control. Here is a short description of the principal components of the VEW.

VEW Controller VEW Model designer
VEW Scenario designer VEW Data
VEW Documenter VEW Archive VEW Analyser
VEW Lifespan VEW4

provides the master GUI which guides the user through the ﬁfty steps needed to specify a numerical experiment, which may comprise one VE or a batch or ensemble of related VEs. is used to specify the plankton community in terms functional groups and their species. It contains a LE-compliant equation composer for entering each biological function in plain language, and a parameter editor for specifying species. is used to specify the scenario for the track of the mesocosm as it drifts with the ocean circulation, the initial conditions, boundary conditions and events; also the exogenous demography of the top predators. provides maps of the global data used to create the scenario. The VEW contains the following global data sets as defaults: ERA40, OCCAM velocity ﬁeld, NOAA World Ocean Atlas nutrients and hydrology. automatically creates a LaTex ﬁle that documents a Virtual Ecosystem, and exports it in pdf format for publication. stores the speciﬁcations of previously created virtual ecosystems. Each module of a speciﬁcation can be imported into VEW Designer when building new VEs. imports virtual ecosystems from VEW Archive. It is used to plot emergent properties, including both ﬁelds and audit trails. The plots can be exported to Adobe Illustrator. The plotted data can be exported to MS Excel for more elaborate analysis. is used to compute the emergent demographies of plankton populations from the chronological (‘‘Parish’’) register of demographic events in sub-populations. A commercial version of the VEW for release in 2006.

Applications Beta testing
Fisheries recruitment BATS simulation Natural selection

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

155

A number of institutes are collaborating in beta testing VEW3. Each partner chooses a scientiﬁc problem that interests them. This is formulated in a way that permits solution by Virtual Ecology. VEW3 is then used to build the model equations and scenario, and then to create virtual ecosystems. The aim of beta testing is to stretch the VEW by performing real scientiﬁc applications. If necessary it is enhanced by adding new functions. Training and technical support is provided by Imperial College London. Institutes interested in becoming beta testers are invited to contact the author: j.woods@imperial.ac.uk. VEW3 is being used at Imperial College London to create a new biological model for testing theories of ﬁsheries recruitment. This required enhancement to permit staged growth in the plankton. VEW3 is being used at CNR Italy to simulate the plankton ecosystem oﬀ Bermuda, as sampled by BATS. This involved development of protocols that allowed a Virtual Ecosystem to adjust to a Geographically Lagrangian Attractor before it passes through the BATS site. VEW3 is being used at Imperial College London to investigate neutral competition among varieties of a diatom species. This involves integrations for hundred of years in half-hour time steps.

References
Baretta, J. W., Ebanhoh, W., & Ruardij, P. (1997). The European Regional Seas Ecosystem Model (ERSEM) II. Journal of Sea Research, 38(3/4), 229–483.
Baumgartner, A., & Reichel, E. (1975). The world water balance. Amsterdam: Elsevier. Beddington, J. R., Cushing, D. H., May, R. M., & Steele, J. (Eds.). (1994). Generalizing across marine and terrestrial ecology.
Philosophical Transactions of the Royal Society, 343(1303), 1–111. Broekhuizen, N. (1999). Simulating motile algae using a mixed eulerian–lagrangian approach: Does motility promote dinoﬂagellate
persistence or co-existence with diatoms? Journal of Plankton Research, 21, 1191–1216. Carlotti, F., & Nival, P. (1992). Model of copepod growth and development: Moulting and mortality in relation to physiological
processes during an individual moult cycle. Marine Ecology Progress Series, 84, 219–233. Carlotti, F., Giske, J., et al. (2000). Modelling zooplankton dynamics. In R. Harris, P. Wiebe, J. Lenz, H. R. Skjoldal, & M. Huntley
(Eds.), ICES Zooplankton Methodology Manual (pp. 571–667 of 684). London: Academic Press. Carpenter, S. R., & Kitchell, J. F. (Eds.). (1993). The trophic cascade in lakes. Cambridge: Cambridge University Press. Cushing, D. (1995). Population production and regulation in the sea: A ﬁsheries perspective. Cambridge: Cambridge University Press,
354 pp. Denman, K. L., & Marra, J. (1986). Modelling the time dependent adaptation of phytoplankton to ﬂuctuating light. In J. C. J. Nihoul
(Ed.), Marine interfaces: Ecohydrodynamics (pp. 341–359). Amsterdam: Elsevier. Droop, M. R. (1968). Vitamin B12 and marine ecology: IV. The kinetics of uptake, growth and inhibition in Monochrysis lutheri.
Journal of the Marine Biological Association of the UK, 48, 689–733. Edwards, A. M., & Brindley, J. (1996). Oscillatory Behavior in a 3-component plankton population mode. Dynamics and Stability of
Systems, 11, 349–372. Edwards, A., & Brindley, J. (1999). Zooplankton mortality and the dynamical behaviour of plankton population models. Bull. Math.
Biol., 61, 303–341. Eppley, R. W. (1989). New production: History, methods, problems. In W. H. Berger, V. S. Smetacek, & G. Fefer (Eds.), Productivity
of the Ocean: Present and past (pp. 85–98). Chichester: Wiley–Interscience. Evans, G. T., & Fasham, M. J. R. (Eds.). (1993). Towards a model of biogeochemical processes. NATO ASI series. Berlin: Springer
Verlag.

156 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
Fasham, M. J. R., Sarmiento, J. L., Slater, R. D., Ducklow, H. W., & Williams, R. (1993). Ecosystem behaviour at Bermuda station ‘‘S’’ and ocean weather station ‘‘India’’: A general circulation model and observational analysis. Global Biogeochemical Cycles, 7(2), 379–415.
Fiksen, Ø., & Carlotti, F. (1998). A model of optimal life history and diel vertical migration in Calanus ﬁnmarchicus. Sarsia, 83, 129–147.
Garnier, E., Barnier, B., Siefridt, L., & Beranger, K. (2000). Investigating the 15 years air–sea ﬂux climatology from the ECMWF reanalysis project as a surface boundary condition for ocean models. International Journal of Climatology, 20(14), 1653–1673.
Geider, R. J., MacIntyre, H. L., & Kana, T. M. (1998). A dynamical regulatory model of phytoplankton acclimation to light, nutrients and temperature. Limnology and Oceanography, 43, 679–694.
Gurney, W. S. C., Speirs, D. C., Wood, S. N., Clarke, E. D., & Heath, M. D. (2001). Simulating spatially and physiologically structured populations. Journal of Animal Ecology, 70(6), 881–894.
Isemer, H. J., & Hasse, L. (1987). The Bunker Climate Atlas of the North Atlantic Ocean. Berlin: Springer Verlag. Jassby, A. D., & Platt, T. R. (1976). Mathematical formulation of the relationship between photosynthesis and light for
phytoplankton. Limnology and Oceanography, 21, 540–547. Johnson, S. (2001). Emergence. London: Allen Lane, 288 pp. Lande, R., & Lewis, M. R. (1989). Models of photoadaptation and photosynthesis by algal cells in a turbulent mixed layer. Deep-Sea
Research, 8, 1161–1175. Levitus, S. (1998). World Ocean Atlas 1998. NOAA, Washington, DC: Government Printing Oﬃce. Lewis, M. R., Horne, E. P. W., Cullen, J. J., Oakey, N. S., & Platt, T. (1984). Turbulent motions may control photosynthesis in the
upper ocean. Nature, 311, 49–50. Liu, C.-C., Woods, J. D., & Mobley, C. D. (1999). Optical model for use in oceanic ecosystem models. Applied Optics, 38(21),
4475–4484. Liu, C.-C., Carder, K. L., et al. (2002). Fast and accurate model of underwater scalar irradiance. Applied Optics, 41(24), 4962–4974. Liu, C.-C., & Woods, J. (1998). Assessment of underwater irradiance models using BOFS data. In Proceedings of the International
Ocean Optics Conference, Hawaii. Lomnicki, A. (1988). Population ecology of individuals. Princeton, NJ: Princeton University Press. Lomnicki, A. (1999). Individual-based models and the individual-based approach to population ecology. Ecological Modelling, 115(2–
3), 191–198. Longhurst, A. (1998). Ecological geography of the sea. London: Academic Press. Mangel, M., & Clark, C. W. (1988). Dynamic modeling in behavioural ecology. Princeton, NJ: Princeton University Press, 295 pp. Martin, A. P., Richards, K. J., & Fasham, M. J. R. (2001). Phytoplankton production and community structure in an unstable frontal
region. Journal of Marine Systems, 28, 65–89. Mauchline, J. (1998). The biology of calanoid copepods. London: Academic Press, 710 pp. May, R. (Ed.). (1981). Theoretical ecology. Oxford: Blackwell. May, R. M. (1973). Stability and complexity in model ecosystems. Princeton, NJ: Princeton University Press, 265 pp. Miller, C., Lynch, D. R., Carlotti, F., Gentleman, W., & Lewis, C. V. W. (1998). Coupling of an individual-based population dynamic
model of Calanus ﬁnmarchicus to a circulation model for the Georges Bank region. Fisheries Oceanography, 7, 219–234. Morel, A. (1988). Optical modelling of the upper ocean in relation to its biogenous matter content (case 1 water). Journal of
Geophysical Research, 93(c9), 10749. Pinardi, N., & Woods, J. D. (Eds.). (2002). Ocean forecasting. Berlin: Springer Verlag, 472 pp. Popova, E. E., Fasham, M. J. R., Osipov, A. V., & Ryabchenko, V. A. (1997). Chaotic behaviour of an ocean ecosystem model under
seasonal external forcing. Journal of Plankton Research, 19(10), 1495–1515. Richardson, L. F. (1922). Weather prediction by numerical process. Cambridge: Cambridge University Press. Reynolds, C. S. (2001). Emergence in pelagic communities. Scientia Marina, 65(Suppl. 2), 5–30. Scheﬀer, M., Baveco, J., DeAngelis, D., Rose, K., & van Nes, E. H. (1995). Super-individuals – A simple solution for modeling large
populations on an individual basis. Ecological modelling, 80, 161–170. Simmons, A. J., & Gibson, J. K. (2000). The ERA-40 Project Plan, ERA-40 Project Report Series No. 1, ECMWF, Reading RG2
9AX, UK, 63 pp. Steele, J. H., & Henderson, E. W. (1995). Predation control of zooplankton demography. ICES Journal of Marine Science, 52,
565–573. Sverdrup, H. (1953). On conditions for the vernal blooming of phytoplankton. Journal of the International Council for Exploration of
the Sea, 18, 287–295. Totterdel, I. J. (1993). An annotated bibliography of marine biological models. Towards a model of biogeochemical processes. In G. T.
Evans, & M. J. R. Fasham (Eds.), (pp. 317–339). Berlin: Springer Verlag. Truscott, J. E., & Brindley, J. (1994). Equilibria, stability and excitability in a general class of plankton population models.
Philosophical Transactions of the Royal Society of London A, 347, 703–718. Waldrop, M. M. (1992). Complexity. New York: Simon & Shuster.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

157

Wiebe, P. H. (1971). A computer model study of zooplankton patchiness and its eﬀect on sampling error. Limnology and Oceanography, 16, 29–38.
Wijﬀels, S. E. (2001). Ocean transport of fresh water. In G. Siedler, J. Church, & J. Gould (Eds.), Ocean circulation and climate (pp. 475–488). London: Academic Press.
Woods, J. D. (2001). Laminar ﬂow in the Ocean Ekman Layer. In R. Pearce (Ed.), Meteorology at the millennium (pp. 204–216). London: Academic Press.
Woods, J. D., & Barkmann, W. (1985). A lagrangian mixed layer model of 18° water formation in the Sargasso Sea. Nature, 319, 574–576.
Woods, J. D., & Barkmann, W. (1986). The inﬂuence of solar heating on the upper ocean: I. The mixed layer. Quarterly Journal of the Royal Meteorological Society, 112, 1–27.
Woods, J. D., Barkmann, W., & Horch, A. (1984). Solar heating of the world ocean. Quarterly Journal of the Royal Meteorological Society, 110, 633–656.
Zavatarelli, M., Baretta, J. W., Baretta-Bekker, J. G., & Pinardi, N. (2000). The dynamics of the Adriatic Sea ecosystem: An idealized model study. Deep-Sea Research, 47(5), 937–970.

Publications based on the LE metamodel

1982
1988
1988 1993 1993 1994 1994
1995 1996
1998 1998
1998 1999 2000

Woods, J. D., & Onken, R., (1982). Diurnal variation and primary production in the ocean – Preliminary results of a Lagrangian Ensemble model. Journal of Plankton Research, 4, 735–736. Wolf, U., & Woods, J. D. (1988). Lagrangian simulation of primary production in the physical environment – The deep chlorophyll maximum and nutricline. In B. Rothschild (Ed.), Towards a theory on biological–physical interactions in the world ocean (pp. 51–70). Woods, J. D. (1988). Mesoscale upwelling and primary production. In B. Rothschild (Ed.), Towards a theory on biological–physical interactions in the world ocean (pp. 7–38). Woods, J. D., & Barkmann, W. (1993). Diatom demography in winter. Fisheries Oceanography, 2, 202–222. Woods, J. D., & Barkmann, W. (1993). The Plankton multipler – Positive feedback in the greenhouse. Journal of Plankton Research, 15(9), 1053–1074. Woods, J., & Barkmann, W. (1994). Simulating plankton ecosystems by the Lagrangian Ensemble method. Philosophical Transactions of the Royal Society B, 343, 27–31. Platt, T., Woods, J. D., Sathyendranath, S., & Barkmann, W. (1994). Net primary production and stratiﬁcation in the ocean. In: O. M. Johnnessen, R. D. Muench, J. E. Overland (Eds.), The Polar Ocean and their role in shaping global climate. American Geophysical Union, 85, 247–254. Woods, J. D., & Barkmann, W. (1995). Modelling oligotrophic zooplankton production: Seasonal oligotrophy oﬀ the Azores. ICES Journal of Marine Science, 52, 723–734. Barkmann, W., & Woods, J. D. (1996). On using a Lagrangian model to calibrate primary production determined from in vitro incubation measurements. Journal of Plankton Research, 18, 767–788. Carlotti, F., & Wolf, U. (1998). A Lagrangian Ensemble model of Calanus ﬁnmarchius coupled with a 1-D ecosystem model. Fisheries Oceanography, 7, 191–204. Miller, C., Lynch, D. R., Carlotti, F., Gentleman, W., & Lewis, C. V. W. (1998). Coupling of an individual-based population dynamic model of Calanus ﬁnmarchicus to a circulation model for the Georges Bank region. Fisheries Oceanography, 7, 219–234. Liu, C.-C., Woods, J., et al. (1998). Optical model for use in oceanic ecosystem models. Applied Optics, 38(21), 4475–4485. Woods, J. D. (1999). Understanding the ecology of plankton. European Review, 7, 371–384 (2000). Virtual ecology. In B. J. Mason (Ed.), Highlights in environmental research (pp. 1–18). London: IC Press.

158 J.D. Woods / Progress in Oceanography 67 (2005) 84–159
2003 Woods, J. D. (2003). Primitive equation modeling of plankton ecosystems. In: N. Pinardi, & J. D. Woods (Eds.), Chapter 18 in Ocean modeling: Conceptual basis and applications. Berlin: Springer Verlag. 472 pp.
2004 Liu, C.-C., & Woods, J. (2004). Deriving four parameters from patchy observations of ocean color for testing a plankton ecosystem model. Deep-Sea Research II.
2004 Liu, C.-C., & Woods, J. D. (2004). Prediction of ocean colour: Monte Carlo simulation applied to a virtual ecosystem based on the Lagrangian Ensemble method. International Journal of Remote Sensing, 25(5), 921–936.
2005 Woods, J. D., Perilli, A., & Barkmann, W. (2005). Stability and predictability of a Virtual Plankton Ecosystem created by an individual-based model. Progress in Oceanography, in press.
2005 Nogueira, E., & Woods, J. D. (2005). Phytoplankton co-existence: Results of an individual-based simulation model. Ecological Modelling, submitted March 2004.
2005 Woods, J. D., Perilli, A., & Vallerga, S. (2005). Emergent ergodicity in a virtual plankton ecosystem. Nonlinear Processes in Geophysics, submitted December 2004.
Technical reports and theses based on the LE metamodel
1992d Woods, J. D., & Brice, A. (1992d). An experimental workbench for plankton ecology simulation. In Proceedings of the conference on second generation CASE tools, Systematica, Bournmouth. 15 pp.
1994 Lythgoe, K., Brice, A., et al. (1994). The lifespan program for computing plankton demography. Unpublished Technical Report in Virtual Ecology, Imperial College London.
1996 Barkmann, W. (1996). Numerical experiments on the response of a virtual plankton ecosystem to increasing nutrient stress. Unpublished Report, University of Southampton.
1997 Liu, C.-C. (1997). Prediction of ocean colour. Ph.D. Thesis, Imperial College London. 1998 Al-Battran, S., Field, A. J., Wiley, R. L., & Woods, J. D. (1998). Parallel simulation of plankton
ecology. In Proceedings of the IASTED international conference modelling & simulation, IASTED, Philadelphia. 1998 Woods, J. D. (1998). The research programme. Virtual Plankton Ecology Technical Report 1, 41 pp. 1998 Brice, A.,& Woods, J. D. (1998). Virtual Ecology Workbench (VEW1) Virtual Plankton Ecology Technical Report 2, 80 pp. 1998 Brice, A., Lythgoe, K., & Woods, J. D. (1998). Lifespan – The calculation of demography. Virtual Plankton Ecology Technical Report 3. 140 pp. 1998 Partridge, L., & Woods, J. D. (1998). The ZB model. Virtual Plankton Ecology Technical Report 4, 33 pp. 1998 Gratrix, S., Jeﬀreys, B., Tharmaratrnam, J., & Woods, J .D. (1998). Virtual Ecology Diagnostics Workbench. Virtual Plankton Ecology Technical Report 5. 41 pp. 1998 Barkmann, W., & Woods, J. D. (1998). The Lagrangian Ensemble model – LEÕ98 science modules. Virtual Plankton Ecology Technical Report 6. 55 pp. 1998 Liu C.-C., & Woods, J. D. (1998). Simulation of ocean colour observed from space. Virtual Plankton Ecology Technical Report 7. 36 pp. 2000 Turner, D. (2000). An individual-based model of the plankton ecosystem with an explicit population of ﬁsh larvae. Unpublished MEng Thesis, Department of Computing, Imperial College. 2000 Partridge, L. (2000). A food web model based on the Lagrangian Ensemble method. Unpublished Report, University of Southampton. 2001 Maggiore, A. (2001). Simulation of plankton patchiness using a three-dimensional version of the WB model driven by a meandering mesoscale jet. Unpublished PhD Transfer Report, Department of Earth Science and Engineering. London, Imperial College.

J.D. Woods / Progress in Oceanography 67 (2005) 84–159

159

2001 2002
2005 2005 2005

Hurt, C. (2001). Computing seasonal variation in the life expectancy of diatoms in a virtual ecosystem. MSc Thesis, Birkbeck College, University of London. Arrese, M. (2002). Upward transport of chemicals by migrating zooplankton in a Virtual Plankton Ecosystem. Unpublished MEng Project Thesis, Department of Earth Science and Engineering, Imperial College, London. 74 pp. Hinsley, W. R. (2005). Planktonica: A system for doing biological oceanography by computer. PhD Thesis, Department of Computing, Imperial College, London. Sinerchia, M. (2005). Testing theories on ﬁsheries recruitment. PhD Transfer Report, Department of Earth Science & Engineering, Imperial College, London. Rogers, A. (2005). A Virtual Ecology Workbench for creating three-dimensional virtual plankton ecosystems. PhD Transfer Report, Department of Earth Science & Engineering, Imperial College, London.

Virtual Plankton Ecology website http://www.imperial.ac.uk/ese/cosmic

