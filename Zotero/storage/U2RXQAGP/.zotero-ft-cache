Lagrangian ocean analysis: fundamentals and practices
Erik van Sebillea,b, Stephen M. Griﬃesc, Ryan Abernatheyd, Thomas P. Adamse, Pavel Berloﬀf, Arne Biastochg, Bruno Blankeh, Eric P. Chassigneti,
Yu Chengj, Colin J. Cotterf, Eric Deleersnijderk,l, Kristofer Do¨o¨sn, Henri Drakeo,p, Sybren Drijfhoutq, Stefan F. Garye, Arnold W. Heeminkl, Joakim
Kjellssonr,t, Inga Monika Koszalkag, Michael Langea,s, Camille Liqueh, Graeme A. MacGilchristu, Robert Marshq, C. Gabriela Mayorga Adamev,
Ronan McAdama, Francesco Nencioliw, Claire B. Parisj, Matthew D. Piggotts, Jeﬀ A. Poltonv, Siren Ru¨hsg, Syed H. A. M. Shahm,l, Matthew D. Thomasx, Jinbo Wangy, Phillip J. Wolframz, Laure Zannat, Jan D. Zikaa
aGrantham Institute & Department of Physics, Imperial College London, UK bInstitute for Marine and Atmospheric Research, Utrecht University, Utrecht, Netherlands
cNOAA / Geophysical Fluid Dynamics Laboratory, Princeton, USA dDepartment of Earth and Environmental Sciences, Columbia University, NY, USA
eScottish Association for Marine Science, Oban, UK fDepartment of Mathematics, Imperial College London, UK gGEOMAR Helmholtz Centre for Ocean Research Kiel, Kiel, Germany hLaboratoire d’Oceanographie Physique et Spatiale, UMR 6523,
CNRS-IFREMER-IRD-UBO, Brest, France iCenter for Ocean-Atmospheric Prediction Studies, Florida State University, Tallahassee,
FL, USA jDepartment of Ocean Sciences, Rosenstiel School of Marine and Atmospheric Science,
University of Miami, USA kUniversit´e catholique de Louvain, Institute of Mechanics, Materials and Civil Engineering
(IMMC) & Earth and Life Institute (ELI), Louvain-la-Neuve, Belgium lDelft Institute of Applied Mathematics (DIAM), Delft University of Technology,
Netherlands mDepartment of Mathematics, Sukkur Institute of Business Administration, Pakistan nDepartment of Meteorology, Bolin Centre for Climate Research, Stockholm University,
Sweden oDepartment Atmospheric and Oceanic Sciences, Princeton University, USA pCurrently at Massachusetts Institute of Technology and Woods Hole Oceanographic
Institution Joint Program in Oceanography, USA qUniversity of Southampton, UK
rBritish Antarctic Survey, Cambridge, UK sDepartment of Earth Science and Engineering, Imperial College London, UK
tDepartment of Physics, University of Oxford, UK uDepartment of Earth Sciences, University of Oxford, UK
vNational Oceanography Centre, Liverpool, UK wRemote Sensing Group, Plymouth Marine Laboratory, Plymouth, UK
xSchool of Geology and Geophysics, Yale University, USA

Preprint submitted to Ocean Modelling

October 9, 2017

yJet Propulsion Laboratory, California Institute of Technology, USA zT-3 (Climate, Ocean and Sea Ice Modeling), Los Alamos National Laboratory, USA

Abstract
Lagrangian analysis is a powerful way to analyse the output of ocean circulation models and other ocean velocity data such as from altimetry. In the Lagrangian approach, large sets of virtual particles are integrated within the three-dimensional, time-evolving velocity ﬁelds. Over several decades, a variety of tools and methods for this purpose have emerged. Here, we review the state of the art in the ﬁeld of Lagrangian analysis of ocean velocity data, starting from a fundamental kinematic framework and with a focus on large-scale open ocean applications. Beyond the use of explicit velocity ﬁelds, we consider the inﬂuence of unresolved physics and dynamics on particle trajectories. We comprehensively list and discuss the tools currently available for tracking virtual particles. We then showcase some of the innovative applications of trajectory data, and conclude with some open questions and an outlook. The overall goal of this review paper is to reconcile some of the diﬀerent techniques and methods in Lagrangian ocean analysis, while recognising the rich diversity of codes that have and continue to emerge, and the challenges of the coming age of petascale computing.
Key words: Ocean circulation, Lagrangian analysis, Connectivity, Particle tracking, Future modeling

Contents

1 Introduction 1.1 Estimating pathways . . . . . . . . . . . . . . . . . . . . . . . 1.2 Overview of Lagrangian ocean analysis . . . . . . . . . . . . . 1.3 Structure of this paper . . . . . . . . . . . . . . . . . . . . . .

4 4 5 8

2 Kinematic framework

8

2.1 Lagrangian and Eulerian reference frames . . . . . . . . . . . . 8

2.2 Trajectories or material pathlines . . . . . . . . . . . . . . . . 9

2.3 The material time derivative without trajectories . . . . . . . 10

2.4 Steady-state volume transport pathways deﬁned by streamtubes 11

2

2.5 An introduction to tracer transport pathways . . . . . . . . . 12 2.5.1 The tracer equation with subgrid scale transport . . . . 13 2.5.2 Introducing the Fokker-Planck equation . . . . . . . . 15 2.5.3 Using particles to track a tracer patch . . . . . . . . . 16

3 Computing Lagrangian particle trajectories

16

3.1 Basic needs for Lagrangian trajectory calculations . . . . . . . 16

3.2 Temporal integration of the virtual particle trajectory equation 18

3.2.1 Explicit time stepping methods . . . . . . . . . . . . . 20

3.2.2 Time-implicit discrete integration schemes . . . . . . . 21

3.2.3 An analytical discrete streamtube method . . . . . . . 21

3.3 Computing stochastic trajectories to simulate diﬀusion and

unresolved physics . . . . . . . . . . . . . . . . . . . . . . . . 23

3.3.1 Stochastic trajectories using the Fokker-Planck equation 24

3.3.2 A hierarchy of Markov models for stochastic trajectories 26

3.3.3 When and how to add stochastic terms? . . . . . . . . 28

3.4 Spatial interpolation . . . . . . . . . . . . . . . . . . . . . . . 29

3.5 Available tools . . . . . . . . . . . . . . . . . . . . . . . . . . 30

4 Applications of Lagrangian particle trajectories

31

4.1 Dispersion and diﬀusivity . . . . . . . . . . . . . . . . . . . . 31

4.2 Lagrangian Coherent Structures . . . . . . . . . . . . . . . . . 35

4.3 Probability distributions . . . . . . . . . . . . . . . . . . . . . 38

4.4 Water mass ages and transit times . . . . . . . . . . . . . . . 41

4.5 Volume transport and Lagrangian streamfunctions . . . . . . . 43

4.6 Biological connectivity . . . . . . . . . . . . . . . . . . . . . . 45

5 Outlook

46

5.1 The next generation of particle tools . . . . . . . . . . . . . . 46

5.2 A case for standard tests of particle tools . . . . . . . . . . . . 47

5.3 Whole-Earth System and Water Cycle Modelling . . . . . . . 48

6 Concluding remarks

51

A Community tools for Lagrangian Ocean Analysis

52

A.1 Community-based oﬄine 3D Lagrangian codes . . . . . . . . . 52

A.1.1 Ariane . . . . . . . . . . . . . . . . . . . . . . . . . . . 52

A.1.2 TRACMASS . . . . . . . . . . . . . . . . . . . . . . . 53

3

A.1.3 Octopus . . . . . . . . . . . . . . . . . . . . . . . . . . 54 A.1.4 LAMTA software package . . . . . . . . . . . . . . . . 54 A.1.5 The Connectivity Modeling System (CMS) . . . . . . . 55 A.1.6 Other Biotic-particle models . . . . . . . . . . . . . . . 56 A.1.7 Parcels . . . . . . . . . . . . . . . . . . . . . . . . . . . 56 A.2 Online tools within OGCMs . . . . . . . . . . . . . . . . . . . 56 A.2.1 LIGHT within MPAS-O . . . . . . . . . . . . . . . . . 56 A.2.2 NEMO . . . . . . . . . . . . . . . . . . . . . . . . . . . 57 A.2.3 MITgcm . . . . . . . . . . . . . . . . . . . . . . . . . . 57 A.2.4 HYCOM . . . . . . . . . . . . . . . . . . . . . . . . . . 58 A.2.5 ROMS . . . . . . . . . . . . . . . . . . . . . . . . . . . 58

B Tracer trajectories with isopycnal diﬀusion

59

C Diﬀusion in two-dimensional models and associated Lagrangian

tracer trajectories

61

1 1. Introduction
2 The ocean exhibits a huge range of dynamical motions, spanning scales 3 from millimeters to thousands of kilometers. As seawater moves, each ﬂuid 4 particle carries tracers such as salt, nutrients, heat, as well as particulate 5 matter such as plankton and marine debris. For various theoretical and 6 practical applications, we are interested in how water moves between ocean 7 regions. That is, we are interested in mapping out pathways of seawater 8 motion, since the transport of seawater and its tracer content, as well as the 9 pathways and timescales for that transport, are key facets in how the ocean 10 plays a role in climate and marine ecology.
11 1.1. Estimating pathways
12 There are two general methods for estimating pathways in the ocean. One 13 method makes use of tracers, such as the multitude of age tracers described 14 by Mouchet et al. (2016) and references therein. Tracer studies are well suited 15 for Eulerian methods, which make direct use of ocean velocity ﬁelds on their 16 native grids. 17 The second approach makes exclusive use of the Lagrangian perspective 18 of ﬂuid dynamics (e.g., Bennett, 2006). This method employs an ensemble of 19 virtual (passive) Lagrangian particles of zero spatial extent whose trajectories

4

20 are determined by the velocity ﬁeld.1 The velocity ﬁelds that are used to 21 move the particles often come from OGCMs, although there are interesting 22 application using observational-based velocities such as surface geostrophic 23 velocities based on satellite altimetry (e.g. d’Ovidio et al., 2009; Klocker and 24 Abernathey, 2014), or measured by high frequency (HF) radar (e.g. Ullman 25 et al., 2006). 26 Trajectories for virtual particles map out pathlines of the velocity ﬁeld, 27 often including the eﬀect of subgrid scale diﬀusion. Statistics of the trajectories 28 then deﬁne particle pathways and their associated time scales. By following 29 the ﬂow of virtual particles, and possibly assigning non-zero transports and 30 other properties to them in post-processing, questions about pathways and 31 ﬂow connectivity can be addressed. 32 This review focuses on Lagrangian analysis methods facilitated by virtual 33 particles in the open ocean. We are partly motivated by the growing array 34 of ﬂoating instruments in the ocean along with the improving Lagrangian 35 simulation capabilities. There is a corresponding need to review the methods 36 and foster new ideas for extracting information about the ocean circulation 37 from the entangled trajectories of ﬂoats and/or simulated particles. We 38 thus aim to summarize the state of the science in Lagrangian modelling and 39 analysis, focussing on the large scale open ocean circulation, hoping to support 40 a new generation of scientists contributing to the development and use of the 41 methods. 42 Our presentation is aimed at graduate students, though any large-scale 43 oceanographer or mathematician with an interest in virtual particle analysis 44 could use this paper as a starting point. In that sense, this paper is intended 45 as an accompanying paper to Griﬃes et al. (2000), which provided an intro46 duction to primitive equation ocean models and to ˚Adlandsvik et al. (2009), 47 which gave an overview of Lagrangian modelling practice from a marine 48 biology perspective.
49 1.2. Overview of Lagrangian ocean analysis
50 Observationalists have been tracking the ocean in a Lagrangian fashion 51 since the very early ages of oceanography. Movements of the currents were 52 documented using either ship drift or the drift of purposely built (subsurface)
1Lagrangian particles are also sometimes called ‘e-ﬂoats’ by, for example, Bower et al. (2009).
5

Figure 1: Map of all the Southern Ocean observational Lagrangian surface drifters in the NOAA GDP Data Set (Lumpkin and Pazos, 2007). Each drifter is geo-located every 6 hours and has a randomly assigned colour.
53 ﬂoats (e.g., Swift and Riser, 1994). Many observations remain inherently 54 Lagrangian, such as the trajectories of surface drifters shown in Figure 1 55 (Lumpkin and Pazos, 2007), the subsurface Argo ﬂoats (Lebedev et al., 2007; 56 Ollitrault and Rannou, 2013), and the tracking of ﬁsh larvae (Paris et al., 57 2013a) and turtle hatchlings (Scott et al., 2014). 58 Lagrangian analysis through virtual particle tracking within OGCMs began 59 in the 1980s, on small-scale structures, with studies on a theoretical box-model 60 (Awaji et al., 1980) as well as a model that incorporated hydrographic data 61 and realistic topography (Imasato et al., 1980). The Lagrangian framework 62 of these small-scale examples was then applied to the velocity-ﬁeld output 63 of basin-scale, three-dimensional numerical experiments. Examples include 64 regional deep ocean circulation (Fujio and Imasato, 1991), western boundary 65 currents (Imasato and Qiu, 1987), fronts (Pavia and Cushman-Roisin, 1988) 66 and gyre transport (B¨oning and Cox, 1988). Particle trajectories in global 67 ocean circulation models, driven by global hydrographic and wind observations, 68 were ﬁrst achieved in the 1990s (Fujio et al., 1992; Do¨o¨s, 1995; Drijfhout et al., 69 1996; Blanke and Raynaud, 1997). 70 In recent years, more than 100 articles per year are published with the 71 words ‘Lagrangian Ocean Modelling’ as the topic, according to the Web of 72 Science. These papers include studies on the pathways of virtual particles 73 that simulate sea water pathways, as well as explicit tracking of tracers such
6

74 as nutrients (e.g. Chenillat et al., 2015; Jo¨nsson et al., 2011) and particulates 75 such as larvae (e.g. Cowen et al., 2006; Paris et al., 2005; Teske et al., 2015; 76 Cetina-Heredia et al., 2015; Phelps et al., 2015), plastics (e.g. Lebreton et al., 77 2012), microbes (e.g. Hellweger et al., 2014), planktic foraminifera (e.g. van 78 Sebille et al., 2015), jellyﬁsh (e.g. Dawson et al., 2005), icebergs (e.g. Marsh 79 et al., 2015), surface drifters (e.g. Kjellsson and D¨o¨os, 2012b), oil droplets 80 (e.g. Paris et al., 2012), eel (e.g. Baltazar-Soares et al., 2014), pumice (e.g. 81 Jutzeler et al., 2014) and many more. 82 The ocean circulation covers an enormous range of scales and regions. As 83 said above, in this review we focus primarily on applications on the basin 84 and global scales. However, it should be noted that there is also extensive 85 Lagrangian analysis work done on smaller scales, such as in coastal zones and 86 recently in the Gulf of Mexico through interest in dispersion of the DeepWater 87 Horizon oil spill (e.g. Beron-Vera and LaCasce, 2016; Haza et al., 2016). 88 The Lagrangian framework is not only used to analyse velocity ﬁelds by 89 computing their integral curves, but also to directly solve for the trajectory 90 by casting the equations of motion in a Lagrangian framework (Bennett, 91 2006). Lagrangian methods are widely used in engineering, including Discrete 92 Element Methods (e.g. Kruggel-Emden et al., 2008) and Smoothed Particle 93 Hydrodynamics (e.g. Cummins et al., 2012). While advances in this ﬁeld 94 have been made in large scale oceanography, both for sub-components of 95 ocean models (e.g. Bates et al., 2012) and for fully Lagrangian ocean models 96 (Haertel and Randall, 2002; Haertel and Fedorov, 2012), this topic is not the 97 focus of this review. Instead, we focus on Lagrangian diagnostic methods to 98 identify oceanic pathways. 99 The Lagrangian framework for analysing pathways is complementary to 100 the analysis of tracers. One of the key diﬀerences is the computational cost. 101 For each time step, movement of a Lagrangian particle takes only one set of 102 computations. In contrast, the advection-diﬀusion of a tracer concentration 103 takes N sets of computation, where N is the number of discrete ocean grid 104 cells. While one Lagrangian particle trajectory does not allow for meaningful 105 analysis of ocean pathways, this comparison does show that the computational 106 scaling of the two methods is very diﬀerent. 107 Furthermore, the experimental design is diﬀerent for tracer and particle 108 experiments. Exclusive to particle experiments is that the entire trajectory 109 history of the virtual particles can in principle be stored. This history allows 110 for a posteriori analysis of ‘connectivity’ between diﬀerent regions of the ocean 111 (e.g., sections 4.5 and 4.6) and ‘conditional statistics’ (e.g. Koszalka et al.,
7

112 2013b; van Sebille et al., 2013, 2014; von Appen et al., 2014; Gary et al., 2014; 113 Durgadoo et al., 2017), where subsets of particles can be analysed that obey 114 certain conditions based on their properties. For example, in van Sebille et al. 115 (2013), particles in the Southern Ocean were analysed for how often they 116 looped around Antarctica in their journey from the Antarctic slope to the 117 deep subtropical basins. Such an analysis would be hard to do with tracer 118 ﬁelds, although the latter has its own advantages, including a more natural 119 alignment with the treatment of advection and diﬀusion within models. 120 Finally, another great advantage of Lagrangian particle experiments is 121 that particles can be advected, at least in oﬄine mode when velocity ﬁelds are 122 stored, backwards in time. This reverse-time analysis allows one to investigate 123 where water masses found within a model at a certain location come from.
124 1.3. Structure of this paper 125 This paper is structured as follows. In Section 2 we introduce a kinematic 126 framework used for thinking about Lagrangian particles. In Section 3 we detail 127 how to compute and interpret Lagrangian particles, including an overview 128 of the available Lagrangian diagnostic tools. In Section 4, we highlight 129 applications of how virtual particle trajectories can be analysed to reveal 130 quantitative and qualitative information about the ﬂow. In Section 5, we 131 conclude the main part of the paper with future outlooks. A selection of 132 appendices then provide examples and detailed discussion of topics introduced 133 earlier in the paper, as well as brief descriptions of the diﬀerent numerical 134 codes introduced in Section 3.
135 2. Kinematic framework
136 We here introduce a kinematic framework to describe ﬂuid motions. The 137 ideas are fundamental to how we make use of both Eulerian and Lagrangian 138 methods for analyzing ocean circulation. We make connections to Lagrangian 139 analysis methods, though reserve algorithmic details for later sections.
140 2.1. Lagrangian and Eulerian reference frames 141 A Lagrangian kinematic approach is based on a description of the ﬂuid in a 142 reference frame that is moving with an inﬁnitesimal ﬂuid particle (equivalently 143 a “ﬂuid parcel”). Fluid motion is thus the accumulation of continuum particle 144 motion. The ﬂuid particle framework that forms the basis for Lagrangian 145 kinematics oﬀers a powerful conceptual picture of ﬂuid motion (e.g., Salmon,
8

146 1998; Bennett, 2006), with this picture taken as the basis for Lagrangian 147 methods of analysis. 148 Eulerian kinematics is a complement to Lagrangian kinematics. The 149 Eulerian approach is based on describing ﬂuid motion in a reference frame 150 that is ﬁxed in space. Eulerian kinematics is the basis for most numerical 151 ocean circulation models, in which the horizontal position of grid cells is 152 held ﬁxed in time2. Quite generally, the technical aim of Lagrangian ocean 153 analysis is to estimate the trajectory of virtual ﬂuid particles by making use 154 of Eulerian ﬂuid information, i.e., the velocity ﬁeld.
155 2.2. Trajectories or material pathlines
156 The motion of a classical point particle is described by knowledge of its 157 position vector, X(t), which provides the position of the particle at time 158 t. As the particle moves, it traces out a curve in space referred to as a 159 trajectory. When describing N discrete particles, we add a discrete label 160 to each of the particle positions, X(n)(t). For continuum matter, such as 161 seawater, the discrete label n becomes a continuous vector, X(a, t), with 162 a = X(t = t0) a common (though not necessary) choice. In general, the label 163 vector, a, is referred to as the material coordinate (e.g., Salmon, 1998), since 164 this coordinate distinguishes between inﬁnitesimal particles comprising the 165 continuum. 166 A ﬂuid particle is conceived of as a microscopically large collection of 167 many molecules, whose velocity is formally determined as a mass weighted 168 mean of the velocity of the individual molecules (i.e., barycentric velocity 169 as deﬁned in Section II.2 of DeGroot and Mazur (1984) and Section 1.9 of 170 Salmon (1998)). Alternatively, by making the continuum hypothesis, we 171 dispense with molecular degrees of freedom, so that a particle is considered 172 a macroscopically small material ﬂuid volume, treated as a mathematical 173 continuum and labelled by the material coordinate a. For an incompressible 174 ﬂuid, the ﬂuid particle has constant volume; however, its constituents do 175 not remain ﬁxed, as they are generally exchanged with adjacent particles 176 through mixing, thus changing the particle’s tracer content (e.g., water, salt,
2The top and bottom faces of grid cells are generally moving, since the general vertical coordinates deﬁning these surfaces need not be static. For example, these cell faces may be deﬁned according to constant pressure, constant potential density, or constant rescaled ocean depth.
9

177 nutrients), as well as altering its heat, all the while maintaining a constant 178 volume. 179 The velocity of a ﬂuid particle is the time derivative of the trajectory, 180 computed with the material coordinate held ﬁxed. The mathematical connec181 tion between Lagrangian and Eulerian descriptions is enabled by equating the 182 particle velocity crossing a point in space, X(a, t) = x, to the ﬂuid velocity 183 ﬁeld at that point

∂X(a, t) = v(x, t)
∂t a

where X(a, t) = x.

(1)

184 The relation (1) provides a starting point for Lagrangian ﬂuid analysis. Note

185 that the resulting ﬂuid particle trajectories are sometimes called material

186 pathlines in the ﬂuid mechanics literature (e.g., Aris, 1962; Batchelor, 1967).

187 2.3. The material time derivative without trajectories 188 A kinematic description requires time changes of an arbitrary function, Ψ, 189 evaluated along trajectories, Ψ[X(a, t), t]. Use of the chain rule leads to

∂Ψ[X(a, t), t] =

∂

+ v[X(a, t), t] · ∇ Ψ[X(a, t), t].

∂t ∂t x

(2)

190 Note that, when trajectories are dispensed with (as in the Eulerian descrip-

191 tion), we recover the more succinct expression for the material time derivative

DΨ(x, t) =

∂ + v(x, t) · ∇ Ψ(x, t),

Dt ∂t

(3)

192 where all expressions on the right hand side are taken with respect to the ﬁxed 193 Eulerian reference frame.3 The symbol D is commonly used to distinguish 194 the material time derivative from a more general time derivative that is not 195 necessarily following a material ﬂuid particle. To illustrate this formalism, 196 consider Ψ(x, t) = x. In this case, the material time derivative is given by 197 the velocity ﬁeld at that point

Dx = v(x, t).
Dt

(4)

3An alternative derivation of equation (3), which is arguably more straightforward mathematically, dispenses with trajectories from the start, in which case we express the total diﬀerential of a function as dΨ(x, t) = dt ∂tΨ + dx · ∇Ψ. Specifying the spatial increment to correspond to movement of a ﬂuid particle, dx = v(x, t) dt, leads to equation (3). We prefer the derivation using particle trajectories, as it exposes the relation between Lagrangian and Eulerian reference frames.

10

198 2.4. Steady-state volume transport pathways deﬁned by streamtubes

199 Within Lagrangian Ocean Analysis, there is a long history of interpreting

200 particle trajectories as streamtubes, and using this interpretation to compute

201 volume transports (D¨o¨os, 1995; Blanke and Raynaud, 1997, see also section

202 3.2.3). Formally, the equivalence between streamtubes and material pathways

203 is only valid for steady-state ﬂows (i.e. where the ﬂow is constant in time).

204 Originally, the streamtube calculations were indeed performed on time-mean,

205 steady-state velocity ﬁelds, but they were soon extended to time-varying

206 ﬂows, for example by assuming piecewise steady ﬂow (Blanke and Raynaud,

207 1997, cf. Section 3.2.3). Over the last two decades, however, the approach has

208 been widely used in studies of large-scale ocean transports (see e.g. section

209 4.5), justifying a discussion of the mathematical underpinning of streamtubes

210 for steady-state ﬂows here in this review manuscript.

211 The ocean is a nearly incompressible ﬂuid. Thus, for this review we

212 consider an incompressible (Boussinesq) ﬂuid, which means that the velocity

213 ﬁeld is non-divergent

∇ · v = 0.

(5)

214 Consequently, the volume of a material ﬂuid particle remains constant (i.e., 215 it is incompressible). 216 A streamtube is a bundle of streamlines, so that streamtube sides are 217 parallel to the velocity (see e.g. Figure 3.6 in Kundu et al., 2012)4. For a 218 steady ﬂow, streamlines are equivalent to material pathlines, in which case 219 streamtubes are material tubes. It is for the steady case that we can make use 220 of streamtubes to map out volume transport pathways in an incompressible 221 ﬂuid. We see this property by integrating the non-divergence constraint, 222 equation (5), over the streamtube, and making use of Gauss’s Law. Doing so 223 reveals that volume transport (volume per time) through the two streamtube 224 ends balances exactly

v · nˆ dA + v · nˆ dA = 0,
A1 A2

(6)

225 where nˆ is the outward normal at the respective end, and dA the corresponding 226 area. By construction, v · nˆ = 0 on the streamtube sides, so the sides do 227 not contribute to the balance in equation (6). Hence, the volume transport

4One may think of streamtubes as the “communication cable lines” within an incompressible ﬂuid, transmitting volume signals within a steady ﬂow.
11

228 entering one streamtube end equals to that leaving the other end. Furthermore, 229 the area of the streamtube is inversely proportional to the local normal velocity. 230 The transport constraint (6) holds regardless of whether there is diﬀusive 231 tracer mixing in the Boussinesq ﬂuid. It follows from the non-divergence 232 property of the velocity ﬁeld in an incompressible ﬂuid. However, in the 233 presence of diﬀusive tracer mixing, the actual material entering one end of 234 the streamtube is not necessarily the same as the material exiting the other 235 end (see also Section 2.5). 236 The above properties make streamtubes useful for understanding the 237 circulation in a steady incompressible ﬂuid. In particular, they provide 238 the mathematical basis for Lagrangian analysis methods that tag particles 239 with volume transport (e.g. Eckart, 1948; Welander, 1955). The aggregated 240 integral curves for such particles deﬁne a probability density function (PDF) 241 for volume transport pathways. In the continuum and under the assumption 242 of a steady ﬂow ﬁeld, volume transport pathways deduced from streamtubes 243 are identical to pathways deduced from particle trajectories determined by 244 time stepping equation (1). 245 We can make use of the volume transport information carried by stream246 tubes for Lagrangian analysis. To do so, deﬁne the starting point for a 247 streamtube by assigning a volume transport to each particle. The assigned 248 volume transport is directly proportional to the transport crossing the grid cell 249 face where the particle is initialized. In principle, we can ﬁll a non-divergent 250 ﬂow ﬁeld without void between streamtubes. Consequently, we can compute 251 streamtube derived volume transport pathways whether the ﬂow is laminar 252 or turbulent. However, turbulent ﬂow generally requires more streamtubes 253 to develop robust statistics for the transport pathways, and also requires 254 that the ﬂow is assumed piecewise steady (see also section 3.2.3), as for any 255 transient ﬂow, steady-state streamlines lose their equivalence to pathlines.
256 2.5. An introduction to tracer transport pathways
257 A ﬁnite-size material seawater parcel is comprised of fresh water and 258 tracers of other matter, such as salts and biogeochemical components5. Tracer 259 concentration, C, measures the mass of tracer per parcel mass. The velocity
5Conservative temperature can also be considered as the concentration of heat in a parcel. The reason is that, to a very good approximation, Conservative Temperature satisﬁes a source-free tracer equation analogous to salinity (McDougall, 2003; Graham and McDougall, 2013).
12

260 considered in ﬂuid mechanics is the barycentric velocity (section 2.2), so 261 that the mass (or volume for a Boussinesq ﬂuid) of a material ﬂuid parcel 262 is constant. However, the mass of each trace constituent is not materially 263 constant, since tracers are exchanged between parcels through mixing in the 264 presence of concentration gradients. Since the small-scale motions that govern 265 this mixing are hardly ever resolved in OGCMs, the eﬀect of tracer mixing 266 has to be represented as (resolution-dependent) diﬀusive transports based on 267 mean distributions. 268 In Section 2.4, we deﬁned volume transport pathways according to stream269 tubes in a steady ﬂow. Here, we introduce transport pathways deﬁned by 270 trace constituents. In the presence of diﬀusive tracer mixing, tracer and 271 volume transport pathways are distinct. The machinery of stochastic diﬀer272 ential equations (SDEs) is required to compute tracer transport pathways, 273 with details deferred to Section 3.3. Our purpose here is to anticipate that 274 discussion by introducing various forms of the tracer concentration equation. 275 In so doing, we also introduce the residual mean velocity.

276 2.5.1. The tracer equation with subgrid scale transport
277 Molecular diﬀusion as well as turbulent subgrid scale transport processes 278 give rise to irreversible (diﬀusive) transport as well as reversible (advective 279 or skew diﬀusive) transport. Mathematically, we express the subgrid scale 280 tracer transport through a transport tensor, J . The corresponding tracer 281 concentration equation takes the form6

∂ + v · ∇ C = ∇ · (J · ∇C), ∂t

(7)

282 where the transport tensor J has units of squared length per time. It is

283 convenient to split the transport tensor into the sum of a symmetric and

284 anti-symmetric tensor

J = K + A.

(8)

285 The symmetric tensor, K, has components satisfying7

Kij = Kji.

(9)

6We assume a Boussinesq ﬂuid when writing the tracer equation (7). 7We make use of Cartesian tensors throughout this review, with results generalizable to
arbitrary coordinates.

13

286 This tensor corresponds to diﬀusion so long as it is positive deﬁnite. The 287 anti-symmetric tensor, A, corresponds to skew diﬀusion or equivalently to 288 advection (e.g., Middleton and Loder, 1989; Griffies, 1998). 289 Given the decomposition of the transport tensor (8), we ﬁnd it useful to 290 write the tracer equation in the form

∂ + v† · ∇ C = ∇ · (K · ∇C), ∂t

(10)

291 where

v† = v + v∗

292 deﬁnes the residual-mean velocity and

(11)

vj∗ = −∂iAij

(12)

293 is known as the eddy-induced velocity 8. Notably, the eddy-induced velocity 294 is non-divergent due to the anti-symmetry property

Aij = −Aji ⇒ ∇ · v∗ = 0.

(13)

295 Consequently, the tracer equation (10) can be written in the ﬂux-form

∂C + ∇ · (v† C) = ∇ · (K · ∇C). ∂t

(14)

296 Since both v and v† are divergence-free, one can deﬁne a streamtube in a 297 steady-state ﬂow according to either velocity ﬁeld. The streamtubes deﬁned by 298 the residual mean velocity are often more relevant than those for the Eulerian 299 time-mean velocity for ocean transport since the residual mean velocity 300 v† incorporates information about subgrid scale eddy advective transport. 301 Drijfhout et al. (2003), for example, explicitly calculated particle trajectories 302 with both Eulerian mean and residual mean velocities and discussed the 303 diﬀerences in (overturning) pathways. Particle trajectories using the Eulerian 304 mean exhibit motions that cross mean isopycnal surfaces, whereas trajectories 305 making use of the residual mean better respect the adiabatic nature of the 306 meridional overturning ﬂow.

8Repeated indices are summed over their range.

14

307 2.5.2. Introducing the Fokker-Planck equation
308 Anticipating the discussion of Stochastic Diﬀerential Equations (SDEs) in 309 Section 3.3.1, we manipulate the diﬀusive contribution in the tracer equation 310 (14). The aim is to write the tracer concentration equation in the form 311 of a Fokker-Planck equation (see equation (24)), which describes the time 312 evolution of the probability density function of the tracer. For this purpose, 313 we use the identity

∂i (Kij ∂jC) = ∂i [∂j (Kij C) − C ∂j Kij] ,

314 so that

∂C ∂t

+ ∇ · (vdrift C)

=

∂ij

(Kij

C ),

315 where we introduced the drift velocity

vdrift = v† + ∇ · K.

(15) (16) (17)

316 The drift velocity generally has a non-zero divergence

∇ · vdrift = ∂ij Kij ,

(18)

317 since ∂ijKij does not generally vanish 9. Equation (16) is the tracer equation 318 written in the form of a Fokker-Planck equation. 319 Tracer transport pathways diﬀer from volume transport pathways in the 320 following ways. First, as already mentioned, the drift velocity vdrift is generally 321 divergent. Hence, it is not useful to deﬁne steady-state “tracer streamtubes” 322 in terms of v .drift Second, even if ∇ · K = 0 so that the drift velocity is 323 divergent-free (e.g., isotropic diﬀusion with a constant diﬀusivity), tracer 324 pathways are aﬀected by diﬀusive mixing between ﬂuid particles. To represent 325 such diﬀusion in a Lagrangian trajectory calculation requires a stochastic noise 326 term weighted by the diﬀusion tensor (Section 3.3). Therefore, whether one 327 considers volume transport pathways or tracer transport pathways depends on 328 the scientiﬁc question and the information available to address that question.

9One notable case where ∇ · vdrift = 0 is isotropic diﬀusion with a constant diﬀusivity; e.g., molecular diﬀusion. Molecular diﬀusion is generally not relevant for large-scale ocean models, as models (and large-scale observations) do not resolve down to the Kolmogorov scales. Hence, large-scale models make use of the far larger, and ﬂow dependent, eddy diﬀusivities.

15

329 2.5.3. Using particles to track a tracer patch

330 There is yet another way to consider tracer transport pathways using

331 Lagrangian analysis. For this approach, we represent a patch of tracer as

332 a collection of Lagrangian particles (e.g. Bennett, 2006; LaCasce, 2008). In

333 this way, Lagrangian analysis can be used to study tracer dispersion (Rossi

334 et al., 2013; Wang et al., 2016a). In principle, in the limit of inﬁnite number

335 of particles and knowledge of the velocity ﬁeld to arbitrarily ﬁne spatial and

336 temporal resolution, the tracer dispersion from Lagrangian particles would

337 have theoretically perfect resolution and controllable numerical diﬀusion. How

338 achievable this is in real-world simulations remains an area of active research.

339 A tracer patch can be represented by a cloud of particles. Each particle

340 carries a portion of the total tracer content. Let c denote the tracer volume

341 per particle. The corresponding Eulerian tracer concentration, C(x, t), can

342 be written

N

C(x, t) = W (x − xi(t))ci,

(19)

i=0

343 where N is the total number of particles, xi is the particle position, and W is 344 a mapping kernel function (dimensions inverse volume) that maps the particle

345 density to tracer density. The kernel function satisﬁes the normalization

346 condition required to conserve volume

W dx dy dz = 1,
Ω

(20)

347 where Ω is the integral volume in three dimensions. The form of W has been 348 extensively investigated in the Smoothed Particle Hydrodynamic approach 349 (Monaghan, 1992). Diﬀerent forms of W exist with diﬀerent projection errors.

350 3. Computing Lagrangian particle trajectories
351 In this section we discuss technical aspects of Lagrangian modelling and 352 analysis, focusing here on the computation of trajectories. We consider 353 how trajectories of virtual Lagrangian particles can be used in mapping 354 both volume transport pathways and tracer transport pathways (recall the 355 distinction discussed in Section 2.5).
356 3.1. Basic needs for Lagrangian trajectory calculations 357 For volume transport pathways, one needs a non-divergent velocity ﬁeld. 358 A three-dimensional non-divergent velocity can be produced by sampling a

16

359 Boussinesq ocean model, thus oﬀering a means to compute three-dimensional 360 trajectories. To compute tracer transport trajectories, we need both a velocity 361 ﬁeld and a diﬀusion tensor. The diﬀusion tensor is a function of the often 362 poorly known subgrid scale ﬂow, and it is generally a complex function of 363 the ﬂow ﬁeld. Consequently, the calculation of tracer transport pathways is 364 somewhat less mature than volume transport pathways (though see Tables 1 365 and 2). 366 When using an ocean model, we distinguish between two techniques of 367 Lagrangian integration. The ﬁrst occurs online, whereby trajectories are 368 computed each time step that the Eulerian model is updated. Examples of 369 such online methods are available for volume transport pathways using the 370 velocity ﬁeld (see Section 3.5). In contrast, we know of no example of online 371 tracer trajectory calculations making use of both the instantaneous velocity 372 ﬁeld and the diﬀusion tensor. 373 The second method for Lagrangian analysis occurs through oﬀ-line trajec374 tory calculations. Oﬀ-line methods make use of stored velocity ﬁelds sampled 375 from the Eulerian model. Oﬀ-line trajectory calculations oﬀer the ability to 376 compute trajectories in a forward mode (from their starting point forward in 377 time) or in a backward mode (from their ending point backward in time). 378 As an alternative to velocities generated by OGCMs, we may use observation379 based data from ﬂoats or drifters, which generally give a two dimensional 380 surface velocity (e.g., Koszalka et al., 2011). We may also diagnose a surface 381 geostrophic velocity by diﬀerentiating gridded satellite observations of the sea 382 surface height (e.g., Klocker et al., 2012b). Notably, both surface drifter/ﬂoat 383 velocities and surface geostrophic velocities generally have a non-zero hori384 zontal divergence (surface geostrophic velocities are non-divergent only on 385 an f -plane), and the corresponding surface trajectories do therefore not map 386 volume transport pathways. Nonetheless, the resulting surface trajectories do 387 map preferred pathways of the surface ﬂow, thus providing useful diagnostic 388 information. 389 Computation of particle trajectories using a velocity ﬁeld requires essen390 tially two operations: a way to integrate the trajectory equation (1) and a 391 way to interpolate a gridded velocity ﬁeld to an arbitrary point in space and 392 time. In this section, we detail these aspects.
17

393 3.2. Temporal integration of the virtual particle trajectory equation 394 When the nth virtual seawater particle is located at the point X(n)(t) = x, 395 we can update its position by time stepping the velocity equation (1)

t+∆t
X(t + ∆t) = X(t) + v(x(τ ), τ ) dτ,

(21)

t

396 where we dropped the trajectory super-script n to simplify notation. Note 397 that the integrand involves the Eulerian velocity ﬁeld v(x, τ ), which equals 398 to the Lagrangian velocity dX(t)/dt when evaluated at X(t) = x. In 399 some applications of Lagrangian analysis, there is an additional term on 400 the right hand side of equation (21) that represents unresolved physics (see 401 Section 3.3.2). We explore various ﬂavours of this discrete time stepping (see 402 also Figure 2) for estimating virtual particle trajectories, focussing on the 403 most commonly used schemes. However, there are many more schemes than 404 discussed here (e.g., Chu and Fan, 2014; Liu and Chua, 2016). 405 In general, the accuracy of trajectories computed in OGCM ﬁelds de406 pends on accuracy of the time stepping scheme, as well as accuracy of the 407 interpolation scheme used to estimate velocity at the time and position of 408 the particle (see Section 3.4). Note that the ﬁrst three methods (explicit, 409 implicit and analytical) discussed below all result in identical trajectories 410 in the continuum. However, the trajectories diﬀer in numerical implementa411 tions due to algorithmic diﬀerences and truncation errors. For all methods, 412 statistical signiﬁcance of the diagnosed pathways is enhanced by increasing 413 the number of deployed particles. As a rule of thumb, one has deployed a 414 suﬃcient numbers of particles when the physical results of interest do not 415 signiﬁcantly change as the number of particles is increased (e.g., Jones et al., 416 2016). 417 The maximum integration time in equation (21) is limited to the run time 418 of a given model simulation. A number of oceanic processes, however, have 419 time scales that exceed these run times (e.g., England, 1995; Stouﬀer, 2004; 420 Danabasoglu, 2004). Using Lagrangian particles to temporally resolve for 421 example the meridional overturning circulation (Blanke et al., 1999; Thomas 422 et al., 2015b) or inter-basin connectivity (Blanke and Speich, 2002) can be 423 diﬃcult with many state of the art climate models. To address this problem, 424 a commonly employed ad hoc method is to loop the model data in time such 425 that the velocity and tracer ﬁelds are returned to the ﬁrst time step once the

18

Vi,j = 2

Interpolated velocity field Analytical solution Runge-Kutta solution

Ui-1,j = 3

T i,j Ui,j = 1

Vi,j-1 = 0
Figure 2: Illustration of time stepping solutions on an Arakawa C-grid with edges of non-dimensional length=1. Velocities (u, v) across the four edges are given in numbers at the magenta dots. The blue arrows are the linearly interpolated velocities within the grid. Assume particles are released on the i − 1 (left) edge. The red lines are pathlines of the analytical solution for these particles. The cyan piecewise linear lines are the solutions to RK4 timestepping with dt = 0.1. The two types of integration lead to similar solutions.

19

426 end has been reached (e.g., Do¨o¨s et al., 2008; van Sebille et al., 2012; Thomas 427 et al., 2015b). This approach thus permits particles to be advected for longer 428 time scales than available from the raw data. However, particle looping can 429 only work if the model has no drift in the velocity or tracer ﬁelds, that there 430 are no large unphysical jumps in the ﬁelds between the end and the beginning 431 of the model run, and that any unphysical jumps will have a small net eﬀect 432 on the particle pathways.
433 3.2.1. Explicit time stepping methods 434 One way to integrate equation (21) is to multiply the velocity at a point 435 by a time step, ∆t, to estimate the displacement. This approach is known as 436 the Euler method and is correct to ﬁrst order in ∆t. Better accuracy of the 437 trajectories can be obtained by using higher-order methods for the integration 438 of Eq (21). One popular method is the 4th order Runge-Kutta scheme (e.g., 439 Butcher, 2016), where information of the (interpolated) velocity ﬁeld at four 440 increments between time steps tn and tn+1 is used. 441 The fourth order Runge-Kutta method is a member of a family of inte442 grators (Dormand and Prince, 1980). One interesting extension is adaptive 443 timestepping through a RK45-method, where both a fourth order and a ﬁfth 444 order integration are performed. The extra computational cost of a ﬁfth 445 order computation is marginal when a fourth order is already performed. The 446 diﬀerence, ∆X = |X5 − X4|, between the ﬁfth order and fourth order solution 447 can be computed. If ∆X is larger than some (pre-chosen) threshold, the time 448 step ∆t of equation (21) can adaptively be reduced for that particle. Doing 449 so then leads to a straightforward implementation of adaptive timestepping 450 using Runge-Kutta integrators. However, it is not a priori clear how the error 451 thresholds for ∆X should be chosen. 452 When working with stored velocity data, as when virtual particle tra453 jectories are computed oﬄine, temporal interpolation is usually required. 454 Interpolation is needed because the interval between consecutive stored ve455 locity ﬁelds is generally longer than the time step, ∆t, used to advance the 456 particle trajectories in equation (21). This temporal interpolation of the 457 velocity ﬁelds can be a large source of error, particularly when the interval 458 with which velocity ﬁelds are stored becomes longer than a few days (e.g 459 Valdivieso Da Costa and Blanke, 2004; Qin et al., 2014).
20

460 3.2.2. Time-implicit discrete integration schemes 461 To determine volume transport pathways, the volume-preservation proper462 ties of numerical integrators becomes an important consideration. Symplectic 463 time integration schemes are one method used to maintain volume conser464 vation for discrete methods. They can be mathematically shown to exactly 465 conserve area in divergence-free 2D ﬁelds, meaning that the area bounded 466 by a set of particles will stay constant over time in the absence of turbulent 467 diﬀusion 10. Symplectic methods for Lagrangian particles in two dimensions 468 take the same form as symplectic integrators for systems of point vortices, but 469 now the velocity is prescribed (Marsden et al., 1999). The disadvantage of 470 these methods is that they are generally implicit in time. Hence, they require 471 iterative methods. For example, the implicit midpoint rule provides a sym472 plectic integrator for the Lagrangian trajectory equation in two dimensions 473 (McLachlan, 1999; Leimkuhler and Reich, 2004). 474 In three dimensions, the concept of symplectic integrators must be ex475 tended to Lie-Poisson integrators for 3D incompressible velocity ﬁelds (McLach476 lan, 1999; Leimkuhler and Reich, 2004). Few 3D symplectic integrators are 477 known, though the implicit midpoint rule is known to be such an integrator 478 and preserves volume in three dimensions.
479 3.2.3. An analytical discrete streamtube method 480 Another volume-preserving method to integrate the trajectory equation 481 (21) takes advantage of the discrete continuity equation. The resulting 482 virtual particle trajectories respect the volume conservation property of 483 an incompressible Boussinesq ﬂuid, and thereby are particularly suited for 484 experiments where the focus is on the advective component of the ﬂow. In 485 brief, this method analytically computes trajectories across grid cells by 486 making use of the gridded velocity ﬁeld located on grid cell faces. This 487 approach approximates streamtubes through the use of volume conservation 488 constraints introduced in Section 2.4. While these methods have their origin 489 in applications with steady-state velocity ﬁelds, and the streamtube approach 490 is formally only applicable to these cases, there is a large community using 491 extended analytical discrete streamtube methods for time-varying ﬂows too.
10See Hairer et al. (2006) for a comprehensive description of symplectic time integration schemes, and Leimkuhler and Reich (2004) for an introduction with applications targeted at scientists and engineers.
21

492 These applications typically achieve very similar results to the explicit time-

493 stepping schemes.

494 Algorithms following this approach calculate trajectories for a given steady-

495 state velocity ﬁeld through analytic computation of three-dimensional stream-

496 tubes (Blanke and Raynaud, 1997). If the velocity ﬁelds are time-evolving, it

497 is possible to sub-sample them into piecewise steady ﬁelds, which are only

498 kept constant in time for a short time; this approach generally increases the

499 computational cost. Another method by de Vries and D¨o¨os (2001) allows

500 for analytical trajectories in a time-dependent case that accounts for ﬂow

501 changes across time steps. Do¨o¨s et al. (2017) showed that the time-dependent

502 trajectory solution is more accurate than the piecewise steady solution, espe-

503 cially in eddying regions, and only at a very small additional computational

504 cost (see also Appendix A.1.2).

505 The analytical calculations are on the scale of a model grid cell for which

506 components of the velocity ﬁeld, or the volume transports, are typically

507 expressed on a staggered C grid (Mesinger and Arakawa, 1976), i.e., are

508 known over the six faces of the cell (see Figure 2).11 The analytical method is

509 enabled by assuming that within a grid cell, the ﬂuid velocity exhibits a linear

510 variation of each velocity component along each corresponding direction, so

511 that

vsubgrid = (u(x), v(y), w(z)).

(22)

512 These subgrid scale velocity components (u(x), v(y), w(z)) are linear functions 513 of their arguments, with the precise form of these functions determined by the 514 known velocity components on the cell faces. This form of the subgrid scale 515 velocity then allows one to write analytical trajectory equations along the 516 three axes across the grid cell. Analytic time integration of these equations 517 binds each coordinate point (x, y, z) in a grid cell to time in the cell. Grid 518 cell crossing times in each of the three directions are evaluated independently 519 by imposing any of the six grid cell sides as a possible ﬁnal position. The 520 minimum crossing time speciﬁes the actual crossing time, and hence the 521 trajectory. This approach then allows for an accurate (within the conﬁnes of 522 the basic assumption of equation (22)) calculation of the ﬁnal position of a

11This method can also be used for A-grid or B-grid stencils, so long as these grids oﬀer conservative volume transport components on tracer cell faces. The use of conservative ﬂux-based transport schemes is a basic property of any ﬁnite volume ocean model, regardless the horizontal grid stencil.

22

523 particle on the relevant exit side of the grid cell. 524 This method for computing volume transport trajectories is both fast and 525 self-consistent. It is fast because it only calculates particle positions on the 526 edge of individual grid cells. It is self-consistent since it respects the local 527 three-dimensional non-divergence of the Boussinesq ﬂow both at the subgrid 528 and the large scale. It therefore provides a judicious method to map volume 529 transport pathways by realizing a discrete implementation of streamtubes 530 introduced in Section 2.4. 531 Streamtube-based volume transport is reversible, so that backward inte532 grations can be performed to track the origin of a given volume. It is for these 533 reasons that practitioners of discrete streamtube methods generally do not 534 introduce diﬀusion (or stochastic noise) when computing particle trajectories. 535 Rather, the method is focused on determining volume transport pathways 536 deﬁned from the resolved or the residual mean ﬂow.
537 3.3. Computing stochastic trajectories to simulate diﬀusion and unresolved 538 physics
539 As noted above, streamtubes track water volume in a steady-state ﬂow. 540 However, in many applications in oceanography, one is interested in tracking 541 tracers such as heat, salt, or nutrients and how they are aﬀected by subgrid 542 scale diﬀusion and unresolved physics such as mixed layer processes and deep 543 convection (e.g. van Sebille et al., 2013). Tracer concentrations can directly be 544 computed from the spreading of a cloud of particles described by Stochastic 545 Diﬀerential Equations (SDEs, see Section 2.5.2), where unresolved physics 546 are represented by stochastic noise. 547 Two main approaches can be distinguished in eﬀorts to add diﬀusion to 548 trajectories. One is to start with the tracer equation (16), where the eddy 549 transport is parameterized in terms of the eddy-induced velocity and the 550 appropriate form of the diﬀusivity tensor in order to derive the SDE for 551 particle trajectories (Section 3.3.1). The second approach (Section 3.3.2) is to 552 use an ‘ad hoc’ SDE where a Markov model is ﬁt to observations from surface 553 drifter trajectories or virtual particles in a much ﬁner resolution velocity ﬁeld. 554 It remains an active area of research under which circumstances (e.g. 555 underlying research question, spatial and temporal model data resolutions) 556 and how exactly stochastic noise representing subgrid scale diﬀusion should 557 be implemented (see also section 3.3.3).
23

558 3.3.1. Stochastic trajectories using the Fokker-Planck equation
559 Here, we provide a brief introduction to the implementation of stochastic 560 terms through the use of a Fokker-Planck Equation. The discussion here 561 makes use of the more thorough discussions provided in the textbooks by 562 Gardiner (1985), Jazwinski (1970), and Kloeden and Platen (1992), as well 563 as the oceanographic review by Visser (2008). Advantages of this Lagrangian 564 SDE approach over Eulerian tracer computations are that it can deal with 565 steep concentration gradients and that tracer concentration can never become 566 negative. 567 A stochastic diﬀerential equation (SDE) for a general trajectory X(t) is 568 given by

dXi (t) = ai (t, X) dt + σik (t, X) dWk(t), X (t0) = X0.

(23)

569 In this equation, Xi (t) are components of the tracer trajectory vector X(t), 570 and dXi (t) = Xi(t + dt) − Xi(t) is the stochastic particle displacement during 571 the time interval [t, t + dt]. The term ai (t, X) is a deterministic drift, whereas 572 σik (t, X) is related to a tracer diﬀusion tensor (see equations (25) and (26) 573 below). Finally, Wk(t) is a Wiener process, or Brownian motion, modelling 574 stochastic ﬂuctuations that represent unresolved motions like eddies, waves 575 or small-scale turbulence. The increment dWk (t) = Wk(t + dt) − Wk(t) is 576 a Gaussian variable with zero mean and variance dt, with non-overlapping 577 increments independent of each other. The stochastic model (23) is Markovian, 578 which means that information on the probability density of the trajectory 579 X(t) at time t is suﬃcient to make predictions at later times. Non-Markovian 580 models require information at earlier times, which is generally impractical. 581 The presence of the Wiener process means that integrating the equation using 582 deterministic calculus does not produce a unique solution. We make use 583 of ideas proposed by Itˆo, who developed a stochastic calculus to produce a 584 unique solution of the SDE (23) 12.

12The Itˆo calculus used here is but one mathematical approach for realizing a unique solution to a SDE (e.g., Gardiner, 1985). Stratonovich and Itoˆ-backward approaches oﬀer alternative stochastic integration methods, and they can also be used to derive stochastic particle models (Gr¨awe et al., 2012; Shah et al., 2011; Spivakovskaya et al., 2007a,b). We focus on the Itˆo calculus as it is well known to physicists, as is the corresponding Fokker-Planck equation. Furthermore, the drift, ai (t, X), of an Itˆo SDE represents the mean of the stochastic particle tracks. Finally, the well known Euler scheme (see equation (28) below) is a straightforward numerical approximation of the Itˆo SDE, whereas this
24

585 A cloud of particles will estimate the probability density P (t, x) for the 586 stochastic tracer trajectories. Use of an Itˆo stochastic process X(t) ensures 587 that the probability density function evolves according to the following Itˆo 588 form of the Fokker-Planck or forward Kolmogorov equation

∂P ∂t = ∂i(ai P ) + ∂ij bij P P (t0, x) = P0(x),

(24)

589 with

2 bij = σik σjk.

(25)

590 We can relate the Fokker-Planck equation (24) to the Boussinesq form of the 591 tracer equation (16), so that13

bij = Kij ai = vi† + ∂jKij P = C.

(26)

592 The corresponding SDE for the trajectory is given by

dXi (t) =

vi†

+

∂Kij ∂xj

dt + σik (t, X) dWk(t),

X(t0) = X0.

(27)

593 It is through this connection that we can derive a stochastic Lagrangian 594 model for any advection-diﬀusion tracer equation. 595 Stochastic tracer trajectories can be generated numerically through discrete 596 approximations to the Itoˆ stochastic diﬀerential equation (Kloeden and Platen, 597 1992). Discretizing the continuous stochastic diﬀerential equation (27) using 598 the Euler scheme leads to

Xi (t + ∆t) = Xi (t) + (vi† + ∂jKij) ∆t + σik (t, X) ∆Wk(t) X(t0) = X0.

(28)

scheme cannot be used to discretize a Stratonovich or an Itˆo-backward SDE. 13The tensor elements σik (t, X) are not uniquely determined by the diﬀusion tensor
K. However, all choices consistent with the relation 2 Kij = σik σjk result in statistically identical diﬀusion processes.

25

599 In this equation, ∆Wk(t) is a Gaussian random variable with zero mean 600 and variance ∆t, generated via a random generator. The accuracy of the 601 Euler scheme is O(∆t1/2) in the strong sense; i.e., for approximating the 602 individual particle trajectories. When used to generate many trajectories 603 in order to approximate the probability distribution, or equivalently the 604 tracer concentration, then the Euler scheme is O(∆t) accurate; i.e. the Euler 605 scheme is O(∆t) in the weak sense. More accurate numerical schemes have 606 been developed, such as in Gr¨awe et al. (2012); Shah et al. (2011, 2013); 607 Spivakovskaya et al. (2005, 2007a,b). 608 There are methods to compute trajectories directly from a SDE for many 609 applications (e.g., Kloeden and Platen, 1992). Trajectory computation di610 rectly from SDEs is less mature in large-scale oceanography where it is often 611 diﬃcult to include a realistic diﬀusion tensor for subgrid scale tracer transport. 612 Appendix B oﬀers an example of tracer trajectories in the presence of an 613 isopycnal diﬀusion tensor with a time-constant diﬀusivity. This application is 614 nontrivial and a major advance in the Lagrangian tracer trajectory method. 615 Unfortunately, it is not fully representative of modern parametrisations for 616 global models, whereby the diﬀusivity is a function of space and time (Aber617 nathey et al., 2013), and the diﬀusivity tensor may be anisotropic in the 618 lateral directions as well as between lateral and vertical (Fox-Kemper et al., 619 2013). 620 Even with a constant isopycnal diﬀusivity, sampling components of the 621 3 × 3 diﬀusion tensor for oﬄine analysis is a nontrivial computational task, 622 particularly in the presence of realistic temporal variability. Additional 623 diﬃculty arises from time variations in the diapycnal diﬀusivity used for 624 planetary boundary layer schemes. Consequently, the current generation 625 of explicit SDEs for tracer trajectories are generally restricted to relatively 626 coarse resolution models with rudimentary subgrid scale parametrisations 627 (e.g., Shah et al., 2017), although eﬀorts are underway to improve this.
628 3.3.2. A hierarchy of Markov models for stochastic trajectories 629 The second approach to adding the eﬀects of diﬀusion and unresolved 630 physics to particles is to ‘ad hoc’ ﬁnd an SDE that matches the statistics - e.g. 631 eddy decorrelation time scales and diﬀusivity - of the stochastic trajectories 632 with either observations or particles simulated in ﬁner-resolution models. This 633 approach has been developed by Griﬀa (1996) and further by Berloﬀ and 634 McWilliams (2003) in the context of ocean models. See also Vallis (2006, 635 sect 10.2) and LaCasce (2008) for discussion, and Veneziani et al. (2004) and
26

636 Koszalka et al. (2013a) for implementations. 637 A hierarchy of Markov models is considered, whereby the stochastic 638 term is added to either particle displacement (zeroth-order Markov model, 639 corresponding to uncorrelated eddy velocity ﬁeld), the particle velocity (ﬁrst640 order model, accounting for correlations of the velocity) or the particle 641 accelerations. In most cases, the ﬁrst-order model is found to best approximate 642 the oceanic mesoscale turbulence introduced by coherent eddies. 643 In the ﬁrst-order Markov model (multiplicative noise), stochastic noise 644 is used to modify the present position of a particle when updating to a new 645 position, in which case the trajectory equation (21) can be written as

t+∆t
X(t + ∆t) = X(t) + (1 + ) v(x, τ ) dτ,

(29)

t

646 where is a random number. Notably, the application of noise in this manner 647 does not ensure that X(t + ∆t) results from time stepping a divergence-free 648 velocity. For that purpose, we consider an alternative approach, whereby we 649 introduce a stochastic divergence-free velocity

t+∆t

X(t + ∆t) = X(t) + [v(x, τ ) + vnoise(x, τ )] dτ.

(30)

t

650 We can ensure ∇ · vnoise = 0 by introducing a stochastic vector streamfunction, 651 so that for each each grid cell we have

vnoise(x) = ∇ ∧ Ψnoise(x).

(31)

652 Since the stochastic velocity remains non-divergent, this approach oﬀers a 653 realisation of stochastic streamtubes in steady-state ﬂows. The choice of 654 either equation (29) or equation (30) depends on the application and will be 655 further discussed in Section 3.3.3. 656 In the zeroth-order Markov model (additive, or random walk, noise), the 657 stochastic noise is added to the particle positions, which is often applied in a 658 rather simple form, by adding an extra term to the trajectory equation (21):

t+∆t

√

X(t + ∆t) = X(t) + v(x, τ ) dτ + R 2K∆t.

t

(32)

27

659 In this equation, R = N (0, 1) is a random number taken from the normal 660 distribution with zero mean and unit variance, and K is a constant tracer 661 diﬀusivity. A major limitation of this model is that, if the drift term is omitted, 662 equation (32) will lead to artiﬁcial accumulation of particles in regions of 663 low diﬀusivity, requiring an enhancement of the random walk model (Hunter 664 et al., 1993; Visser, 1997; Ross and Sharples, 2004; Berloﬀ and McWilliams, 665 2002) 666 A myriad of behaviours can be added to a random walk model for capturing 667 the biological characteristic of Lagrangian particles. Examples include diurnal 668 vertical migration, temperature dependent planktonic larval duration and time 669 to settling competency. While it must be noted that enhanced complexity does 670 not necessarily imply enhanced accuracy, studies have shown that even modest 671 vertical migration velocities can signiﬁcantly alter the dispersal patterns of 672 propagules. For example a recirculation in the Western Irish Sea of northwest 673 Europe, associated with summer stratiﬁcation, retains surface drifters but 674 does not retain vertically migrating organisms (Phelps et al., 2015).
675 3.3.3. When and how to add stochastic terms? 676 In the above, we have described a few methods to incorporate mixing 677 through stochastic terms. However, exactly when and how to implement these 678 terms is an open question. It will likely depend on the temporal and spatial 679 resolution of the velocity ﬁelds, as well as the unresolved processes that the 680 added stochastic components are intended to reproduce. In particular, the 681 consideration should be whether mesoscale coherent eddies and attendant 682 nonlocal transport properties (velocity correlations and steep Eulerian ve683 locity spectra) are resolved by the ocean model velocity ﬁeld underlying the 684 Lagrangian simulations. 685 If a velocity ﬁeld is available at suﬃciently high spatial and temporal 686 resolution, adding a stochastic component may be unnecessary and high 687 numbers of particles may suﬃce (Koszalka et al., 2013b). If the available 688 velocity ﬁeld does not resolve important eddy processes, a ﬁrst-order or second689 order Markov model may need to be used to account for a velocity correlations 690 induced by the mesoscale eddy ﬁeld (Griﬀa, 1996; Berloﬀ and McWilliams, 691 2002; LaCasce, 2008). The applicability of the stochastic simulations should 692 in any case be veriﬁed against existing observations (Koszalka et al., 2013a) 693 or high resolution model simulations, if available. 694 It is also still open how the Fokker-Plank Equation approach (Section 695 3.3.1) and the ad-hoc Markov model approach (Section 3.3.2) can be combined.
28

696 While the ﬁrst approach is more mathematically rigorous, the second provides 697 an insight into the properties of observed or simulated oceanic turbulence 698 on diﬀerent scales and in diﬀerent regions, and may be useful in building 699 future parameterizations of eddy induced transport in terms of Lagrangian 700 stochastic parameterizations. 701 We leave this discussion of diﬀusivity here, as the research and understand702 ing of this issue is rapidly evolving, and strongly encourage the community to 703 gain a better understanding in how best to implement diﬀusion and unresolved 704 physics for Lagrangian particles.
705 3.4. Spatial interpolation
706 The trajectory equation (21) is deﬁned on continuous velocity ﬁelds. 707 However, all ocean models work with discretized grids, where velocities 708 are only known on either vertices or edges of the grid cells (Griﬃes et al., 709 2000). Therefore, computing Lagrangian trajectories from ocean model 710 data requires reconstruction of the continuous velocity ﬁeld inside grid cells. 711 Bilinear, trilinear, or spline interpolation are viable choices on structured 712 grids. Interpolation on unstructured grids can be accomplished via methods 713 derived from particle-based approaches, e.g., inverse-distance weighting or 714 kernel-based convolutions, or unstructured extension of grid-based spatial 715 interpolation, e.g., Wachspress interpolation (Gillette et al., 2012). 716 On grids where velocities are deﬁned on the corners of grids (e.g., Arakawa 717 A and B), the reconstruction choices include weak-form reconstruction (Perot, 718 2000), radial basis functions (Baudisch et al., 2006), or reconstruction via 719 ﬁnite-element basis functions (Wang et al., 2011). On grids where velocities 720 are known on the edges of grid cells (e.g., Arakawa C), this reconstruction is 721 often done using simple linear interpolation, although more work needs to be 722 done investigating what the errors are that arise from this. 723 Horizontal interpolation on arbitrary simplexes from vertex-data is pro724 vided by Wachspress interpolation (Gillette et al., 2012), which is a super725 linear interpolation scheme for arbitrary simplexes. For triangles, Wachspress 726 interpolation is equivalent to barycentric interpolation, which is commonly 727 used on triangular meshes and readily available in scientiﬁc packages (e.g., 728 python-matplotlib). A primary beneﬁt of this approach is that it provides a 729 continuous interpolant, e.g., C0 continuous. Options for higher-order interpo730 lation to obtain Cn (for n > 1) continuity are more complex and less common, 731 particularly on arbitrary unstructured meshes.
29

732 Horizontal interpolation via Wachspress naturally keeps particles within 733 the domain for no-slip conditions where the velocity is zero for boundary points 734 on simplexes. Particles can be constrained to remain within the domain by 735 maintaining CF L < 1, where CF L is the Courant-Friedrichs-Lewy condition 736 (e.g., Durran, 1999). This implementation is intrinsically free of if-statements. 737 However, free-slip boundary conditions require further adaptation. 738 Vertical interpolation choices include linear and spline interpolants. Linear 739 interpolation is a standard approach and is consistent within model accuracy, 740 particularly for ﬁne vertical resolution. Spline interpolation, however, allows 741 representation of vertical curvature, but at the potential cost of artiﬁcial 742 maxima and minima. 743 Particle tracking can employ a spatially-decoupled advection strategy by 744 splitting horizontal and vertical integration steps into sequential operations. 745 The beneﬁt of this approach is that it decouples unstructured interpolants 746 in the horizontal from one-dimensional interpolation in the vertical and 747 allows diﬀerent particle behaviours to be employed. For example, vertical 748 interpolation of velocities to speciﬁc potential density surfaces allows particles 749 to be advected isopycnally and avoid diapycnal mixing that can occur with 750 neutrally buoyant particle advection (Wolfram et al., 2015).
751 3.5. Available tools
752 As discussed throughout this section, it is in principle straightforward 753 to compute Lagrangian particle trajectories by time stepping the trajectory 754 equation (21). One merely needs to save the velocity ﬁeld and update 755 the trajectories using available software like Matlab or Python, invoking 756 either rudimentary schemes or built-in functions such as the Matlab ode 757 suite. Several research groups have developed their own virtual particle codes 758 tailored to speciﬁc model output format, model grid and boundary conditions. 759 Examples include a 3D Lagrangian Matlab code for the MITgcm used by 760 Koszalka et al. (2013b) and von Appen et al. (2014) and a 2D Matlab code 761 of The Nonlinear Dynamical Systems Group at ETH Zurich (Farazmand and 762 Haller, 2012, http://georgehaller.com/software/software.html). 763 However, signiﬁcantly more eﬀort is required to develop an analysis code 764 that features a user-friendly interface and thus can be utilized across the mod765 elling communities. Further work is needed to ensure that the code is eﬃcient 766 on data Input/Output. The suite of available tools can roughly be separated 767 into two sets. First, there are large community based Lagrangian codes such 768 as Ariane, TRACMASS, the Connectivity Modelling System (CMS), and
30

769 the new Parcels code. These are model-independent, run oﬄine (i.e., on 770 stored velocity data) and provide extensive control on particle behaviour. The 771 second set includes Lagrangian codes tied to (and sometimes distributed with) 772 speciﬁc models, such as MITgcm, HYCOM, NEMO, ROMS and MPAS-O. 773 These model-speciﬁc codes can be run online (i.e., during the computation of 774 the velocity data). 775 Examples from both types of codes are discussed in appendix A. These 776 codes are also summarised in Table 1 and 2. Notably, all of these codes 777 employ either explicit or implicit time integration of volume transports and 778 while some can incorporate additional random terms (Section 3.3.2), there 779 are no community codes available for computing tracer trajectories through 780 the SDE-based methods of section 3.3.1.

781 4. Applications of Lagrangian particle trajectories
782 For most applications, the raw particle trajectories output by Lagrangian 783 analysis codes need to be further processed to help answer scientiﬁc questions. 784 In this section, we overview ways in which Lagrangian particle trajectories 785 can be used and analysed to improve our understanding of ocean circulation 786 and dynamics.

787 4.1. Dispersion and diﬀusivity
788 The ensemble particle dispersion and its rate of change, the diﬀusivity, 789 are the fundamental Lagrangian diagnostics of use for understanding tracer 790 transport in oceanic ﬂows. Particle trajectories can be used to diagnose eddy 791 diﬀusivity via single, pair, and cluster techniques. The detailed theoretical 792 and practical underpinnings of these techniques in the context of oceanic 793 ﬂows are summarized by LaCasce (2008); here we reiterate the main points. 794 The single-particle diﬀusivity stems from the seminal work of Taylor 795 (1921). It quantiﬁes the ensemble-mean rate of particle dispersion from an 796 initial location, so that we have

κ(t) ≡ 1 d X2(t) = V (t) · X(t) =

t
V (t) · V (τ ) dτ.

2 dt 0

(33)

797 In this equation, X(t) is the Lagrangian virtual particle trajectory, and 798 V (t) = dX(t)/dt is the Lagrangian particle velocity.

31

Code name Website License Key citation OGCMs supported Language(s) Primary use
Advection method Diﬀusion method Grids supported
Key strengths
Shortcomings

Ariane
www.univbrest.fr/lpo/ariane
CeCILL (http://www.cecill.info)
Blanke and Raynaud (1997); Blanke et al. (1999)
NEMO/OPA, ROMS, Symphonie and any Cgrid
Fortran 90/95; Matlab (IDL on request) for visualisation
Oﬄine calculation of 3D streamlines in the velocity ﬁeld at any scale (regional, basin, global); volume transport calculations
Analytic
No diﬀusion (purely kinematic method)
Arakawa C, also tested with Arakawa B interpolated on C-grid, partial cells supported
Almost 25 years of experience with core of the code; easy-to-install, easyto-use; fast analytical solution; no coast crash; qualitative mode (full details of selected trajectories) and quantitative mode (volume transport calculations); compatible with the conservation laws of the OGCM
No parallel mode; trajectory scheme is somewhat crude beyond the context of 3D water mass tracing

TRACMASS tracmass.org
open source
D¨o¨os et al. (2017)
NEMO, IFS (AGCM), MOM, MICOM, POM, HYCOM
Fortran
3D water mass pathways, particle/tracer dispersion
Analytic
Brownian motion for background diﬀusion with random displacement or randomly added velocities Arakawa A, B, C. Spatially and temporally varying vertical grids supported (partial cells, z*, sigma, hybrid) including those for AGCMs Volume conserving, fast analytical solutions without intermediate time steps, works with both OGCMs and AGCMs
Need of improving the diﬀusion method

Octopus

LAMTA

CMS

bit- github.com/beatrixparis/

github.com/jinbow/Octopus bucket.org/f nencio/spasso/ connectivity-modeling-

overview

system

MIT

GNU General Public License

GNU GPL v3

Wang et al. (2016a)

d’Ovidio et al. (2015)

Paris et al. (2013b)

Parcels oceanparcels.org
MIT
Lange and van Sebille (2017)

MITgcm; any C-grid Fortran

AVISO satellite velocities; any velocity ﬁeld on A-grids (euclidean or spherical)
GNU/Octave and C++

HYCOM, OFES, NEMO, SOSE, MOM, MITgcm
Fortran

NEMO, OFES, GlobCurrent; customizable to any OGCM with NetCDF data format
Python user interface, auto-generated C

3D watermass pathway, particle/tracer dispersion, cross-frontal transport, Argo ﬂoat simulation
RK4

Compute satellite based Lagrangian diagnostics to optimize sampling strategy of mesoscalebased ﬁeld campaign and support interpretation of in-situ observations
RK4

Brownian motion for background diﬀusion, random displacement within the mixed layer
Arakawa C

Random walk optional Arakawa A

Dispersion, connectivity, fate of pollutants; Individual Based Modelling

Large scale oceanography; Individual Based Modelling; teaching (via customizable interface)

RK4
Brownian motion for background diﬀusion, random displacement within the mixed layer Ortholonal (rectangular) Arakawa A, B and C

RK4, RK45, Explicit Euler; extensible interface for custom advection methods
Extensible interface for Random Walk and custom behaviour
Arakawa A, B and C; unstructured meshes planned

Fast using Fortran, supports openMP
Non-scalable parallelization, not very eﬃcient in reading large model output

Designed to work outof-the-box with AVISO surface geostrophic velocities. Already conﬁgured to compute a broad range of Lagrangian diagnostics (i.e. Finite Time/Size Lyapunov Exponents; longitudinal and latitudinal origin of particles; time of particle retention within mesoscale eddies etc.)
Particle advection only 2D; cannot be run in parallel.

Modular, fast, parallel; Multi-grid support; Used in a wide variety of contexts, from marine ecology to physical oceanography
No support for nonorthogonal grids; parallel implementation is heavy on I/O

Ease-of-use, customizable extension interface and automated performance optimization
Not yet parallel; support for unstructured meshes in progress

32

Table 1: Summary of the speciﬁcations of the oﬄine Lagrangian codes discussed appendix A

Code name Website License
Key citation OGCMs supported Language(s) Primary use
Advection method
Diﬀusion method Grids supported Key strengths
Shortcomings

LIGHT in MPAS-O
mpas-dev.github.io
Copyright (c) 2013, Los Alamos National Security, LLC (LANS) and the University Corporation for Atmospheric Research (UCAR).
Wolfram et al. (2015)
Model for Prediction Across Scales Ocean (MPAS-O) (Ringler et al., 2013)
Fortran (post-processing in python)
Large scale oceanography, diagnosing ocean mixing
Sub-stepped generalized RK for time integration; Wachspress and RBF horizontal interpolation; linear vertical and temporal interpolation
None
Unstructured C-grid
Fast (minimal cost to OGCM), high temporal and spatial ﬁdelity, computes isopycnal advection by construction, extensible within Fortran framework
Currently no explicit oﬄine mode, tied to MPAS framework and presently embedded in MPAS-O

NEMO online ﬂoats and icebergs
nemo-ocean.eu/AboutNEMO/Referencemanuals
CeCILL (http://www.cecill.info)

MITgcm mitgcm.org None

Madec and NEMO team (2016) for ﬂoats; Marsh et al. (2015) for icebergs
NEMO

Marshall et al. (1997a) MITgcm

Fortran

Fortran

Floats: large-scale, eddying ocean circulation. Icebergs: coupling of iceberg ﬂuxes with ocean physics and dynamics and sea ice, via heat, freshwater and momentum ﬂuxes; evaluating/forecasting iceberg hazard
Floats: Ariane method or RK4. Icebergs: RK4

Ocean modelling at all scales, oﬄine advection
RK4

None

Brownian motion optional

Arakawa C
Floats: Analytical advection on model timestep resolution. Icebergs: freshwater ﬂux due to melting icebergs

Arakawa C
Works well with archived MITgcm velocity ﬁelds, scales to very large sizes using MPI and domain tiling

Floats: limited use/publications to date. Icebergs: physics and dynamics subject to several uncertain parameters; giant tabular icebergs not yet represented; interactions with sea ice currently limited

Complicated to set up

HYCOM Float Package hycom.org
None
Halliwell and Garraﬀo (2002); Garraﬀo et al. (2001a,b) Hybrid Coordinate Ocean Model (HYCOM) (Bleck, 2002; Chassignet et al., 2003, 2006) Fortran Large scale and coastal oceanography, biology
RK4
Brownian motion optional Arakawa C Stable and relatively easy to use and understand
No parallel mode

ROMS online ﬂoats
myroms.org/wiki/ﬂoats.in
Open source MIT/X
Pin˜ones et al. (2011); Narvaez et al. (2012b)
ROMS
Fortran
Coastal and mesoscale oceanography, Individual Based modeling for biophysical applications
4th-order Milne predictor and 4th-order Hamming corrector
Vertical random walk optional Arakawa C Reliable since trajectories are coherent with ocean circulation, parallel, easy to set up
Computationally expensive since no oﬄine model is available; Large output ﬁles for long runs or many particles.

33

Table 2: Summary of the speciﬁcations of the online Lagrangian codes discussed appendix A

799 The Taylor formulation pertains to homogeneous, stationary and isotropic 800 ﬂows, and is non-trivial to apply in practice. Diﬀerent approaches to esti801 mation of single-particle statistics for particles deployed in stationary and 802 homogeneous Eulerian ﬂows, with cautious notes on particle deployment 803 strategies and transient behavior, are discussed by Davis (1982) in the context 804 of numerical simulations. For modelled ocean ﬂows of realistic complexity, 805 the estimation of single-particle statistics must be further reﬁned to account 806 for non-stationarity and inhomogeneities of the underlying Eulerian ﬁeld 807 (Davis, 1983, 1985, 1987, 1991). Under the assumption that the velocity ﬁeld 808 is slowly-varying with respect to the time increment dt (in practice, dt can 809 be the time step of a Lagrangian model) this assumption can be satisﬁed by 810 segmentation of trajectories over a relevant time scale (e.g., seasonal cycle, 811 the velocity decorrelation time scale), and segregation in space into locally 812 homogeneous regions (Davis, 1991; Koszalka and LaCasce, 2010, see also sect. 813 4.3). 814 If the focus is on the transport by mesoscale turbulent ﬂows (‘eddy 815 diﬀusivity’), an appropriate technique for ‘the mean (or slowly-varying) ﬂow 816 removal’ must be applied to the Lagrangian velocity in equation (33) (e.g., 817 Berloﬀ et al., 2002; Rypina et al., 2012; Lumpkin and Johnson, 2013). The 818 Lagrangian transport anisotropy can be quantiﬁed by using the concept 819 of tensor diﬀusivity (where equation (33) applies to the diﬀerent velocity 820 vector components) and projection of the ﬂow in the along- and across-ﬂow 821 directions of maximum dispersion (Rypina et al., 2011, 2012; Fox-Kemper 822 et al., 2013; Kamenkovich et al., 2015; Wolfram et al., 2015). In general, 823 anisotropy of the Lagrangian transport arises from spatio-temporal patterns 824 and velocity correlations due to eddies. A signiﬁcant challenge is that the 825 observed Lagrangian particle dispersion is often non-diﬀusive on long time 826 scales (e.g., Rypina et al., 2012) due to persistent Lagrangian ﬂow correlations. 827 Double-particle statistics builds upon the works of Batchelor (1952) and 828 Bennett (1987). The relative diﬀusivity (the time rate of the mean square 829 pair separation) is

κR(t)

≡

1 2

d dt

r2(t)

1d =
2 dt

X(m)(t) − X(n)(t) 2 ,

m=n

(34)

830 where the sum is over all pairs of particles (m, n). At times longer than 831 the velocity decorrelation time scale, the pair particles move independently 832 from one another, and the relative diﬀusivity is constant at twice the single

34

833 particle diﬀusivity (LaCasce, 2008). Using the relative diﬀusivity rectiﬁes 834 the problem of the time-mean ﬂow removal by measuring particle relative 835 separation, though it will still be inﬂuenced by the mean ﬂow shear. In 836 practice, double-particle statistics are often implemented in terms of cluster 837 or moment methods which are equivalent to double-particle statistics on the 838 plane (LaCasce, 2008). 839 The single- and double-particle diagnostics derived from simulated trajec840 tories may be used for the following.
841 • Quantifying the advection by the turbulent mesoscale ﬂows (eddy dif842 fusivity) in eddying models as a function of time and separation, for 843 example for parameterisations of diﬀusive processes in models that do 844 not resolve eddies (Poje et al., 2010).
845 • Eddy diﬀusivity maps obtained by binning (see Section 4.3) quantify 846 regional variability in eddy diﬀusivity and other derived statistics (eddy 847 length, time scales; e.g., LaCasce et al., 2014; Griesel et al., 2014, 2015).
848 • Investigating the nature of the oceanic turbulent transport. The relative 849 diﬀusivity as a function of particle separation is related to the Eulerian 850 kinetic energy spectra. Together with the FSLEs (see Section 4.2), the 851 relative velocity diagnostics and the pair displacement PDFs can be 852 used to check for consistency with quasigeostrophic turbulence, chaotic 853 advection, and mean shear (LaCasce, 2008; Koszalka et al., 2009).
854 4.2. Lagrangian Coherent Structures 855 The ocean is full of eddies, jets and other coherent structures, which 856 are visible in ocean tracers such as temperature or chlorophyll. The ﬁeld 857 of Lagrangian Coherent Structures (LCS) aims to identify the kinematic 858 skeleton of such objects based on the Lagrangian trajectories of the ﬂuid and 859 to study the role of these structures in transport. Here we provide a very 860 brief introduction and overview of the ﬁeld and refer the interested reader to 861 the more comprehensive review articles on the topic (e.g. Peacock and Dabiri, 862 2010; Peacock and Haller, 2013; Haller, 2015). 863 The most developed branch of LCS theory is concerned with identifying 864 distinguished material surfaces which serve as the boundaries of coherent 865 regions in unsteady ﬂows. According to Haller (2015), a method for identifying 866 such surfaces must (a) be objective (i.e. gives the same result in all observer
35

Figure 3: Backward Finite Size Lyapunov Exponents for January 1 2013 computed as in d’Ovidio et al. (2004), with initial separation distance of 0.01◦ and ﬁnal separation distance of 1◦. The FSLE have been computed using surface absolute geostrophic velocities
produced by Ssalto/Duacs and distributed by AVISO, with support from CNES (delayed time, all satellite merged product). Ridges of FSLE (≥ 0.3) are overlaid on Multi-scale
Ultra-high Resolution (MUR) Sea Surface Temperature (http://mur.jpl.nasa.gov/), showing
good correspondence between the Lagrangian coherent structures and the distribution of
the surface tracer advected by the Agulhas current, the Agulhas retroﬂection and their
associated mesoscale activity.

867 reference frames), (b) be applicable over a ﬁnite time interval, (c) describe an

868 actual material surface, and (d) converge with respect to spatial resolution.

869 Many diﬀerent LCS diagnostics have been developed to detect diﬀerent

870 types of structures. A starting point in many LCS identiﬁcation methods, 871 however, is the ﬁnite-time ﬂow map Ftt0(x0), which gives the positions at 872 time t of particles initially located at x0 at time t0. The ﬂow map can only
873 be calculated by numerically advecting a large ensemble of closely spaced

874 Lagrangian particles. From this ﬂow map, one can compute the Cauchy Green
875 Strain Tensor C(x0) = [∇Ftt0(x0)]T ∇Ftt0(x0), which measures the magnitude 876 of the growth in separation of inﬁnitesimal perturbations in the initial position

877 space. C is characterised by its eigenvalues λ and corresponding eigenvectors.

878 The original diagnostic of LCSs is the Finite Time Lyapunov Exponent

879 (FTLE). The FTLE is a measure of the exponential rate of separation of

880 trajectories of inﬁnitesimally close initial points over a ﬁnite-time interval

881 and is given by

1 F T LE(x0, t0, τ ) = τ ln λmax

(35)

882 with λmax the maximum eigenvalue of C over the chosen ﬁnite integration

36

883 time τ = t − t0. Early applications of the FTLE were to distinguish regions of 884 high and low predictability in chaotic ﬂows (FTLE; Pierrehumbert and Yang, 885 1993; Artale et al., 1997). Later, FTLE ﬁelds were applied to the identiﬁcation 886 of attracting and repelling transport barriers (Haller and Yuan, 2000; Lapeyre, 887 2002). The ridges (i.e. curves of local maxima) of the FTLE ﬁeld correspond 888 with repelling LCS positions at t0; as regions of extreme local stretching, 889 these structures represent material barriers which remain coherent under 890 advection (unlike general material lines). Attracting LCSs, which represent 891 the Lagrangian skeleton of tracer ﬁlaments, can similarly be obtained as ridges 892 of the FTLE ﬁeld calculated from a backward time integration. Haller and 893 Sapsis (2011) review diﬀerent strategies for calculating attracting and repelling 894 LCSs from forward- and backward-time FTLEs. A related diagnostic is the 895 Finite Size Lyapunov Exponent (FSLE; Aurell et al., 1997), which represents 896 the time required for particle separation to reach a speciﬁed size (Figure 3). 897 FSLEs have also been used widely for LCS identiﬁcation and can be related to 898 the statistics of turbulent dispersion (LaCasce, 2008). However, Karrasch and 899 Haller (2013) proved that FSLE and FTLE ridges do not coincide in general 900 and argued that FSLEs were less reliable for the identiﬁcation of LCSs. 901 The statistics of FTLE and FSLE based on ﬂow maps constructed from 902 Lagrangian particle trajectories have been applied to characterize regimes of 903 dispersion and regional diﬀerences in mixing (Drijfhout et al., 2003; Waugh 904 and Abraham, 2008; Haza et al., 2010; Lumpkin and Elipot, 2010; Schroeder 905 et al., 2011; Poje et al., 2014). Instantaneous maps of FTLE and FSLE derived 906 from satellite altimetric velocities have also been used to identify LCS positions 907 in the ocean (d’Ovidio et al., 2004; Olascoaga et al., 2006; Lehahn et al., 908 2007; Beron Vera et al., 2008). Attracting LCS represent transport barriers, 909 and indeed several studies have conﬁrmed the tight correlation between 910 the detected structures and fronts of advected tracers including sea surface 911 temperature (Abraham and Bowen, 2002; d’Ovidio et al., 2009), chlorophyll 912 concentrations (Lehahn et al., 2007), oxygen (Bettencourt et al., 2015), oil 913 spills (Mezi´c et al., 2010), and even diﬀerent dominant phytoplanktonic types 914 (d’Ovidio et al., 2010). 915 Not all coherent structures relevant for transport can reliably be deduced 916 from the FTLE or FSLE ﬁelds. Over the past decade, LCS detection methods 917 have developed increasing precision at discriminating diﬀerent ﬂavours of 918 structure geometry, resulting in a proliferation of techniques (Haller, 2015). 919 Haller and Beron-Vera (2012) used a variational approach to ﬁnd the least920 stretching material lines in the forward and backward ﬂow maps; the initial
37

921 positions of these lines (called hyperbolic LCSs) can be identiﬁed as the 922 geodesic curves of a Riemannian metric related to the Cauchy-Green strain 923 tensor. Deﬁnitions of parabolic and elliptic LCSs, corresponding to jet cores 924 and vortex boundaries, can similarly be made using the tools of diﬀerential 925 geometry (Haller and Beron-Vera, 2013; Haller, 2015). Additional methods for 926 vortex identiﬁcation based on dynamic polar decomposition and Lagrangian927 averaged vorticity deviation have recently been proposed (Haller, 2016; Haller 928 et al., 2016), while yet a diﬀerent class of methods identiﬁes LCS based on a 929 probabilistic transfer function (Froyland et al., 2007). A much needed critical 930 comparison of diﬀerent methods and their performance in diﬀerent test cases 931 was recently undertaken by Hadjighasem et al. (2017), which provides valuable 932 practical advice for researchers wishing to implement these techniques. 933 A central preoccupation of LCS techniques is the identiﬁcation of coherent 934 mesoscale eddies. Beron-Vera et al. (2013) used the elliptic LCS framework to 935 identify materially coherent Agulhas rings, emphasizing the advantages over 936 Eulerian eddy-identiﬁcation methods, while Froyland et al. (2012) applied 937 the transfer function method to the same region. Wang et al. (2016b) and 938 Froyland et al. (2015) used the identiﬁed structures to study the transport, 939 origin, and decay of Agulhas ring waters. Abernathey and Haller (2017) used 940 the Lagrangian-averaged vorticity deviation method of Haller et al. (2016) 941 to identify eddies in the eastern Paciﬁc and quantify their role in meridional 942 dispersion. These studies illustrate the value of LCS methods for questions of 943 long-range material transport.
944 4.3. Probability distributions
945 A common way to visualize trajectory data is to bin particle positions into 946 histograms. The result is a map of particle density which, when normalised by 947 the total number of particle positions, yields a probability map. Alternatively 948 we can produce probability maps by counting the visit of a particular particle 949 only once per bin and then normalizing by the total number of particles 950 (instead of the total number of particle positions, e.g., van Sebille et al., 2012; 951 von Appen et al., 2014). Both methods oﬀer a useful means to identify ﬂow 952 structure through particle pathways from a set of release points. 953 Figure 4 illustrates the use of both methods for studying the ﬂow re954 sponsible for the spreading of particles originating in the Agulhas Current. 955 Figure 4a shows the probability derived from the procedure described at 956 ﬁrst. Obviously, bins located within the areas of the Agulhas Current (AC), 957 the Agulhas Return Current (ARC), and the Agulhas Ring corridor show
38

Figure 4: Lagrangian modelling approach to determine pathways of particles released in the Agulhas Current at 32◦S (blue line extending east from Southeast Africa), based on a set of 5-year long trajectories initialized in the year 2000 (some examples visualized as black lines): a) Probability with that a 1◦x1◦ bin spanning the whole depth range is occupied by a particle during the considered time span. The probability for each bin has been obtained by counting the number of particles occupying this bin at each time step, summing up this particle counts over the whole integration period and then dividing it by the total number of recorded particle counts for all bins. Thus, the sum of the probabilities of all bins yields 100%; b) Probability that a particle occupies a particular bin at least once during the considered time span. In this case the probability for each bin has been obtained by counting the number of diﬀerent particles occupying this bin and dividing by the total number of particles. Thus, the probability for each bin can range between 0 and 100%. The Lagrangian analysis was performed with the ARIANE tool using the 3D 5day-mean velocity ﬁelds from the high-resolution model INALT01 (Durgadoo et al., 2013).
39

958 the highest probabilities, highlighting the most probable spreading pathways 959 along the major currents and via mesoscale eddies. But even between the 960 AC and ARC there is a region with comparable particle position counts. 961 Figure 4b reveals that this is not due to a particularly strong circulation 962 feature transporting many particles, but rather due to the recirculation of 963 fewer particles. 964 One consideration in the choice of bin resolution is aliasing. If either the 965 grid resolution is too ﬁne or the period of particle position updates is too long, 966 trajectories may pass through more than one histogram bin within a given 967 output time step and thus may not be adequately accounted for. The density 968 maps from binning can also be scaled to account for the residence time in 969 bins and the time step of the Lagrangian simulation. One practice is to scale 970 the particle density maps by the time step dt to obtain the density maps in 971 units of days (e.g., Koszalka et al., 2011). Another is to scale the particle 972 densities in bins with the integral Lagrangian time scale, TL, yielding particle 973 distributions in bins in terms of the ‘number of independent observations’: 974 Nind = N/ T /TL, where T is the total time (e.g., Koszalka and LaCasce, 975 2010). 976 Apart from using particle density maps to assess the water mass path977 ways and connectivity, binning of particle positions and their corresponding 978 properties allows the investigation of mean properties (temperature, density) 979 and their changes along simulated trajectories (e.g., van Sebille et al., 2014). 980 Binning Lagrangian velocities to test the Gaussianity of their distributions 981 and other velocity statistics is yet another application (LaCasce, 2005). The 982 binning is also used to construct maps of eddy diﬀusivity from particle sim983 ulations in high resolution models (e.g., LaCasce et al., 2014; Griesel et al., 984 2014, 2015). Using binning to estimate spatially-dependent eddy diﬀusivities 985 (‘pseudo-Eulerian eddy diﬀusivity maps’) and other parameters (maps of eddy 986 time and length scales) has been widely used in observational Lagrangian 987 analysis (Bauer et al., 2002; Koszalka et al., 2011; Rypina et al., 2012; Lump988 kin and Johnson, 2013; Zhurbas, 2004), as well as in particle simulations in 989 eddy–resolving models (e.g., Berloﬀ et al., 2002; LaCasce et al., 2014; Griesel 990 et al., 2014, 2015) 991 Binning can be used to verify the spreading of Lagrangian particles by 992 comparing the ensemble particle movement with large-scale distributions of 993 either conserved quantities, such as potential vorticity, or a tracer ﬁeld whose 994 evolution is explicitly computed online in the OGCM (e.g., Gary et al., 2012)). 995 Such evaluations can be statistically formalised using pointwise correlation
40

Figure 5: Example transit time distribution for particles released in the Agulhas Current at 32◦S (blue lines in Figures 4 and 6, extending east from Southeast Africa) in the year 2000 and traced towards the GoodHope line (red line in Figure 6).The Lagrangian analysis was performed with the ARIANE tool using the 3D 5day-mean velocity ﬁelds from the high-resolution model INALT01 (Durgadoo et al., 2013).
996 between the binned histogram and the online tracer (Simons et al., 2013). 997 Binning is not limited to spatial boxes as particles can be binned by 998 virtually any variable that can be determined along a particle’s path: for 999 example depth, time, density, temperature, salinity, etc. This sort of binning 1000 can be useful to highlight along-pathway water mass transformations (e.g., 1001 Koszalka et al., 2013b; Iudicone et al., 2011; Gary et al., 2014; van Sebille 1002 et al., 2014). Particles can also be binned by the distance from the deployment 1003 site. Such a distance metric can be redeﬁned to account for the topographic 1004 steering (Davis, 1998). Finally, an alternative to binning was proposed by 1005 Koszalka and LaCasce (2010). Rather than grouping the Lagrangian data in 1006 bins of ﬁxed size, they grouped a ﬁxed number of nearest-neighbor particle 1007 positions together using a clustering algorithm.
1008 4.4. Water mass ages and transit times 1009 The ‘age’ of ocean water, or the time taken for water to transit between 1010 deﬁned regions or reservoirs, is a property of the ﬂow that provides useful 1011 understanding of the ocean circulation (Deleersnijder et al., 2001). Such a 1012 metric can be easily derived from Lagrangian calculations by determining the 1013 transit time of particles. Since the age of water can also be recovered from
41

1014 ﬂoat trajectories or observations of chemical tracers (Fine et al., 2002; Waugh 1015 et al., 2004), there is the possibility to use the age to evaluate model results 1016 in comparison to observations. However, this comparison requires careful 1017 interpretation (Khatiwala et al., 2001) and has been rare (e.g. Haines et al., 1018 1999). 1019 The age of a parcel of ocean water, described by numerous particle trajec1020 tories, is not unique, since diﬀerent particles may transit between two regions 1021 by distinct pathways, travelling for diﬀerent lengths of time (Phelps et al., 1022 2013). As such, the age of ocean water is in fact a probability distribution: 1023 the transit time distribution (TTD) that an individual particle might take to 1024 travel between the two regions (Holzer and Hall, 2000; Deleersnijder et al., 1025 2001; Haine and Hall, 2002). Given a suﬃcient number of Lagrangian tra1026 jectories, a TTD between two regions can be formed from a histogram of 1027 the particle ages (see Figure 5 for an example in the Agulhas region). In 1028 Lagrangian ocean analysis, the range, maximum or variance of this TTD is 1029 used to understand the inherent timescales of the circulation (e.g. Ru¨hs et al., 1030 2013). However, transit time distributions are highly sensitive to the spatial 1031 scales resolved by the numerical model from which Lagrangian trajectories 1032 are determined. 1033 In Lagrangian analyses, the ‘age’ can be evaluated as the time since a 1034 particle was last within the surface ocean (the ventilation timescale), in 1035 which case it reveals the timescales on which the ocean interacts with the 1036 atmosphere, and inﬂuences global climate. This method has been considered 1037 for the global ocean (Blanke and Speich, 2002) as well as speciﬁc water 1038 masses (Koch-Larrouy et al., 2010). In regional seas (with riverine forcing) an 1039 analogue to ventilation with the atmosphere is freshwater age (Phelps et al., 1040 2013). One diﬃculty is that the ventilation timescale of deep ocean ﬂows 1041 (which can be on the order of thousands of years) often exceeds the length of 1042 available OGCM output such that the velocity ﬁelds must to be ‘looped’ to 1043 calculate the full TTD (see also section 3.2). 1044 By considering the entry and exit of particles from an enclosed region, 1045 transit times can be interpreted as a residence timescale. For a marginal sea 1046 with one point of exchange, such as the Baltic Sea, this has been used as an 1047 alternative to the classic box model approach (Do¨o¨s et al., 2004; Jo¨nsson et al., 1048 2004). Where there are multiple points of exchange, such as the Arctic Ocean, 1049 the approach determines the timescales on which these gateways interact 1050 (Lique et al., 2010). 1051 Lagrangian transit times are also used to evaluate the timescales on
42

1052 which anomalies in a certain region would inﬂuence the ﬂow downstream 1053 (e.g., Speich et al., 2001; van Sebille et al., 2011; Ru¨hs et al., 2013), or to 1054 determine time-integrated properties of speciﬁc ﬂows, such as the average 1055 speed (Koszalka et al., 2013c) or the most rapid pathways (Gary et al., 2012).
1056 4.5. Volume transport and Lagrangian streamfunctions
1057 Among the ﬁrst uses of basin-scale Lagrangian particle tracking was 1058 to assess seawater volume transports between chosen sites in the ocean, 1059 resulting in an eﬀective way of quantifying Lagrangian connectivity. In these 1060 applications, each particle is ‘tagged’ with a transport upon release, and 1061 that transport is then conserved along the trajectory as per the streamtube 1062 discussion in Section 2.4. We can construct volume transport pathways by 1063 summing the transports of particles that connect two regions (see Figure 6 1064 for an illustrative example). 1065 Just like in the Eulerian framework, the concept of volume conservation 1066 (as in a Boussinesq ﬂuid discussed in Section 2.4) can be used to ‘collapse’ the 1067 full three-dimensional transport into a two-dimensional streamfunction. The 1068 unique feature in Lagrangian streamfunctions is that they can be constructed 1069 for only that part of the ﬂow that connects the section where particles are 1070 released and where they are received. This concept has been applied to 1071 study for example the cold and warm water routes into the Atlantic (Speich 1072 et al., 2001, 2002; Drijfhout et al., 2003), Agulhas leakage (Durgadoo et al., 1073 2017), the Paciﬁc-to-Indian Ocean connectivity (van Sebille et al., 2014), the 1074 Lagrangian decomposition of the Deacon Cell (D¨o¨os et al., 2008), and the 1075 Atlantic MOC (Thomas et al., 2015b). 1076 The concept of Lagrangian streamfunctions was introduced by Blanke 1077 et al. (1999) and is closely tied to the analytical integration method (Section 1078 3.2.3). Consider a domain with open boundaries, such as the Agulhas region 1079 around South Africa. Trajectories are initialized along the boundaries of 1080 a control volume (box in Figure 6), and traced until they again reach the 1081 boundaries. Each trajectory is associated with a volume transport, and the 1082 volume transport is recorded at each grid-wall crossing of a trajectory. This 1083 method results in a non-divergent ﬁeld of volume ﬂuxes through all grid walls 1084 that can be integrated to Lagrangian streamfunctions. It is to be noted that 1085 this streamfunction represents the mean ﬂow during the whole integration 1086 period, i.e. ideally until all trajectories have left the box. 1087 Both Do¨o¨s et al. (2008) and Kjellsson and Do¨o¨s (2012a) showed that the 1088 total Lagrangian streamfunction is almost identical to the Eulerian stream-
43

Figure 6: Quantitative Lagrangian modelling approach to determine Agulhas Leakage: a) Time series of the annual Agulhas Current (AC) transport at 32◦S, where particles were released continuously proportional to the current volume transport, each particle associated with a fraction of this transport; b) Snapshot (18-Apr-2000) of current speed at 450m depth in the Agulhas region (colour shading, in cm/s), as well as the horizontal Lagrangian streamfunction (contours, in Sv) for all trajectories initialized in the year 2000 and traced along 3D streamlines towards the control sections (black and red lines); c) Time series of annual Agulhas Leakage (AL) transport, obtained by considering for each release year only the transports of those trajectories, that cross the approximated GoodHope section (red lines) within 5 years. The Lagrangian analysis was performed with the ARIANE tool using the 3D 5day-mean velocity ﬁelds from the high-resolution model INALT01 (Durgadoo et al., 2013).
44

1089 function. One of the main diﬀerences is that the Lagrangian streamfunction 1090 is based on trajectories with varying residence times ranging from hours 1091 to months or even years, while Eulerian streamfunctions are snapshots or 1092 time-averages.
1093 4.6. Biological connectivity
1094 Lagrangian particle trajectories can be used to study how water moves 1095 around in the ocean. Additionally, Lagrangian particles can be interpreted as 1096 passively drifting (biological) particulates. Many marine organisms reproduce 1097 with larvae that are dispersed at the whim of the currents. Hydrodynamic 1098 connectivity therefore has important implications for population dynamics 1099 (e.g., Kool et al., 2013; Thomas et al., 2014). In particular, this connectivity 1100 generally allows for longer dispersal and more rapid range expansion than is 1101 observed in terrestrial species (Kinlan and Gaines, 2003), as well as directly 1102 creating range limits (Gaylord and Gaines, 2000). Understanding these 1103 processes and their implications is important for a range of management 1104 objectives. 1105 Transport models have provided insights in varied contexts including 1106 the creation of robust networks of Marine Protected Areas (Gaines et al., 1107 2003; Berglund et al., 2012; Burgess et al., 2014), conservation of coral reefs 1108 (Treml et al., 2008; Wood et al., 2013), sustainability of ﬁsheries (Gilbert 1109 et al., 2010), competition between biophysical and hydrodynamical controls on 1110 larvae retention (Phelps et al., 2015), and spread of invasive species. Similar 1111 models are frequently applied in coastal scenarios to understand the spread of 1112 aquaculture parasites (Salama and Rabe, 2013) and invasive benthic organisms 1113 (Brandt et al., 2008). It is important to note that horizontal resolution and 1114 subgrid scale diﬀusivity of the underlying Eulerian ﬂow ﬁeld can be a key 1115 for the distribution and time scales, as it was the case for the dispersion of 1116 European glass eels (Blanke et al., 2012; Baltazar-Soares et al., 2014). 1117 How these larvae interact with the water column depends on a range of 1118 characteristics such as size, development rate and behaviour (McManus and 1119 Woodson, 2012). Models investigating biological connectivity must therefore 1120 account for these characteristics and many others (e.g., Visser, 2008; Paris 1121 et al., 2013b), in addition to physical processes. ‘Behaviour’ such as orientation 1122 and swimming in response to scent plumes released from suitable habitat 1123 (Holstein et al., 2014; Staaterman and Paris, 2013) is often documented, as is 1124 vertical migration (Lampert, 1989).
45

1125 Observations of microchemical markers, genetic microsatellite markers 1126 and single nucleotide polymorphisms can provide information on realised 1127 connectivity between spatially separated populations. They can provide a 1128 direct comparison for Lagrangian tracking predictions (e.g., Pujolar et al., 1129 2013; Wilkins et al., 2013; Teske et al., 2015) in terms of population similarity, 1130 and can provide evidence of biogeographic barriers (for example coral species 1131 in the Gulf of Mexico; Sammarco et al., 2012). Recent work hints at the 1132 possibility of applying such techniques to understand population connectivity 1133 and evaluate predicted patterns at a global scale (e.g., Hellweger et al., 2014; 1134 Villar et al., 2015; Jonsson and Watson, 2016).
1135 5. Outlook
1136 Lagrangian analysis provides a powerful tool to help interpret output from 1137 OGCMs. This power will only increase as OGCMs enter ‘peta-scale’ territory. 1138 In this ﬁnal section, we oﬀer outlooks on where we see new and exciting 1139 opportunities and possibilities for the Lagrangian analysis of OGCMs.
1140 5.1. The next generation of particle tools
1141 A major challenge with particle tracking is obtaining performance for a 1142 large number (order of billions) of particles. For small velocity data sets, 1143 oﬄine parallel particle tracking can be employed via a Single Instruction 1144 Multiple Data (SIMD) approach, e.g., openMP or GPU-based implementa1145 tions. However, Input/Output will remain a bottle-neck, with most codes 1146 simply reading in the entire velocity ﬁeld, even if the particles occupy only 1147 a subregion of the domain. Recent advances in the NetCDF library toolkit, 1148 however, mean that it is now feasible to read in only those parts of the grid 1149 where there are particles, so that the number of Input/Output operations 1150 could potentially be reduced by orders of magnitude. Implementation of these 1151 new libraries, in combination with better memory management and eﬃcient 1152 use of tiered cache levels, will lead to vastly faster codes that also have smaller 1153 memory footprints. 1154 Nevertheless, for petabyte-scale velocity data sets such as those from grand 1155 challenge climate simulations, online particle tracking is necessary to avoid 1156 the unsustainable storage costs associated with oﬄine particle tracking. The 1157 challenge in this arena, however, is utilization of heterogeneous computer ar1158 chitectures. Message-passing (MPI) between computational nodes is essential 1159 and a hybrid approach utilising on-node openMP, GPU, or MIC threading
46

1160 will be required on next-generation architectures to obtain peak performance. 1161 Task-based parallelism, if implemented for OGCMs, may provide at least 1162 a partial solution. However, at present, no deﬁnitive framework or “best 1163 practice” has been adopted. 1164 Several OGCMs already have on-line particle diagnostics (see section A.2), 1165 yet no general library for coupled Lagrangian particle tracking exists so far. As 1166 a result, development eﬀorts are disjoint and functionalities are often model1167 speciﬁc. On the other hand, run-time integration with OGCMs requires close 1168 coupling with grid data in order to reduce performance overheads, while the 1169 variety of grid types makes ﬁnding a general abstraction diﬃcult. Moreover, 1170 such a library needs to provide parallel performance and scalability, as well 1171 as an easily accessible API that allows it to be integrated with diﬀerent types 1172 of ocean models.
1173 5.2. A case for standard tests of particle tools 1174 Most of the Lagrangian particle tracking tools described in section 3.5 have 1175 never been compared against each other, which makes it hard to assess their 1176 skill and ﬁdelity. While most codes are designed for very diﬀerent purposes, 1177 we propose to develop a set of test cases that we suggest code developers 1178 to use when debugging codes. This set of test cases would then also serve 1179 to highlight diﬀerences in explicit versus analytical time stepping codes, for 1180 example, or diﬀerences between particle tracking on A, B and C grids. While 1181 we envision the set to grow over time, the following would be a minimum 1182 requirement. 1183 A ﬁrst set of tests to consider are those where analytical expressions are 1184 known for trajectories.
1185 1. Radial rotation with known period. This setup tests particle trajectories 1186 in the simplest-possible ﬂow, without time evolution.
1187 2. Longitudinal shear dispersion ﬂow in a pipe (e.g., Fischer et al., 2013) 1188 to ensure that shear dispersion eﬀects are properly represented.
1189 3. Eﬀective lateral diﬀusion due to an oscillating vertical shear ﬂow (Bow1190 den, 1965) to test particle trajectories in a time-evolving ﬂow.
1191 4. Steady-state ﬂow around a peninsula (˚Adlandsvik et al., 2009). This 1192 setup tests particle trajectories in a domain with an obstacle, and can 1193 be used to test how codes behave near land boundaries.
47

1194 5. Steady-state ﬂow in a Stommel gyre and western boundary current 1195 (Fabbroni, 2009) to test particle trajectories in a domain with large 1196 gradients in ﬂow speed.
1197 6. Damped inertial oscillation on a geostrophic ﬂow (Fabbroni, 2009; Do¨o¨s 1198 et al., 2013) to appropriately quantify sub-inertial motion, e.g., loopers.
1199 7. For codes that include diﬀusivity, a simulation of Brownian motion with 1200 a given Kh and Kv to test for sub-grid parameterizations of diﬀusivity.
1201 A second set of tests can be considered that do not have an analytical solution, 1202 but that test for speed and eﬃciency of the code in more realistic idealized 1203 test cases corresponding to eddy resolving simulations, e.g., as are becoming 1204 standard in modern climate models.
1205 8. Zonally-periodic baroclinic channel (Ilıcak et al., 2012; Berloﬀ et al., 1206 2009; Abernathey et al., 2013; Ringler et al., 2016; Wolfram and Ringler, 1207 2017a,b) to explore unconstrained eddy and mean ﬂow interactions, e.g., 1208 in an idealized Antarctic Circumpolar Current.
1209 9. Eddying double-gyre ﬂow (Shevchenko and Berloﬀ, 2015; Wolfram et al., 1210 2015) to explore idealized eddying ﬂows constrained within an ocean 1211 basin.
1212 Looking forward, a list such as this one might form the basis of a La1213 grangian Model Intercomparison Project (LMIP), similar to that used in the 1214 climate modelling community through the Coupled Model Intercomparison 1215 Project (Eyring et al., 2015) or the Ocean Model Intercomparison Project 1216 (Griffies et al., 2016). An LMIP could host the velocity ﬁelds and analytical 1217 solutions of the set of test cases needed by particle model developers for 1218 debugging purposes. To allow for use across a broad suite of analysis software, 1219 we encourage developers of tools to make the trajectory data CF-compliant, 1220 as stated at http://cfconventions.org/Data/cf-conventions/cf-conventions1221 1.6/build/cf-conventions.html#discrete-sampling-geometries.
1222 5.3. Whole-Earth System and Water Cycle Modelling 1223 Beyond quantifying the pathways of seawater in the ocean, it is tantalis1224 ing to consider whether Lagrangian methods could be used to track water 1225 throughout the entire climate system. Such analysis could be used to quan1226 tify coupled thermodynamic cycles (Laliberte et al., 2015; Kjellsson et al.,
48

condensation

ice shelf basal melting
SOUTH

evaporation

heating

precipitation sea ice
cooling freeze/melt

eddy stirring
AABW

SAMW/AAIW LSW/NPIW

background mixing

entrainment

abyssal mixing

NADW

deep convection
NORTH

Figure 7: Illustrating how water particles follow the water cycle in the Earth System. We emphasize here the global ocean conveyor circulation in a pole-to-pole, meridional-vertical plane, coupled to selected and idealized atmospheric circulation in the same plane, omitting land for convenience [terrestrial processes such as evapo-transpiration, storage and runoﬀ are also part of the full water cycle]. Individual water particles are represented by color-coded boxes, advected quickly/chaotically through the atmosphere, and slowly/steadily through the ocean. Particles are stored on a wide range of timescales: in clouds (hours-days); in sea ice (seasons-years); in the ocean (years-centuries); in ice sheets/shelves (centuriesmillennia). In the ocean, colour coding identiﬁes selected water masses and advection thereof: Antarctic Bottom Water (AABW); North Atlantic Deep Water (NADW); Labrador Sea Water (LSW); Antarctic Intermediate Water (AAIW); North Paciﬁc Intermediate Water (NPIW); Subantarctic Mode Water (SAMW). In the atmosphere, colour-coding distinguishes vapor and liquid phases. Highlighted processes involve phase change or ocean-atmosphere exchange: ocean surface heating/cooling; evaporation; condensation; precipitation; sea ice freezing/melting; ice shelf basal melting. Highlighted processes internal to the ocean transform water particle density: deep convection; entrainment; enhanced abyssal mixing; eddy stirring; weak background mixing.

49

1227 2014; Zika et al., 2012; Do¨o¨s et al., 2012), geographical connectivity (Gimeno 1228 et al., 2010), and the transport, dilution and fractionation of salt, nutrients 1229 and oxygen (Figure 7). Here we will discuss such prospects including basic 1230 requirements and challenges of such analysis. 1231 One important reason for modelling the water cycle is the intensiﬁcation 1232 evident over recent decades in ocean salinity (Hosoda et al., 2009; Helm et al., 1233 2010; Durack et al., 2012). Central to this intensiﬁcation are changes to moist 1234 processes in the atmosphere (Held and Soden, 2006). However, based on 1235 observed salinity and in CMIP5 simulations, the hydrological cycle intensiﬁes 1236 at around half the rate predicted from moist thermodynamics alone (Skliris 1237 et al., 2016), while observations are currently inadequate for an accurate 1238 quantiﬁcation of changes in key processes (Hegerl et al., 2015), including 1239 precipitation and evaporation over the oceans (Skliris et al., 2014). With a 1240 Lagrangian description of the global water cycle in coupled climate models, it 1241 will be possible to fully explore the full range of atmospheric processes that 1242 are driving and retarding the observed intensiﬁcation. 1243 Another motivation is the possibility of tracing stable water isotopes 1244 through the Earth system. Stable water isotopes are a cornerstone in paleo1245 climate reconstructions, since their concentrations can be used to infer the 1246 source of the water. For example, water vapour that has evaporated from the 1247 ocean has low concentrations of heavy isotopes. Likewise, ice on Antarctica 1248 also has very low concentrations of heavy isotopes, so it is likely that the ice 1249 originates from evaporated water that precipitated over the continent (Gat, 1250 1996). Hence, an observed decrease in heavy isotope concentrations in the 1251 ocean could be due to either less evaporation, or advection of meltwater from 1252 ice sheets or land (Roche, 2013). If we could trace the isotopic composition 1253 of water as it moves between oceans, atmosphere, land and ice we could 1254 reconstruct the hydrological cycles of past climates. 1255 In general, if a Lagrangian code is to exchange particles between ocean and 1256 other components of the earth system, it must ﬁrst deal appropriately with 1257 sources and sinks of water within the ocean itself. It is now common for ocean 1258 models to have explicit water ﬂuxes at the sea-surface due to evaporation, 1259 precipitation and river run-oﬀ (Griﬃes et al., 2000). These sources and sinks 1260 of water in the ocean should be accounted for in any Lagrangian framework 1261 (e.g., with sources and sinks of particles) regardless of whether water is being 1262 traced between components. 1263 Secondly, for water to be consistently traced between components of the 1264 climate system, water must be conserved between them. This is for example
50

1265 the case in some sea-ice and iceberg models which are integrated into ocean 1266 modelling systems (Martin and Adcroft, 2010; Marsh et al., 2015, some of 1267 which incidentally use a Lagrangian framework). However, challenges remain 1268 in conserving water consistently between the ocean, atmosphere, terrestrial 1269 hydrological systems (e.g. lakes, soil moisture, groundwater and irrigation) 1270 and ice-sheets. 1271 Tracking water within each component of the earth system other than 1272 the ocean presents its own challenges. There is, for example, a rich history of 1273 Lagrangian methods in meteorology (Stohl, 1998), some having evolved from 1274 the oceanographic community (e.g. TRACMASS, see Kjellsson and D¨o¨os, 1275 2012a). It is common for such methods to track air masses rather than water 1276 itself. Water in the atmosphere comes in three phases: vapour, liquid and 1277 ice, making the tracking of water challenging. However, robust methods are 1278 in common use (see for example the FLEXPART model; Stohl and James, 1279 2005; Gimeno et al., 2010). 1280 Simulating the movement of water as Lagrangian particles between diﬀer1281 ent components of the earth system is further complicated by vast contrasts 1282 in scale both in storage and transport rates between them. The atmosphere 1283 for example holds 0.001% of all the water in the climate system while the 1284 ocean holds 97%. In contrast, the cycle of evaporation and precipitation over 1285 the globe amounts to approximately 16 Sv (i.e. multiplying global mean 1286 precipitation of 2.7mm/day, Trenberth, 1998, by the area of the earth). So 1287 while storage of water in the atmosphere is small relative to the ocean its 1288 transport of water is equivalent to that of major ocean currents. Diﬀerences 1289 in scales of motion and numerical description of these systems present great 1290 technical challenges beyond the scope of this review.
1291 6. Concluding remarks
1292 In this review article, we have presented an extensive overview of the 1293 state of the art in Lagrangian particle analysis. We focused on the use of 1294 particles determined by integral curves of the velocity ﬁeld and large-scale 1295 open ocean applications. Based on the collective knowledge of the authors, we 1296 have identiﬁed opportunities and issues for improvements of these methods as 1297 we move towards a petascale age of computing. We hope that the guidance 1298 provided here can provide a starting point for new users, as well as an impetus 1299 for experienced users and developers of these codes.
51

1300 Acknowledgements
1301 This review paper is the result of very fruitful discussions during the 1302 “Future of Lagrangian Ocean Modelling” workshop, held at Imperial College 1303 London, UK, in September 2015. Funding for this workshop was provided 1304 through an EPSRC Institutional Sponsorship grant to EvS under reference 1305 number EP/N50869X/1. EvS has received funding from the European Re1306 search Council (ERC) under the European Unions Horizon 2020 research 1307 and innovation programme (grant agreement No 715386). This research for 1308 PJW was supported as part of the Energy Exascale Earth System Model 1309 (E3SM) project, funded by the U.S. Department of Energy, Oﬃce of Science, 1310 Oﬃce of Biological and Environmental Research. Funding for Henri Drake 1311 was provided by Grant No. DE-SC0012457 from the US Department of 1312 Energy. SFG is supported by NERC National Capability funding through the 1313 Extended Ellett Line Programme. ED is an honorary Research Associate with 1314 the Belgian Fund for Scientiﬁc Research (F.R.S.-FNRS). We thank Sergey 1315 Danilov (editor), Andrew Shao, Fran¸cois Primeau, Nathaniel Tarshish, and 1316 ﬁve anonymous reviewers for very helpful comments. 1317 We also wish to thank all the scientists, researchers and programmers who 1318 built the Ocean General Circulation and Lagrangian tracking models over the 1319 past decades.
1320 A. Community tools for Lagrangian Ocean Analysis
1321 In this appendix, we provide further background to the diﬀerent community 1322 codes, both for oﬄine and online particle tracking, listed in Tables 1 and 2.
1323 A.1. Community-based oﬄine 3D Lagrangian codes 1324 A.1.1. Ariane 1325 Ariane is a numerical diagnostic tool developed at the Laboratoire de 1326 Physique des Oc´eans (Brest, France). It is dedicated to the oﬀ-line computa1327 tion of the advective component of 3D trajectories and subsequent volume 1328 transport analyses in given velocity and tracer ﬁelds, most often obtained 1329 from the numerical integration of an ocean general circulation model. 1330 The trajectory integration scheme at the core of the Ariane calculations 1331 (Blanke and Raynaud, 1997) dates back to 1992 (Speich, 1992). It takes full 1332 advantage of the volume continuity equation expressed on a C-grid (Mesinger 1333 and Arakawa, 1976). There are several advantages to the analytical calculation
52

1334 of streamlines on the model grid for successive time intervals, over which the 1335 velocity is assumed to be steady-state (see section 3.2.3). The method only 1336 calculates particle positions on the edge of grid cells, and it respects the local 1337 three-dimensional non-divergence of the ﬂow. Doing so makes the method 1338 both fast and accurate in terms of truncation error relative to an RK4 code. 1339 It oﬀers ﬂexibility too, in which backward integrations can be performed to 1340 track the origin of a given volume. A trajectory scheme that respects the 1341 continuity equation shows excellent capability for volume tracing, following 1342 the streamtube perspective discussed in Section 2.4. 1343 Following the methodology proposed by D¨o¨os (1995) and taken up by 1344 Blanke and Raynaud (1997) to take advantage of such a scheme, water volume 1345 transfers between selected control sections can be assessed with great accuracy. 1346 They can be portrayed by means of Lagrangian streamfunctions, deﬁned either 1347 on a geographic plane (Blanke et al., 1999) or on other sets of coordinates 1348 that include the model physical tracers (Blanke et al., 2006).
1349 A.1.2. TRACMASS 1350 The TRACMASS Lagrangian trajectory code was originally developed by 1351 D¨o¨os (1995) and a thorough documentation was given by D¨o¨os et al. (2013) 1352 and Do¨o¨s et al. (2017). TRACMASS has been used to calculate trajectories 1353 using velocity and tracer ﬁelds from a variety of ocean models. TRACMASS 1354 has also been used to study the atmospheric Hadley and Ferrell Cells using 1355 ERA-Interim as input (Kjellsson and Do¨o¨s, 2012a). Hence, TRACMASS can 1356 handle a wide variety of vertical grids and data formats. 1357 TRACMASS solves the path of a trajectory through a grid box analytically 1358 (see section 3.2.3) Trajectories are thus unique and if a trajectory is calculated 1359 forward and then backward the solution will be the same up to numerical 1360 noise due to round-oﬀ errors. There are two algorithms for calculating the 1361 trajectories. The original from D¨o¨os (1995) uses velocities and tracers for 1362 trajectory calculations that are assumed piecewise constant in time. Another 1363 algorithm was developed by de Vries and Do¨o¨s (2001) where time-dependence 1364 was taken into account by linearly interpolating the velocities in both time 1365 and space. D¨o¨os et al. (2017) showed that the time-interpolating scheme 1366 resulted in much more accurate calculations than the piecewise time-constant 1367 scheme. 1368 TRACMASS trajectories have also been used to simulate the behaviour of 1369 surface drifters (Kjellsson and Do¨o¨s, 2012b; Nilsson et al., 2013). Comparing 1370 the simulated drifter trajectories with observed surface-drifter trajectories
53

1371 has showed that coarse-resolution ocean models lack variability in the surface 1372 currents, which is very likely due to the omission of stochastic noise to mimic 1373 subgrid scale diﬀusion.
1374 A.1.3. Octopus 1375 Octopus is an oﬄine particle tracking code ﬁrst written to conduct oﬄine 1376 particle simulation using the Southern Ocean State Estimation (Mazloﬀ et al., 1377 2010), which makes use of the MITgcm. The code was used to study tracer 1378 evolution (Wang et al., 2016a) observed during the Diapycnal and Isopycnal 1379 Mixing Experiment in the Southern Ocean (DIMES; Gille et al., 2007; Ledwell 1380 et al., 2011). It was later used in simulating Argo ﬂoats as a component of 1381 observational system planning for the Southern Ocean Carbon and Climate 1382 Observations and Modeling project (SOCCOM, http://soccom.princeton.edu) 1383 and in studies of watermass pathways in the Southern Ocean. 1384 The interpolation scheme is linear in time and trilinear in space. The 1385 RK4 scheme is used for time integration. The boundary condition is reﬂective 1386 at the surface and solid walls. The model is currently written in Fortran 1387 for structured C-grids. OpenMP is implemented for shared-memory parallel 1388 calculation.
1389 A.1.4. LAMTA software package 1390 The LAgrangian Manifolds and Trajectories Analyser (LAMTA) consists 1391 of a set of functions developed for gnu-octave and intended for the analysis 1392 of two-dimensional velocity ﬁelds, in particular for oceanic current datasets. 1393 The source code is freely available and distributed under a GPL license upon 1394 direct request to the authors (d’Ovidio and Nencioli). 1395 The package provides routines to compute particle trajectories and La1396 grangian diagnostics based on user deﬁned velocity ﬁelds (which include 1397 analytical test cases, numerical model results and altimetry-based surface 1398 geostrophic currents). The trajectories are computed using a Runge-Kutta 1399 fourth order advection scheme (section 3.2.1). Particle advection can be 1400 performed either forward or backward in time. The scheme applies bi-linear 1401 interpolation of velocities in space and, if necessary, linear interpolation in 1402 time. Lagrangian diagnostics include Finite Time/Size Lyapunov Exponents, 1403 eddy retention, origin of water particles, age of a water particles from a given 1404 bathymetry. 1405 The package has been applied to investigate the relationship between 1406 satellite-based Lagrangian coherent structures and ocean surface tracers in
54

1407 the open ocean (d’Ovidio et al., 2004; Lehahn et al., 2007; d’Ovidio et al., 1408 2009), the retention of mesoscale structures (Smetacek et al., 2012; Martin 1409 et al., 2013), the impact of horizontal advection in structuring ecological 1410 niches (d’Ovidio et al., 2010) up to top predators (Cott´e et al., 2011; De Monte 1411 et al., 2012; Bon et al., 2015; Cott´e et al., 2015) and for contextualizing 1412 biodiversity genomic data Sunagawa et al. (2015). LAMTA has been recently 1413 included in the SPASSO (Software Package for an Adaptive Satellite-based 1414 Sampling for Ocean campaigns) software package14 developed to guide the 1415 in-situ sampling strategy as well as the interpretation of collected observations 1416 from (sub)mesoscale oriented ﬁeld experiments. The package has been used 1417 to support experiments in the NW Mediterranean (LATEX, e.g. Nencioli 1418 et al., 2011, 2013), tropical North Atlantic (STRASSE, Reverdin et al., 2015) 1419 and Southern Indian ocean: KEOPS2 (d’Ovidio et al., 2015) and LOHAFEX 1420 (Martin et al., 2013). The code has also been integrated in the package used 1421 by Cnes/AVISO to produce global maps of Lyapunov exponents and vectors 1422 from altimetry data.
1423 A.1.5. The Connectivity Modeling System (CMS) 1424 The Connectivity Modelling System (CMS Paris et al., 2013b) is an open1425 source Fortran toolbox, created at the University of Miami, for the multi-scale 1426 tracking of biotic and abiotic particles in the ocean. The tool is inherently 1427 multiscale, allowing for the seamless moving of particles between grids at 1428 diﬀerent resolutions. 1429 The CMS has been used on velocity ﬁelds from OFES, HYCOM, NEMO, 1430 MITgcm, UVic, ECCO2, SOSE, MOM and many other ocean models to 1431 compute dispersion, connectivity and fate in applications including large scale 1432 oceanography, marine reserve planning, and movement of marine biota all 1433 across the world. 1434 The CMS uses RK4 timestepping and tricubic interpolation and is designed 1435 to be modular and probabilistic, meaning that it is relatively easy to add 1436 additional ‘behaviours’ to the particles, with attributed randomly assigned 1437 for a distribution of traits. Modules distributed with the code include random 1438 walk diﬀusion, mortality, vertical migration, mixed layer mixing, and a 1439 seascape module designed to generate a connectivity matrix output from the 1440 source to the ﬁnal destination of the particles.
14http://www.mio.univ-amu.fr/ doglioli/spasso.htm
55

1441 A.1.6. Other Biotic-particle models 1442 While the CMS discussed above is also used for physical oceanogra1443 phy applications, the code has been developed as a so-called Individual 1444 Based Model (IBM), which serve predominantly biophysical applications. 1445 Another widely-used example of an IBM is ICHTYOP (Lett et al., 2008, 1446 http://www.ichthyop.org/). We will not cover IBMs in this discussion, as a 1447 very good recent overview can be found in Lynch et al. (2014).
1448 A.1.7. Parcels 1449 Parcels is an experimental prototype code aimed at exploring novel ap1450 proaches for Lagrangian tracking of virtual ocean tracer particles in the 1451 petascale age. Parcels, which is currently under development, is designed 1452 from the ground up to be eﬃcient and fast for the next generation of ocean 1453 circulation models. These ocean models are so big and massively parallel, 1454 and they produce so much data, that in a few years we may face a situation 1455 where many of the Lagrangian frameworks cannot be used on the latest data 1456 any more (see also section 5.1). 1457 The user interface of Parcels is written in python, while the computational 1458 intensive integration is Just-In-Time (JIT) compiled into C. The code is formed 1459 around a ﬂexible and customisable API that allows rapid model development, 1460 based on discrete time-stepping algorithms (section 3.2.1). It has a high-level 1461 abstraction that hides complexities from the user (ﬁeld sampling, eﬃcient 1462 loop scheduling, ﬁle I/O, etc.). This allows computer architecture experts to 1463 optimise underlying methods without changing the high-level description of 1464 the model.
1465 A.2. Online tools within OGCMs
1466 A.2.1. LIGHT within MPAS-O 1467 The Los Alamos National Laboratory Model for Prediction Across Scales 1468 Ocean (MPAS-O) (Ringler et al., 2013) is a fully unstructured C-grid ocean 1469 model capable of multiscale ocean simulation that is part of the Energy Exas1470 cale Earth System Model (E3SM), formerly known as Accelerated Climate 1471 model for Energy (ACME). MPAS-O uses an online diagnostic particle track1472 ing technique called LIGHT (Wolfram et al., 2015), for Lagrangian, in Situ, 1473 Global, High-performance particle Tracking, which is integrated within the 1474 MPAS framework and uses diﬀerent particle advection modes corresponding 1475 to diﬀerent vertical interpolation schemes. For example, particles can be 1476 advected along isopycnally-constrained trajectories. Time advancement uses a
56

1477 generalized Runge-Kutta sub-stepping scheme. Horizontal interpolation with 1478 Wachspress interpolation (Gillette et al., 2012) occurs following reconstruction 1479 of the full velocity vector via an inverse multi-quadratic radial basis function 1480 approach (Baudisch et al., 2006). Particles are implemented in linked-lists on 1481 each processor to conserve memory for large particle simulations and paral1482 lelism is via MPI. Parallel communication occurs during the computational 1483 step between spatially-adjacent processors for particles advecting from one 1484 processor to another and global parallel communication is reserved for Input 1485 and Output (I/O) tasks. Processor exchange lists for I/O may either be incre1486 mentally updated or globally computed to minimize communication overhead 1487 in diﬀerent particle tracking conﬁgurations. LIGHT provides the capability 1488 to advect the same number of particles as cells to obtain a complementary 1489 Lagrangian description of the ﬂow computed by the Eulerian prognostic solver 1490 in MPAS-O. A version of MPAS-O that includes LIGHT will be available via 1491 the public release of the U.S. Department of Energy’s Energy Exascale Earth 1492 System Model (E3SM).
1493 A.2.2. NEMO 1494 NEMO (the Nucleus for European Modelling of the Ocean) model (Madec 1495 and NEMO team, 2016) includes both Lagrangian ﬂoats (Madec, 2008) and 1496 interactive icebergs, module ICB (both RK4). In addition to the online 1497 icebergs option (NEMO-ICB; Marsh et al., 2015), icebergs can be forced in 1498 oﬄine mode (for tracking purposes) using the Stand-Alone Surface forced 1499 (SAS) option, as SAS-ICB. In both NEMO-ICB and SAS-ICB, implementation 1500 exploits available MPI parallelism.
1501 A.2.3. MITgcm 1502 The Massachusetts Institute of Technology General Circulation model 1503 (MITgcm Marshall et al., 1997b,c) is a generalized level coordinate ocean 1504 model with a wide range of conﬁguration possibilities. The MITgcm in1505 cludes a package for Lagrangian particle advection. The Lagrangian package, 1506 named flt, is however poorly documented and not described in the liter1507 ature. Nevertheless, this package provides a convenient way to integrate 1508 Lagrangian analysis into existing MITgcm setups, thereby taking advantage 1509 of the MPI parallelism of the model. Numerically, ﬂoats are advected using 1510 RK4. A ﬁxed memory buﬀer is allocated for ﬂoats on each tile, implying 1511 that memory is wasted for sparse particle ensembles. Because of MITgcm’s 1512 “oﬄine mode” (Adcroft et al., 2014), which enables loading of velocity ﬁelds
57

1513 from ﬁles, MITgcm can be eﬀectively used as a general-purpose Lagrangian 1514 model. Numerous studies have employed this conﬁguration for simulating 1515 Lagrangian trajectories from satellite-derived geostrophic velocities (Klocker 1516 et al., 2012b,a; Klocker and Abernathey, 2014) and three-dimensional model 1517 output (Abernathey et al., 2013).
1518 A.2.4. HYCOM 1519 HYCOM (the HYbrid Coordinate Ocean Model) is a generalized (hybrid) 1520 vertical coordinate ocean model (isopycnal, terrain following, and/or pressure). 1521 It is isopycnal in the open stratiﬁed ocean, but reverts smoothly to a terrain1522 following coordinate in shallow coastal regions, and to pressure coordinates 1523 near the surface in the mixed layer (Bleck, 2002; Chassignet et al., 2003, 1524 2006). HYCOM includes online code designed to follow numerical particles 1525 during model run time (Halliwell and Garraﬀo, 2002; Wallcraft et al., 2009). 1526 In addition to the ability to follow a ﬂuid particle in three dimensions, one 1527 can also release both isobaric and isopycnic ﬂoats. Isobaric ﬂoats remain at 1528 prescribed pressure levels while isopycnic ﬂoats remain on prescribed density 1529 surfaces. 1530 Because of the generalized (or hybrid) vertical coordinate of HYCOM, 1531 one has to be especially attentive when performing vertical and horizontal 1532 interpolations/advections. The horizontal, vertical, and temporal interpola1533 tion schemes used in HYCOM to advect the ﬂoats are adapted from Garraﬀo 1534 et al. (2001a,b). Horizontal interpolation is performed using a sixteen-point 1535 grid box surrounding the ﬂoat when a suﬃcient number of good grid points 1536 are available (bilinear interpolation otherwise). Vertical interpolation ﬁrst 1537 locates the bounding pressure interfaces and all properties are then linearly 1538 interpolated to the ﬂoat location. Temporal interpolation is performed using 1539 RK4. Since the vertical velocity is not a prognostic variable in HYCOM, it is 1540 diagnosed using the continuity equation (see Halliwell and Garraﬀo (2002) 1541 and Wallcraft et al. (2009) for details on the implementation).
1542 A.2.5. ROMS 1543 ROMS (Regional Ocean Model System, https://www.myroms.org/) is 1544 a free surface, hydrostatic primitive equations ocean model with terrain1545 following vertical coordinates that allow diﬀerential stretching (Shchepetkin 1546 and McWilliams, 2005; Haidvogel et al., 2008). It is an open source parallel 1547 Fortran code coupled to several models including biogeochemestry, waves, 1548 sediments, bio-optical and sea ice. It oﬀers great ﬂexibility for conﬁgura-
58

1549 tion and is widely used by the scientiﬁc community for a diverse range of 1550 applications. ROMS includes a module called floats, which allows the 1551 release and tracking of numerical particles during model run time. Passive 1552 ﬂoats can be of 3 diﬀerent types: neutral density 3D Lagrangian, isobaric 1553 (remain at prescribed pressure level) or geopotential (remain at prescribed 1554 depth). The numerical scheme used to time-step simulated ﬂoats trajectories 1555 is a fourth-order Milne predictor and fourth-order Hamming corrector. It 1556 is possible to add a random walk to the ﬂoats to simulate subgrid scale 1557 vertical diﬀusion. The random walk component is implemented considering 1558 spatially variable diﬀusivity following Hunter et al. (1993). Floats can either 1559 reﬂect or ‘stick’ when they hit the surface/bottom boundaries. Clusters of 1560 ﬂoats with user deﬁned distributions can be released at speciﬁed locations. 1561 It is possible to release particles multiple times, at deﬁned time intervals 1562 throughout the run. Recently new subroutines have been implemented to 1563 allow for ‘biological ﬂoats’ that behave according to user deﬁned parameters. 1564 The complex biology of oyster larvae, including variable growth rates and 1565 vertical swimming dependent on food, salinity, temperature and turbidity has 1566 been implemented (Narvaez et al., 2012a,b), and is available with the latest 1567 ROMS release.

1568 B. Tracer trajectories with isopycnal diﬀusion

1569 We here illustrate the stochastic diﬀerential equation discussion from 1570 Section 3.3.1. We consider the calculation of Lagrangian tracer trajectories in 1571 a 3D benchmark for diﬀusive tracer transport from Shah et al. (2011, 2013). 1572 Note that in two dimensions, the approach is slightly diﬀerent (see Appendix 1573 C). For this purpose, let x and y denote the horizontal coordinates, while 1574 z denotes the vertical coordinate and assume zero diapycnal diﬀusion. If 1575 ρ is the potential density ﬁeld (assume linear equation of state), then the 1576 isopycnal diﬀusion tensor (Redi, 1982) reads

K

=

ρ2x

KI + ρ2y +

ρ2z

ρ2y + ρ2z  −ρyρx
−ρz ρx

−ρxρy ρ2x + ρ2z −ρz ρy

−ρxρz 
−ρyρz  . ρ2x + ρ2y

(36)

1577 Here KI represents the isopycnal diﬀusion coeﬃcient and ρ is given by

ρ (x, y, z) = ρ0

1

−

N 2z g

+

αx

sin (κxx)

+

αy

sin (κyy)

.

(37)

59

1578 Note that the vertical density gradient is assumed to be constant, but the 1579 horizontal one is not, so that the isopycnal surfaces are not ﬂat. 1580 The concentration satisﬁes the following initial value problem:

∂C ∂

∂C

∂t

= ∂xi

Kij ∂xj

,

C(x, t) = C0(x).

t0 ≤ t ≤ T

(38)

1581 To solve this problem with the stochastic model given by equation (27), one

1582 needs to decompose the diﬀusion tensor K in the form 2 Kij = σik σjk. Using 1583 a Cholesky decomposition method, the components of the matrix σ can be

1584 determined. This decomposition leads to the following stochastic diﬀerential

1585 equations describing the behaviour of the individual particles (note that due

1586 to the use the of Cholesky decomposition, the components σxy, σxz and σyz of 1587 the matrix σ are zero)

√

dX(t) = axdt + √2σxxdWx(t), √

dY

(t)

=

ay dt

+ √

2σyxdWx(t)

+ √

2σyy dWy (t),

dZ(t) = azdt + 2σzxdWx(t) + 2σzydWy(t),

(39)

X(t0) = X0, Y (t0) = Y0, Z(t0) = Z0,

1588 where the drift coeﬃcients ax, ay and az are given by

ax

=

∂Kxx ∂x

+

∂Kxy , ∂y

ay

=

∂Kyx ∂x

+

∂Kyy ∂y

and

az

=

∂Kzx ∂x

+

∂Kzy . ∂y

(40)

1589 In Figure 8a results of a simulation are shown for parameter values that 1590 are relevant for ocean transport problems (Shah et al., 2011, 2013). Here 1591 the particles have been released at the origin (x, y, z) = (0, 0, 0), a point that 1592 belongs to the isopycnal surface. The position vector [xj(t), yj(t), zj(t)], j = 1593 1, 2 · · · J. of each particles is simulated by means of a Lagrangian scheme. 1594 Because the diapycnal diﬀusion is zero, the particles should not leave the 1595 isopycnal surface. However, numerical errors are unavoidable and their 1596 magnitude can be estimated by means of a spurious diapycnal diﬀusivity. The 1597 results presented in Figure 8b show that the higher order Milstein scheme 1598 performs better than the Euler scheme.

60

z−axis (m)
Spurious diapycnal diffusivity (KD m2 s−1)

2000 1000 Particles

10−6

0

−1000

−2000 4

2

0 x 106 −2

y−axis (m)

−4 −4

(a)

Isopycnal surface

0 −2

4 2
x 106

x−axis (m)

10−8 Ito Euler & Ito−backward Euler

10−10

Ito Milstein & Stratonovich Milstein

10−12 105

∆t (seconds)
(b)

106

Figure 8: (a) Simulated position of Lagrangian particles at a certain time on the non-ﬂat isopycnal surface and (b) the spurious diapycnal diﬀusivity for diﬀerent Lagrangian schemes.

1599 C. Diﬀusion in two-dimensional models and associated Lagrangian 1600 tracer trajectories
1601 This review article deals with Lagrangian methods for large-scale open1602 ocean applications in oceanography. This is why the theoretical developments 1603 and the ﬂows dealt with are essentially three-dimensional. There are, however, 1604 diﬃculties inherent in one- or two-dimensional transport models, which cannot 1605 be regarded as an idealisation or simpliﬁcation of three-dimensional models. 1606 Some aspect thereof are outlined below. 1607 Let H, ui(i = 1, 2) and C be functions of the time and horizontal co1608 ordinates representing the height of the water column, the depth-averaged 1609 horizontal velocity and the depth-averaged concentration of a passive tracer, 1610 respectively. Then, the continuity equation is

∂tH + ∂i(H ui) = 0

(41)

1611 and the equation obeyed by the concentration reads (e.g. Vanderborght et al.,

1612 2007)

∂t(H C) + ∂i(H C ui) = ∂i(H Kij∂jC)

(42)

61

1613 where the diﬀusivity tensor Kij is symmetric and positive deﬁnite. The 1614 latter partial diﬀerential equation may be transformed into a Fokker-Planck 1615 equation in which HC (rather than C) should be viewed as the unknown:

∂t(H

C)

+

∂i(H

C

u )drift i

=

∂i ∂j (Kij

H

C)

(43)

1616 where the drift velocity is (Heemink, 1990)

udrift i

=

ui

+

H −1

∂j (H

Kij )

=

ui

+

∂i (Kij )

+

Kij

H −1

∂j H.

(44)

1617 The ﬁrst two terms on the right-hand-side of equation (44) are equivalent 1618 to those used in three-dimensional models, whilst the last one is speciﬁc to 1619 depth-integrated models. 1620 If the last term in (44) is not taken into account in a Lagrangian model, 1621 then particles might tend to concentrate into the shallowest areas, which clearly 1622 is unphysical and may lead to erroneous conclusions (e.g. Spagnol et al., 2002). 1623 A test case was designed by Deleersnijder (2015) that includes an analytical 1624 solution for diﬀusion in a depth-varying domain, and implemented numerically 1625 by Thomas et al. (2015a). This exact solution exhibits a somewhat counter1626 intuitive behaviour, with the location of the maximum of the concentration 1627 and the tracer patch centre of mass moving in opposite directions.
Somewhat similar developments are made when designing a one-dimensional, cross section-averaged transport model. Such models are often used to simulate transport processes in elongated domains such as rivers or estuaries (e.g. Everbecq et al., 2001; Hofmann et al., 2008). In this case all the variables and parameters depend on time and the along-ﬂow coordinate x. If S, u and C denote the cross-sectional area, the cross-section-averaged velocity and the cross-section-averaged concentration, respectively, then the one-dimensional counterparts to equations (41)-(44) are

∂tS + ∂x(S u) = 0 ∂t(S C) + ∂x(S C u) = ∂x(S K ∂xC) ∂t(S C) + ∂x(S C u )drift = ∂x∂x(K S C)

(45a) (45b) (45c)

1628 where

udrift = u + S−1 ∂x(SK) = u + ∂xK + K S−1 ∂xS

(46)

1629 is the drift velocity, and K is the along-ﬂow diﬀusivity. 1630 In depth- and section-averaged models, the diﬀusion term is rarely meant 1631 to represent turbulent diﬀusion per se. Instead, it is essentially the eﬀect of

62

1632 shear dispersion (e.g. Young and Jones, 1991) that is to be parameterized, i.e. 1633 the impact on the resolved (reduced-dimension) processes of the combined 1634 eﬀect of sheared-advection and turbulent diﬀusion in the transversal direction. 1635 As a consequence, the diﬀusivity coeﬃcients are often signiﬁcantly larger than 1636 those that would be used in a three-dimensional model of the same domain.
1637 References
1638 Abernathey, R., Ferreira, D., and Klocker, A. (2013). Diagnostics of isopycnal 1639 mixing in a circumpolar channel. Ocean Modelling, 72:1 – 16.
1640 Abernathey, R. and Haller, G. (2017). Transport by lagrangian vortices in 1641 the eastern paciﬁc. In revision at J. Phys. Oceanogr.
1642 Abraham, E. R. and Bowen, M. M. (2002). Chaotic stirring by a mesoscale 1643 surface-ocean ﬂow. Chaos, 12(2):373–381.
1644 Adcroft, A., Campin, J., Dutkiewicz, S., Evangelinos, C., Ferreira, D., Forget, 1645 G., Fox-Kemper, B., Heimbach, P., Hill, C., Hill, E., et al. (2014). Mitgcm 1646 user manual.
1647 ˚Adlandsvik, B., Bartsch, J., Brickman, D., Browman, H. I., Edwards, K., 1648 Fiksen, Ø., Gallego, A., Hermann, A. J., Hinckley, S., Houde, E., Huret, 1649 M., Irisson, J.-O., Lacroix, G., Leis, J. M., McCloghrie, P., Megrey, B. A., 1650 Miller, T., Van der Molen, J., Mullon, C., North, E. W., Parada, C., Paris, 1651 C. B., Pepin, P., Petitgas, P., Rose, K., Thygesen, U. H., and Werner, C. 1652 (2009). Manual of recommended practices for modelling physical – biological 1653 interactions during ﬁsh early life. Technical report, IFREMER, D´ept. EMH 1654 BP 21105 FR-44311 Nantes, Cedex 03, France.
1655 Aris, R. (1962). Vectors, Tensors and the Basic Equations of Fluid Mechanics. 1656 Dover Publishing, New York.
1657 Artale, V., Boﬀetta, G., Celani, A., Cencini, M., and Vulpiani, A. (1997). Dis1658 persion of passive tracers in closed basins: Beyond the diﬀusion coeﬃcient. 1659 Physics of Fluids (1994-present), 9(11):3162–3171.
1660 Aurell, E., Boﬀetta, G., Crisanti, A., Paladin, G., and Vulpiani, A. (1997). Pre1661 dictability in the large: an extension of the concept of Lyapunov exponent. 1662 J. Phys. A, 30(1):1.
63

1663 Awaji, T., Imasato, N., and Kunishi, H. (1980). Tidal exchange through a 1664 strait: A numerical experiment using a simple model basin. Journal of 1665 Physical Oceanography, 10(10):1499–1508.
1666 Baltazar-Soares, M., Biastoch, A., Harrod, C., Hanel, R., Marohn, L., Prigge, 1667 E., Evans, D., Bodles, K., Behrens, E., and Bo¨ning, C. W. (2014). Recruit1668 ment collapse and population structure of the European eel shaped by local 1669 ocean current dynamics. Current Biology, 24(1):104–108.
1670 Batchelor, G. (1952). Diﬀusion in a ﬁeld of homogeneous turbulence. In 1671 Mathematical Proceedings of the Cambridge Philosophical Society, volume 1672 48–02, pages 345–362. Cambridge Univ Press.
1673 Batchelor, G. K. (1967). An Introduction to Fluid Dynamics. Cambridge 1674 University Press, Cambridge, England.
1675 Bates, M. L., Griﬃes, S. M., and England, M. H. (2012). A dynamic, 1676 embedded Lagrangian model for ocean climate models. Part I: Theory and 1677 implementation. Ocean Modelling, 59-60(C):41–59.
1678 Baudisch, J., Bonaventura, L., Iske, A., and Miglio, E. (2006). Matrix valued 1679 radial basis functions for local vector ﬁeld reconstruction: applications to 1680 computational ﬂuid dynamic models. MOX Report, 75.
1681 Bauer, S., Swenson, M. S., and Griﬀa, A. (2002). Eddy mean ﬂow decomposi1682 tion and eddy diﬀusivity estimates in the tropical Paciﬁc Ocean: 2. Results. 1683 J. Geophys. Res., 107(C10):3154.
1684 Bennett, A. F. (1987). A lagrangian analysis of turbulent diﬀusion. Reviews 1685 of Geophysics, 25(4):799–822.
1686 Bennett, A. F. (2006). Lagrangian Fluid Dynamics. Cambridge University 1687 Press, Cambridge.
1688 Berglund, M., Nilsson Jacobi, M., and Jonsson, P. R. (2012). Optimal 1689 selection of marine protected areas based on connectivity and habitat 1690 quality. Ecological Modelling, 240:105–112.
1691 Berloﬀ, P., Kamenkovich, I., and Pedlosky, J. (2009). A model of multiple 1692 zonal jets in the oceans: Dynamical and kinematical analysis. Journal of 1693 Physical Oceanography, 39(11):2711–2734.
64

1694 Berloﬀ, P. and McWilliams, J. (2003). Material transport in oceanic gyres. 1695 part iii. randomized stochastic models. Journal of Physical Oceanography, 1696 33:1416–1445.
1697 Berloﬀ, P., McWilliams, J., and Bracco, A. (2002). Material transport in 1698 oceanic gyres. part i. phenomenology. Journal of Physical Oceanography, 1699 32:764–796.
1700 Berloﬀ, P. S. and McWilliams, J. C. (2002). Material transport in oceanic gyres. 1701 part ii: Hierarchy of stochastic models. Journal of Physical Oceanography, 1702 32(3):797–830.
1703 Beron-Vera, F. J. and LaCasce, J. H. (2016). Statistics of simulated and 1704 observed pair separations in the Gulf of Mexico. Journal of Physical 1705 Oceanography, 46(7):2183–2199.
1706 Beron Vera, F. J., Olascoaga, M. J., and Goni, G. J. (2008). Oceanic mesoscale 1707 eddies as revealed by Lagrangian coherent structures. Geophys. Res. Lett., 1708 35(12).
1709 Beron-Vera, F. J., Wang, Y., Olascoaga, M. J., Goni, G. J., and Haller, G. 1710 (2013). Objective Detection of Oceanic Eddies and the Agulhas Leakage. 1711 Journal of Physical Oceanography, 43(7):1426–1438.
1712 Bettencourt, J. a. H., L´opez, C., Hern´andez-Garc´ıa, E., Montes, I., Sudre, 1713 J., Dewitte, B., Paulmier, A., and Garcon, V. (2015). Boundaries of the 1714 peruvian oxygen minimum zone shaped by coherent mesoscale dynamics. 1715 Nature Geoscience.
1716 Blanke, B., Arhan, M., Madec, G., and Roche, S. (1999). Warm water paths 1717 in the equatorial Atlantic as diagnosed with a general circulation model. 1718 Journal of Physical Oceanography, 29:2753–2768.
1719 Blanke, B., Arhan, M., and Speich, S. (2006). Salinity changes along the 1720 upper limb of the Atlantic thermohaline circulation. Geophysical Research 1721 Letters, 33:L06609.
1722 Blanke, B., Bonhommeau, S., Grima, N., and Drillet, Y. (2012). Sensitivity of 1723 advective transfer times across the North Atlantic Ocean to the temporal 1724 and spatial resolution of model velocity data: Implication for European eel 1725 larval transport. Dyn. Atmos. Ocean., 55-56:22–44.
65

1726 Blanke, B. and Raynaud, S. (1997). Kinematics of the Paciﬁc Equatorial 1727 Undercurrent: An Eulerian and Lagrangian approach from GCM results. 1728 Journal of Physical Oceanography, 27(6):1038–1053.
1729 Blanke, B. and Speich, S. (2002). A global diagnostic of interior ocean 1730 ventilation. Geophysical research Letters, 29(8):1–4.
1731 Bleck, R. (2002). An oceanic general circulation model framed in hybrid 1732 isopycnic-Cartesian coordinates. Ocean Modelling, 4(1):55–88.
1733 Bon, C., Della Penna, A., dOvidio, F., Arnould, J. Y., Poupart, T., and Bost, 1734 C.-A. (2015). Inﬂuence of oceanographic structures on foraging strategies: 1735 Macaroni penguins at crozet islands. Movement ecology, 3(1):1–11.
1736 B¨oning, C. W. and Cox, M. D. (1988). Particle dispersion and mixing of 1737 conservative properties in an eddy-resolving model. Journal of Physical 1738 Oceanography, 18.
1739 Bowden, K. F. (1965). Horizontal mixing in the sea due to a shearing current. 1740 J. Fluid Mech., 21(2):83–95.
1741 Bower, A. S., Lozier, M. S., Gary, S. F., and Bo¨ning, C. W. (2009). Interior 1742 pathways of the North Atlantic meridional overturning circulation. Nature, 1743 459:243–248.
1744 Brandt, G., Wehrmann, A., and Wirtz, K. W. (2008). Rapid invasion of 1745 Crassostrea gigas into the German Wadden Sea dominated by larval supply. 1746 Journal of Sea Research, 59(4):279–296.
1747 Burgess, S. C., Nickols, K. J., Griesemer, C. D., Barnett, L. A. K., Dedrick, 1748 A. G., Satterthwaite, E. V., Yamane, L., Morgan, S. G., White, J. W., and 1749 Botsford, L. W. (2014). Beyond connectivity: how empirical methods can 1750 quantify population persistence to improve marine protected-area design. 1751 Ecological Applications: A Publication of the Ecological Society of America, 1752 24(2):257–270.
1753 Butcher, J. C. (2016). Numerical methods for ordinary diﬀerential equations. 1754 John Wiley & Sons.
1755 Cetina-Heredia, P., Roughan, M., van Sebille, E., Feng, M., and Coleman, 1756 M. A. (2015). Strengthened currents override the eﬀect of warming on 1757 lobster larval dispersal & survival. Global Change Biology, 21:4377–4386.
66

1758 Chassignet, E., Smith, L. T., Halliwell, G., and Bleck, R. (2003). North 1759 Atlantic simulations with the Hybrid Coordinate Ocean Model (HYCOM): 1760 Impact of the vertical coordinate choice, reference pressure, and thermo1761 baricity. Journal of Physical Oceanography, 33(12):2504–2526.
1762 Chassignet, E. P., Hurlburt, H., Smedstad, O. M., Halliwell, G., Wallcraft, 1763 A. J., Metzger, E. J., Blanton, B., Lozano, C., Rao, D., Hogan, P., and 1764 Srinivasan, A. (2006). Generalized Vertical Coordinates for Eddy-Resolving 1765 Global and Coastal Ocean Forecasts. Oceanography, 19(1):118–129.
1766 Chenillat, F., Blanke, B., Grima, N., Franks, P. J. S., Capet, X., and Rivi`ere, 1767 P. (2015). Quantifying tracer dynamics in moving ﬂuids: a combined 1768 Eulerian-Lagrangian approach. Frontiers in Environmental Science, 3:1–15.
1769 Chu, P. C. and Fan, C. (2014). Accuracy Progressive Calculation of Lagrangian 1770 Trajectories from a Gridded Velocity Field. Journal of Atmospheric and 1771 Oceanic Technology, 31(7):1615–1627.
1772 Cott´e, C., d’Ovidio, F., Chaigneau, A., L´evy, M., Taupier Letage, I., Mate, 1773 B., and Guinet, C. (2011). Scale-dependent interactions of Mediterranean 1774 whales with marine dynamics. Limnol. Oceanogr., 106(20):219–232.
1775 Cott´e, C., dOvidio, F., Dragon, A.-C., Guinet, C., and L´evy, M. (2015). 1776 Flexible preference of southern elephant seals for distinct mesoscale features 1777 within the antarctic circumpolar current. Progress in Oceanography, 131:46– 1778 58.
1779 Cowen, R. K., Paris, C. B., and Srinivasan, A. (2006). Scaling of connectivity 1780 in marine populations. Science, 311:522–527.
1781 Cummins, S. J., Silvester, T. B., and Cleary, P. W. (2012). Three-dimensional 1782 wave impact on a rigid structure using smoothed particle hydrodynamics. 1783 Int. J. Numer. Methods Fluids, 68(12):1471–1496.
1784 Danabasoglu, G. (2004). A comparison of global ocean general circulation 1785 model solutions obtained with synchronous and accelerated integration 1786 methods. Ocean Modelling, 7:323–341.
1787 Davis, R. E. (1982). On relating eulerian and lagrangian velocity statistics: 1788 single particles in homogeneous ﬂows. Journal of Fluid Mechanics, 114:1–26.
67

1789 Davis, R. E. (1983). Oceanic property transport, lagrangian particle statistics, 1790 and their prediction. Journal of Marine Research, 41:163–194.
1791 Davis, R. E. (1985). Drifter observations of coastal surface currents during 1792 code: The statistical and dynamical views. Journal of Geophysical Research, 1793 90(C3):4756–4772.
1794 Davis, R. E. (1987). Modeling eddy transport of passive tracers. Journal of 1795 Marine Research, 45(3):635–666.
1796 Davis, R. E. (1991). Observing the general circulation with ﬂoats. Deep Sea 1797 Res., 38:531–571.
1798 Davis, R. E. (1998). Preliminary results from directly measuring mid-depth 1799 circulation in the Tropical and South Paciﬁc. J. Gephys. Res., 103:24619– 1800 24639.
1801 Dawson, M. N., Sen Gupta, A., and England, M. H. (2005). Coupled 1802 biophysical global ocean model and molecular genetic analyses identify 1803 multiple introductions of cryptogenic species. Proceedings of the National 1804 Academy of Sciences, 102(34):11968–11973.
1805 De Monte, S., Cott´e, C., d’Ovidio, F., L´evy, M., Le Corre, M., and Weimer1806 skirch, H. (2012). Frigatebird behaviour at the ocean–atmosphere interface: 1807 integrating animal behaviour with multi-satellite data. Journal of The 1808 Royal Society Interface, 9(77):3351–3358.
1809 de Vries, P. and D¨o¨os, K. (2001). Calculating lagrangian trajectories using 1810 time-dependent velocity ﬁelds. J. Atmos. Oceanic Technology., 18(6):1092– 1811 1101.
1812 DeGroot, S. R. and Mazur, P. (1984). Non-Equilibrium Thermodynamics. 1813 Dover Publications, New York. 510 pp.
1814 Deleersnijder, E. (2015). A depth-integrated diﬀusion problem 1815 in a depth-varying, unbounded domain for assessing Lagrangian 1816 schemes. Technical report, Universit´e Catholique de Louvain; 1817 http://hdl.handle.net/2078.1/160980.
1818 Deleersnijder, E., Campin, J. M., and Delhez, E. J. M. (2001). The concept of 1819 age in marine modelling I. Theory and preliminary model results. Journal 1820 of Marine Systems, 28:229–267.
68

1821 Do¨o¨s, K. (1995). Inter-ocean exchange of water masses. Journal of Geophysical 1822 Research: Oceans, 100:13499–13514.
1823 D¨o¨os, K., J¨onsson, B., and Kjellsson, J. (2017). Evaluation of oceanic and 1824 atmospheric trajectory schemes in the TRACMASS trajectory model v6.0. 1825 Geoscientiﬁc Model Development, 10(4):1733–1749.
1826 Do¨o¨s, K., Kjellsson, J., and Jo¨nsson, B. (2013). TRACMASS—A Lagrangian 1827 Trajectory Model. In Preventive Methods for Coastal Protection, pages 1828 225–249. Springer International Publishing, Heidelberg.
1829 Do¨o¨s, K., Meier, H. E. M., and Do¨scher, R. (2004). The Baltic haline conveyor 1830 belt or the overturning circulation and mixing in the Baltic. Ambio, 33(41831 5):261–266.
1832 D¨o¨os, K., Nilsson, J., Nycander, J., Brodeau, L., and Ballarotta, M. (2012). 1833 The World Ocean Thermohaline Circulation. Journal of Physical Oceanog1834 raphy, 42(9):1445–1460.
1835 Do¨o¨s, K., Nycander, J., and Coward, A. C. (2008). Lagrangian decomposition 1836 of the Deacon Cell. J. Geophys. Res. Ocean., 113(C7):C07028.
1837 Dormand, J. and Prince, P. (1980). A family of embedded runge-kutta 1838 formulae. Journal of Computational and Applied Mathematics, 6(1):19 – 1839 26.
1840 d’Ovidio, F., De Monte, S., Alvain, S., Dandonneau, Y., and L´evy, M. (2010). 1841 Fluid dynamical niches of phytoplankton types. Proceedings of the National 1842 Academy of Sciences, 107(43):18366–18370.
1843 d’Ovidio, F., Della Penna, A., Trull, T. W., Nencioli, F., Pujol, M.-I., Rio, 1844 M.-H., Park, Y.-H., Cott´e, C., Zhou, M., and Blain, S. (2015). The biogeo1845 chemical structuring role of horizontal stirring: Lagrangian perspectives 1846 on iron delivery downstream of the Kerguelen Plateau. Biogeosciences, 1847 12(19):5567–5581.
1848 d’Ovidio, F., Fern´andez, V., Hern´andez Garc´ıa, E., and L´opez, C. (2004). 1849 Mixing structures in the Mediterranean Sea from ﬁnite-size Lyapunov 1850 exponents. Geophys. Res. Lett., 31:L17203.
69

1851 d’Ovidio, F., Isern Fontanet, J., Lo´pez, C., Herna´ndez Garc´ıa, E., and Garc´ıa 1852 Ladona, E. (2009). Comparison between Eulerian diagnostics and ﬁnite-size 1853 Lyapunov exponents computed from altimetry in the Algerian basin. Deep 1854 Sea Res. I, 56(1):15–31.
1855 Drijfhout, S., de Vries, P., Do¨o¨s, K., and Coward, A. (2003). Impact of eddy1856 induced transport on the lagrangian structure of the upper branch of the 1857 thermohaline circulation. Journal of Physical Oceanography, 24:2141–2155.
1858 Drijfhout, S. S., Maier-Reimer, E., and Mikolajewicz, U. (1996). Tracing 1859 the conveyor belt in the Hamburg large-scale geostrophic ocean general 1860 circulation model. Journal of Geophysical Research: Oceans, 101:22563– 1861 22575.
1862 Durack, P. J., Wijﬀels, S. E., and Matear, R. J. (2012). Ocean Salinities 1863 Reveal Strong Global Water Cycle Intensiﬁcation During 1950 to 2000. 1864 Science, 336(6080):455–458.
1865 Durgadoo, J. V., Loveday, B. R., Reason, C. J. C., Penven, P., and Biastoch, 1866 A. (2013). Agulhas Leakage Predominantly Responds to the Southern 1867 Hemisphere Westerlies. J. Phys. Oceanogr., 43(10):2113–2131.
1868 Durgadoo, J. V., Ru¨hs, S., Biastoch, A., and Bo¨ning, C. W. B. (2017). Indian 1869 ocean sources of agulhas leakage. Journal of Geophysical Research: Oceans, 1870 122:3481–3499.
1871 Durran, D. R. (1999). Numerical Methods for Wave Equations in Geophysical 1872 Fluid Dynamics. Springer Verlag, Berlin. 470 pp.
1873 Eckart, C. (1948). An analysis of the stirring and mixing processes in 1874 incompressible ﬂuids. Journal of Marine Research, 7:265–275.
1875 England, M. (1995). The Age of Water and Ventilation Timescales in a Global 1876 Ocean Model. Journal of Physical Oceanography, 25:2756–2777.
1877 Everbecq, E., Gosselain, V., Viroux, L., and Descy, J. P. (2001). Potamon: A 1878 dynamic model for predicting phytoplankton composition and biomass in 1879 lowland rivers. Water Research, 35(4):901–912.
1880 Eyring, V., Bony, S., Meehl, J., Senior, C., Stevens, B., Stouﬀer, R., and 1881 Taylor, K. (2015). Overview of the coupled model intercomparison project
70

1882 phase 6 (cmip6) experimental design and organisation. Geoscientiﬁc Model 1883 Development Discussions, 2015:10539–10583.
1884 Fabbroni, N. (2009). Numerical simulations of passive tracers dispersion in 1885 the sea. PhD thesis, Universita di Bologna.
1886 Farazmand, M. M. and Haller, G. (2012). Computing lagrangian coherent 1887 structures from their variational theory. Chaos, 22.
1888 Fine, R. A., Rhein, M., and Andri´e, C. (2002). Using a CFC eﬀective age to 1889 estimate propagation and storage of climate anomalies in the deep western 1890 North Atlantic Ocean. Geophysical Research Letters, 29(24):80–1.
1891 Fischer, H. B., List, J. E., Koh, C. R., Imberger, J., and Brooks, N. H. (2013). 1892 Mixing in inland and coastal waters. Elsevier.
1893 Fox-Kemper, B., Lumpkin, R., and Bryan, F. (2013). Lateral transport in 1894 the ocean interior. In Siedler, G., Griﬃes, S. M., Gould, J., and Church, 1895 J., editors, Ocean Circulation and Climate, 2nd Edition: A 21st Century 1896 Perspective, volume 103 of International Geophysics Series, pages 185–209. 1897 Academic Press.
1898 Froyland, G., Horenkamp, C., Rossi, V., Santitissadeekorn, N., and Sen Gupta, 1899 A. (2012). Three-dimensional characterization and tracking of an Agulhas 1900 Ring. Ocean Modelling, 52-53:69–75.
1901 Froyland, G., Horenkamp, C., Rossi, V., and van Sebille, E. (2015). Studying 1902 an Agulhas ring’s long-term pathway and decay with ﬁnite-time coherent 1903 sets. Chaos, 25(8):083119.
1904 Froyland, G., Padberg-Gehle, K., England, M. H., and Treguier, A.-M. (2007). 1905 Detection of coherent oceanic structures via transfer operators. Physical 1906 Review Letters, 98(22):224503.
1907 Fujio, S. and Imasato, N. (1991). Diagnostic calculation for circulation and 1908 water mass movement in the deep paciﬁc. Journal of Geophysical Research: 1909 Oceans, 96(C1):759–774.
1910 Fujio, S., Kadowaki, T., and Imasato, N. (1992). World ocean circulation 1911 diagnostically derived from hydrographic and wind stress ﬁelds: 2. the water 1912 movement. Journal of Geophysical Research: Oceans, 97(C9):14439–14452.
71

1913 Gaines, S. D., Gaylord, B., and Largier, J. L. (2003). Avoiding current 1914 oversights in marine reserve design. Ecological Applications, 13(sp1):32–46.
1915 Gardiner, C. W. (1985). Handbook of stochastic models, 2nd ed. Springer, 1916 Heidelberg.
1917 Garraﬀo, Z. D., Griﬀa, A., Mariano, A. J., and Chassignet, E. P. (2001a). 1918 Lagrangian data in a high-resolution numerical simulation of the North 1919 Atlantic II. On the pseudo-Eulerian averaging of Lagrangian data. Journal 1920 of Marine Systems, 29(1-4):177–200.
1921 Garraﬀo, Z. D., Mariano, A. J., Griﬀa, A., Veneziani, C., and Chassignet, 1922 E. P. (2001b). Lagrangian data in a high-resolution numerical simulation 1923 of the North Atlantic I. Comparison with in situ drifter data. Journal of 1924 Marine Systems, 29(1-4):157–176.
1925 Gary, S. F., Lozier, M. S., Biastoch, A., and Bning, C. W. (2012). Reconciling 1926 tracer and ﬂoat observations of the export pathways of Labrador Sea Water. 1927 Geophysical Research Letters, 39(November):1–5.
1928 Gary, S. F., Lozier, M. S., Kwon, Y.-O., and J., P. J. (2014). The fate of north 1929 atlantic subtropical mode water in the ﬂame model. Journal of Physical 1930 Oceanography, 44(5).
1931 Gat, J. R. (1996). Oxygen and hydrogen isotopes in the hydrologic cycle. 1932 Annual Review of Earth and Planetary Sciences, 24:225–262.
1933 Gaylord, B. and Gaines, S. D. (2000). Temperature or transport? range 1934 limits in marine species mediated solely by ﬂow. The American Naturalist, 1935 155(6):769–789.
1936 Gilbert, C. S., Gentleman, W. C., Johnson, C. L., DiBacco, C., Pringle, 1937 J. M., and Chen, C. (2010). Modelling dispersal of sea scallop (Placopecten 1938 magellanicus) larvae on Georges Bank: The inﬂuence of depth-distribution, 1939 planktonic duration and spawning seasonality. Progress in Oceanography, 1940 87(1–4):37–48.
1941 Gille, S. T., Speer, K., Ledwell, J. R., and Garabato, A. C. N. (2007). 1942 Mixing and Stirring in the Southern Ocean. Eos, Transactions American 1943 Geophysical Union, 88:382.
72

1944 Gillette, A., Rand, A., and Bajaj, C. (2012). Error estimates for general1945 ized barycentric interpolation. Advances in computational mathematics, 1946 37(3):417–439.
1947 Gimeno, L., Drumond, A., Nieto, R., Trigo, R. M., and Stohl, A. (2010). 1948 On the origin of continental precipitation. Geophysical Research Letters, 1949 37(13):n/a–n/a.
1950 Graham, F. and McDougall, T. (2013). Quantifying the nonconservative pro1951 duction of Conservative Temperature, potential temperature, and entropy. 1952 Journal of Physical Oceanography, 43:838–862.
1953 Gra¨we, U., Deleersnijder, E., Shah, S. H. A. M., and Heemink, A. W. (2012). 1954 Why the euler-scheme in particle-tracking is not enough: the shallow sea 1955 test case. Ocean Dynamics, 62(4):501–514.
1956 Griesel, A., Eden, C., Koopmann, N., and Yulaeva, E. (2015). Comparing 1957 isopycnal eddy diﬀusivities in the southern ocean with predictions from 1958 linear theory. Ocean Modelling, 94:33–45.
1959 Griesel, A., McClean, J., Gille, S., Sprintall, J., and Eden, C. (2014). Eulerian 1960 and lagrangian isopycnal eddy diﬀusivities in the southern oocean of an 1961 eddying model. J. Phys. Oceanogr, 44:644–661.
1962 Griﬀa, A. (1996). Applications of stochastic particle models to oceanographic 1963 problems. In Stochastic modelling in physical oceanography, pages 113–140. 1964 Springer.
1965 Griffies, S. M. (1998). The Gent-McWilliams skew-ﬂux. Journal of Physical 1966 Oceanography, 28:831–841.
1967 Griﬃes, S. M., B¨oning, C. W., Bryan, F. O., Chassignet, E. P., Gerdes, 1968 R., Hasumi, H., Hirst, A. C., Treguier, A.-M., and Webb, D. J. (2000). 1969 Developments in ocean climate modelling. Ocean Modelling, 2:123–192.
1970 Griffies, S. M., Danabasoglu, G., Durack, P. J., Adcroft, A. J., Balaji, V., 1971 B¨oning, C. W., Chassignet, E. P., Curchitser, E., Deshayes, J., Drange, 1972 H., Fox-Kemper, B., Gleckler, P., Gregory, J., Haak, H., Hallberg, R., 1973 Heimbach, P., Hewitt, H., Holland, D., Ilyina, T., Jungclaus, J., Komuro, 1974 Y., Krasting, J., Large, W., Marsland, S., Masina, S., McDougall, T., 1975 Nurser, A. G., Orr, J., Pirani, A., Qiao, F., Stouﬀer, R., Taylor, K.,
73

1976 Treguier, A. M., Tsujino, H., Uotila, P., Valdivieso, M., Wang, Q., Winton, 1977 M., and Yeager, S. (2016). Omip contribution to cmip6: experimental 1978 and diagnostic protocol for the physical component of the ocean model 1979 intercomparison project. Geoscientiﬁc Model Development, 9:3231–3296.
1980 Hadjighasem, A., Farazmand, M., Blazevski, D., Froyland, G., and Haller, G. 1981 (2017). A critical comparison of lagrangian methods for coherent structure 1982 detection. Chaos: An Interdisciplinary Journal of Nonlinear Science, 1983 27(5):053104.
1984 Haertel, P. T. and Fedorov, A. (2012). The Ventilated Ocean. Journal of 1985 Physical Oceanography, 42(1):141–164.
1986 Haertel, P. T. and Randall, D. A. (2002). Could a pile of slippery sacks 1987 behave like an ocean? Monthly Weather Review, 130(12):2975–2988.
1988 Haidvogel, D., Arango, H., Budgell, W., Cornuelle, B., Curchitser, E., Lorenzo, 1989 E. D., Fennel, K., Geyer, W., Hermann, A., Lanerolle, L., Levin, J., 1990 McWilliams, J., Miller, A., Moore, A., Powell, T., Shchepetkin, A., Sher1991 wood, C., Signell, R., Warner, J., and Wilkin, J. (2008). Ocean forecast1992 ing in terrain-following coordinates: Formulation and skill assessment of 1993 the regional ocean modeling system. Journal of Computational Physics, 1994 227(7):3595 – 3624. Predicting weather, climate and extreme events.
1995 Haine, T. W. and Hall, T. M. (2002). A generalized transport theory: Water1996 mass composition and age. Journal of physical oceanography, 32(6):1932– 1997 1946.
1998 Haines, M. A., Fine, R. A., Luther, M. E., and Ji, Z. (1999). Particle 1999 trajectories in an Indian Ocean model and sensitivity to seasonal forcing. 2000 Journal of Physical Oceanography, 29(4):584–598.
2001 Hairer, E., Lubich, C., and Wanner, G. (2006). Geometric numerical inte2002 gration: structure-preserving algorithms for ordinary diﬀerential equations, 2003 volume 31. Springer Science & Business Media.
2004 Haller, G. (2015). Lagrangian Coherent Structures. Annual Review of Fluid 2005 Mechanics, 47(1):137–162.
2006 Haller, G. (2016). Dynamic rotation and stretch tensors from a dynamic polar 2007 decomposition. Journal of the Mechanics and Physics of Solids, 86:70–93.
74

2008 Haller, G. and Beron-Vera, F. J. (2012). Geodesic theory of transport barriers 2009 in two-dimensional ﬂows. Physica D: Nonlinear Phenomena, 241(20):1680– 2010 1702.
2011 Haller, G. and Beron-Vera, F. J. (2013). Coherent Lagrangian vortices: the 2012 black holes of turbulence. Journal of Fluid Mechanics, 731:69–10.
2013 Haller, G., Hadjighasem, A., Farazmand, M., and Huhn, F. (2016). Deﬁning 2014 coherent vortices objectively from the vorticity. Journal of Fluid Mechanics, 2015 795:136–173.
2016 Haller, G. and Sapsis, T. (2011). Lagrangian coherent structures and the 2017 smallest ﬁnite-time lyapunov exponent. Chaos: An Interdisciplinary Journal 2018 of Nonlinear Science, 21(2):023115.
2019 Haller, G. and Yuan, G. (2000). Lagrangian coherent structures and mixing 2020 in two-dimensional turbulence. Physica D, 147(3-4):352 – 370.
2021 Halliwell, G. and Garraﬀo, Z. D. (2002). Synthetic Floats, Drifters, and 2022 Moorings in HYCOM. Technical report, HYCOM Consortium.
2023 Haza, A., O¨ zgo¨kmen, T., and Hogan, P. (2016). Impact of submesoscales on 2024 surface material distribution in a gulf of mexico mesoscale eddy. Ocean 2025 Modelling, 107:28 – 47.
2026 Haza, A. C., O¨ zg¨okmen, T. M., Griﬀa, A., Molcard, A., Poulain, P.-M., 2027 and Peggion, G. (2010). Transport properties in small-scale coastal ﬂows: 2028 relative dispersion from VHF radar measurements in the Gulf of La Spezia. 2029 Ocean Dyn., 60(4):861–882.
2030 Heemink, A. W. (1990). Stochastic Modeling of Dispersion in Shallow-Water. 2031 Stochastic Hydrology and Hydraulics, 4(2):161–174.
2032 Hegerl, G. C., Black, E., Allan, R. P., Ingram, W. J., Polson, D., Trenberth, 2033 K. E., Chadwick, R. S., Arkin, P. A., Sarojini, B. B., Becker, A., Dai, A., 2034 Durack, P. J., Easterling, D., Fowler, H. J., Kendon, E. J., Huﬀman, G. J., 2035 Liu, C., Marsh, R., New, M., Osborn, T. J., Skliris, N., Stott, P. A., Vidale, 2036 P.-L., Wijﬀels, S. E., Wilcox, L. J., Willett, K. M., and Zhang, X. (2015). 2037 Challenges in Quantifying Changes in the Global Water Cycle. Bulletin of 2038 the American Meteorological Society, 96(7):1097–1115.
75

2039 Held, I. M. and Soden, B. J. (2006). Robust responses of the hydrological 2040 cycle to global warming. Journal of Climate, 19(21):5686–5699.
2041 Hellweger, F. L., van Sebille, E., and Fredrick, N. D. (2014). Biogeographic 2042 patterns in ocean microbes emerge in a neutral agent-based model. Science, 2043 345:1346–1349.
2044 Helm, K. P., Bindoﬀ, N. L., and Church, J. A. (2010). Changes in the 2045 global hydrological-cycle inferred from ocean salinity. Geophysical Research 2046 Letters, 37.
2047 Hofmann, A. F., Soetaert, K., and Middelburg, J. J. (2008). Present nitrogen 2048 and carbon dynamics in the Scheldt estuary using a novel 1-D model. 2049 Biogeosciences, 5(4):981–1006.
2050 Holstein, D. M., Paris, C. B., and Mumby, P. M. (2014). Consistency and 2051 inconsistency in multispecies population network dynamics of coral reef 2052 ecosystems. Marine Ecology Progress Series, 499:1–18.
2053 Holzer, M. and Hall, T. M. (2000). Transit-Time and Tracer-Age Distributions 2054 in Geophysical Flows. Journal of the Atmospheric Sciences, 57(21):3539– 2055 3558.
2056 Hosoda, S., Suga, T., Shikama, N., and Mizuno, K. (2009). Global Surface 2057 Layer Salinity Change Detected by Argo and Its Implication for Hydrological 2058 Cycle Intensiﬁcation. Journal of Oceanography, 65(4):579–586.
2059 Hunter, J., Craig, P., and Phillips, H. (1993). On the use of random walk 2060 models with spatially variable diﬀusivity. Journal of Computational Physics, 2061 106(2):366–376.
2062 Ilıcak, M., Adcroft, A. J., Griﬃes, S. M., and Hallberg, R. W. (2012). Spurious 2063 dianeutral mixing and the role of momentum closure. Ocean Modelling, 2064 45:37–58.
2065 Imasato, N., Awaji, T., and Kunishi, H. (1980). Tidal exchange through 2066 naruto, akashi and kitan straits. Journal of the Oceanographical Society of 2067 Japan, 36(3):151–162.
2068 Imasato, N. and Qiu, B. (1987). An event in water exchange between 2069 continental shelf and the kuroshio oﬀ southern japan: Lagrangian tracking of
76

2070 a low-salinity water mass on the kuroshio. Journal of physical oceanography, 2071 17(7):953–968.
2072 Iudicone, D., Rodgers, K., Stendardo, I., Aumont, O., Madec, G., Bopp, L., 2073 Mangoin, O., and d’Alcala, M. R. (2011). Water masses as a unifying frame2074 work for understanding the Southern Oocean Carbon Cycle. Biogeosciences, 2075 8:1031–1052.
2076 Jazwinski, A. H. (1970). Stochastic Processes and Filtering Theory. Academic 2077 Press, New York.
2078 Jones, B. T., Solow, A., and Ji, R. (2016). Resource allocation for lagrangian 2079 tracking. Journal of Atmospheric and Oceanic Technology, 33(6):1225–1235.
2080 J¨onsson, B. F., Lundberg, P. a., and D¨o¨os, K. (2004). Baltic sub-basin 2081 turnover times examined using the Rossby Centre Ocean model. Ambio, 2082 33(4-5):257–60.
2083 Jo¨nsson, B. F., Salisbury, J. E., and Mahadevan, A. (2011). Large variability 2084 in continental shelf production of phytoplankton carbon revealed by satellite. 2085 Biogeosciences, 8(5):1213–1223.
2086 Jonsson, B. F. and Watson, J. R. (2016). The timescales of global surface2087 ocean connectivity. Nature Communications, 7:1–6.
2088 Jutzeler, M., Marsh, R., Carey, R. J., White, J. D. L., Talling, P. J., and 2089 Karlstrom, L. (2014). On the fate of pumice rafts formed during the 2012 2090 Havre submarine eruption. Nature Communications, 5:3660.
2091 Kamenkovich, I., Rypina, I. I., and Berloﬀ, P. (2015). Properties and origins 2092 of the anisotropic eddy-induced transport in the north atlantic. Journal of 2093 Physical Oceanography, 45(3):778–791.
2094 Karrasch, D. and Haller, G. (2013). Do ﬁnite-size lyapunov exponents detect 2095 coherent structures? Chaos: An Interdisciplinary Journal of Nonlinear 2096 Science, 23(4):043126.
2097 Khatiwala, S., Visbeck, M., and Schlosser, P. (2001). Age tracers in an 2098 ocean GCM. Deep-Sea Research Part I: Oceanographic Research Papers, 2099 48(6):1423–1441.
77

2100 Kinlan, B. and Gaines, S. (2003). Propagule dispersal in marine and terrestrial 2101 environments: a community perspective. Ecology, 84(8):2007–2020.
2102 Kjellsson, J. and Do¨o¨s, K. (2012a). Lagrangian decomposition of the hadley 2103 and ferrel cells. Geophys. Res. Lett., 39:L15807.
2104 Kjellsson, J. and Do¨o¨s, K. (2012b). Surface drifters and model trajectories in 2105 the baltic sea. Boreal Environment Research, 17:447–459.
2106 Kjellsson, J., Doos, K., Laliberte, F. B., and Zika, J. D. (2014). The Atmo2107 spheric General Circulation in Thermodynamical Coordinates. Journal of 2108 the Atmospheric Sciences, 71(3):916–928.
2109 Klocker, A. and Abernathey, R. (2014). Global patterns of mesoscale eddy 2110 properties and diﬀusivities. J. Phys. Oceanogr., 44:1030–1047.
2111 Klocker, A., Ferrari, R., and LaCasce, J. H. (2012a). Estimating suppression 2112 of eddy mixing by mean ﬂow. J. Phys. Oceanogr., 9:1566–1576.
2113 Klocker, A., Ferrari, R., LaCasce, J. H., and Merriﬁeld, S. T. (2012b). Recon2114 ciling ﬂoat-based and tracer-based estimates of lateral diﬀusivities. Journal 2115 of Marine Research, 70(4):569–602.
2116 Kloeden, P. E. and Platen, E. (1992). Numerical solutions of Stochastic 2117 Diﬀerential equations. Application of Mathematics,Stochastic Modelling 2118 and applied probability. Springer-Verlag, Berlin Heidelberg.
2119 Koch-Larrouy, A., Morrow, R., Penduﬀ, T., and Juza, M. (2010). Origin and 2120 mechanism of Subantarctic Mode Water formation and transformation in 2121 the Southern Indian Ocean. Ocean Dynamics, 60(3):563–583.
2122 Kool, J. T., Moilanen, A., and Treml, E. A. (2013). Population connectivity: 2123 recent advances and new perspectives. Landscape Ecology, 28(2):165–185.
2124 Koszalka, I. and LaCasce, J. H. (2010). Lagrangian analysis by clustering. 2125 Ocean Dynamics, 60(4):957–972.
2126 Koszalka, I., LaCasce, J. H., Andersson, M., Orvik, K. A., and Mauritzen, C. 2127 (2011). Surface circulation in the Nordic Seas from clustered drifters. Deep 2128 Sea Res. I, 58(4):468–485.
78

2129 Koszalka, I., LaCasce, J. H., and Mauritzen, C. (2013a). In pursuit of 2130 anomalies - analyzing the poleward transport of Atlantic Water with 2131 surface drifters. Deep Sea Res. II, 85:96–108.
2132 Koszalka, I., LaCasce, J. H., and Orvik, K. A. (2009). Relative dispersion in 2133 the Nordic Seas. J. Mar. Res., 67:411–433.
2134 Koszalka, I. M., Haine, T. W. N., and Magaldi, M. G. (2013b). Fates and 2135 travel times of Denmark Strait Overﬂow Water in the Irminger Basin. J. 2136 Phys. Oceanogr., 43(12):2611–2628.
2137 Koszalka, I. M., Haine, T. W. N., and Magaldi, M. G. (2013c). Fates and 2138 Travel Times of Denmark Strait Overﬂow Water in the Irminger Basin. 2139 Journal of Physical Oceanography, 43(12):2611–2628.
2140 Kruggel-Emden, H., Sturm, M., Wirtz, S., and Scherer, V. (2008). Selection 2141 of an appropriate time integration scheme for the discrete element method 2142 (DEM). Comput. Chem. Eng., 32(10):2263–2279.
2143 Kundu, P. K., Cohen, I. M., and Dowling, D. R. (2012). Chapter 3 - kinematics. 2144 In Fluid Mechanics, pages 65 – 93. Academic Press, Boston, ﬁfth edition.
2145 LaCasce, J. (2008). Statistics from lagrangian observations. Progress in 2146 Oceanography, 77(1):1–29.
2147 LaCasce, J. H. (2005). Eulerian and Lagrangian velocity distributions in the 2148 North Atlantic. Journal of Physical Oceanography, 35(12):2327–2336.
2149 LaCasce, J. H., Ferrari, R., Marshall, J., Tulloch, R., Balwada, D., and Speer, 2150 K. (2014). Float-Derived Isopycnal Diﬀusivities in the DIMES Experiment. 2151 Journal of Physical Oceanography, 44(2):764–780.
2152 Laliberte, F., Zika, J. D., Mudryk, L., Kushner, P. J., Kjellsson, J., and Do¨o¨s, 2153 K. (2015). Constrained work output of the moist atmospheric heat engine 2154 in a warming climate. Science, 347(6221):540–543.
2155 Lampert, W. (1989). The adaptive signiﬁcance of diel vertical migration of 2156 zooplankton. Functional Ecology, 3(1):21–27.
2157 Lange, M. and van Sebille, E. (2017). Parcels v0.9: prototyping a lagrangian 2158 ocean analysis tool for the petascale age. Geoscientiﬁc Model Development 2159 Discussions, in review.
79

2160 Lapeyre, G. (2002). Characterization of ﬁnite-time lyapunov exponents and 2161 vectors in two-dimensional turbulence. Chaos: An Interdisciplinary Journal 2162 of Nonlinear Science, 12(3):688–698.
2163 Lebedev, K. V., Yoshinari, H., Maximenko, N. A., and Hacker, P. (2007). 2164 YoMaHa’05: Velocity data derived from trajectories of Argo ﬂoats at 2165 parking level and at the sea surface. Technical report, IPRC Technical 2166 Note.
2167 Lebreton, L. C. M., Greer, S. D., and Borerro, J. C. (2012). Numerical 2168 modelling of ﬂoating debris in the world’s oceans. Marine Pollution Bulletin, 2169 64:653–661.
2170 Ledwell, J. R., St. Laurent, L. C., Girton, J. B., and Toole, J. M. (2011). 2171 Diapycnal Mixing in the Antarctic Circumpolar Current. Journal of Physical 2172 Oceanography, 41(1):241–246.
2173 Lehahn, Y., d’Ovidio, F., Levy, M., and Heifetz, E. (2007). Stirring of 2174 the northeast Atlantic spring bloom: A Lagrangian analysis based on 2175 multisatellite data. J. Geophys. Res., 112(C8):C08005.
2176 Leimkuhler, B. and Reich, S. (2004). Simulating Hamiltonian dynamics, 2177 volume 14. Cambridge University Press.
2178 Lett, C., Verley, P., and Mullon C, e. (2008). A lagrangian tool for modelling 2179 ichthyoplankton dynamics. Environ. Model Softw., 23:1210–1214.
2180 Lique, C., Treguier, A. M., Blanke, B., and Grima, N. (2010). On the origins 2181 of water masses exported along both sides of Greenland: A Lagrangian 2182 model analysis. Journal of Geophysical Research, 115(C5):C05019.
2183 Liu, G. and Chua, V. P. (2016). A SUNTANS-based unstructured grid local 2184 exact particle tracking model. Ocean Dynamics, pages 1–11.
2185 Lumpkin, R. and Elipot, S. (2010). Surface drifter pair spreading in the North 2186 Atlantic. J. Geophys. Res., 115.
2187 Lumpkin, R. and Johnson, G. C. (2013). Global ocean surface velocities from 2188 drifters: Mean, variance, enso response, and sea- sonal cycle. J. Geophys. 2189 Res. Oceans, 118:2992–3006.
80

2190 Lumpkin, R. and Pazos, M. (2007). Measuring surface currents with surface 2191 velocity program drifters: the instrument, its data, and some recent results. 2192 In Griﬀa, A., Kirwan, Jr, A. D., Mariano, A. J., and Rossby, H. T., 2193 editors, Lagrangian Analysis and Prediction of Coastal and Ocean Dynamics. 2194 Cambridge University Press.
2195 Lynch, D. R., Greenberg, D. A., Bilgili, A., McGillicuddy Jr, D. J., Manning, 2196 J. P., and Aretxabaleta, A. L. (2014). Individual-based models – biotic 2197 particles. In Particles in the Coastal Ocean Theory and Applications. 2198 Cambridge University Press.
2199 Madec, G. (2008). Nemo ocean engine. Technical report, Note du Pole de 2200 modlisation de l’Institut Pierre-Simon No 27, ISSN no.
2201 Madec, G. and NEMO team (2016). NEMO Ocean Engine. Technical report, 2202 Institut Pierre-Simon Laplace (IPSL).
2203 Marsden, J. E., Pekarsky, S., and Shkoller, S. (1999). Stability of relative 2204 equilibria of point vortices on a sphere and symplectic integrators. Nuovo 2205 cimento della Societ`a italiana di ﬁsica. C, 22(6):793–802.
2206 Marsh, R., Ivchenko, V. O., Skliris, N., Alderson, S., Bigg, G. R., Madec, 2207 G., Blaker, A. T., Aksenov, Y., Sinha, B., Coward, A. C., Le Sommer, J., 2208 Merino, N., and Zalesny, V. B. (2015). NEMO–ICB (v1.0): interactive 2209 icebergs in the NEMO ocean model globally conﬁgured at eddy-permitting 2210 resolution. Geoscientiﬁc Model Development, 8(5):1547–1562.
2211 Marshall, J., Adcroft, A., Hill, C., Perelman, L., and Heisey, C. (1997a). 2212 A ﬁnite-volume, incompressible Navier Stokes model for studies of the 2213 ocean on parallel computers. Journal of Geophysical Research-Oceans, 2214 102(C3):5753–5766.
2215 Marshall, J., Adcroft, A., Hill, C., Perelman, L., and Heisey, C. (1997b). A 2216 ﬁnite-volume, incompressible navier stokes model for studies of the ocean 2217 on parallel computers. J. Geophys. Res., 102:5753–5766.
2218 Marshall, J., Hill, C., Perelman, L., and Adcroft, A. (1997c). Hydrostatic, 2219 quasi-hystrostatic, and non-hydrostatic ocean modeling. J. Geophys. Res., 2220 102:5733–5752.
81

2221 Martin, P., Loeﬀ, M. R., Cassar, N., Vandromme, P., d’Ovidio, F., Stemmann, 2222 L., Rengarajan, R., Soares, M., Gonza´lez, H. E., Ebersbach, F., et al. (2013). 2223 Iron fertilization enhanced net community production but not downward 2224 particle ﬂux during the southern ocean iron fertilization experiment lohafex. 2225 Global Biogeochemical Cycles, 27(3):871–881.
2226 Martin, T. and Adcroft, A. (2010). Parameterizing the fresh-water ﬂux from 2227 land ice to ocean with interactive icebergs in a coupled climate model. 2228 Ocean Modelling, 34(3-4):111–124.
2229 Mazloﬀ, M. R., Heimbach, P., and Wunsch, C. (2010). An Eddy-permitting 2230 southern ocean state estimate. Journal of Physical Oceanography, 40(5):880– 2231 899.
2232 McDougall, T. J. (2003). Potential enthalpy: a conservative oceanic vari2233 able for evaluating heat content and heat ﬂuxes. Journal of Physical 2234 Oceanography, 33:945–963.
2235 McLachlan, R. I. (1999). Area preservation in computational ﬂuid dynamics. 2236 Physics Letters A, 264(1):36–44.
2237 McManus, M. A. and Woodson, C. B. (2012). Plankton distribution and 2238 ocean dispersal. The Journal of Experimental Biology, 215(6):1008–1016.
2239 Mesinger, F. and Arakawa, A. (1976). Numerical methods used in atmospheric 2240 models. GARP Publications. World Meteorological Organization.
2241 Mezi´c, I., Loire, S., Fonoberov, V. A., and Hogan, P. (2010). A New Mixing 2242 Diagnostic and Gulf Oil Spill Movement. Science, 330(6003):486–489.
2243 Middleton, J. F. and Loder, J. W. (1989). Skew ﬂuxes in polarized wave 2244 ﬁelds. Journal of Physical Oceanography, 19:68–76.
2245 Monaghan, J. J. (1992). Smoothed particle hydrodynamics. Annu. Rev. 2246 Astron. Astrophys., 30:543–574.
2247 Mouchet, A., Cornaton, F., Deleersnijder, E., and Delhez, E. (2016). Partial 2248 ages: diagnosing transport processes by means of multiple clocks. Ocean 2249 Dynamics, 66:367–386.
82

2250 Narvaez, D. A., Klinck, J. M., Powell, E. N., Hofmann, E. E., Wilkin, J., and 2251 Haidvogel, D. B. (2012a). Circulation and behavior controls on dispersal of 2252 eastern oyster (Crassostrea virginica) larvae in Delaware Bay. Journal of 2253 Marine Research, 70(2-3):411–440.
2254 Narvaez, D. A., Klinck, J. M., Powell, E. N., Hofmann, E. E., Wilkin, J., 2255 and Haidvogel, D. B. (2012b). Modeling the dispersal of eastern oyster 2256 (Crassostrea virginica) larvae in Delaware Bay. Journal of Marine Research, 2257 70(2-3):381–409.
2258 Nencioli, F., d’Ovidio, F., Doglioli, A. M., and Petrenko, A. A. (2011). Surface 2259 coastal circulation patterns by in-situ detection of Lagrangian coherent 2260 structures. Geophys. Res. Lett., 38(17):L17604.
2261 Nencioli, F., d’Ovidio, F., Doglioli, A. M., and Petrenko, A. A. (2013). In 2262 situ estimates of submesoscale horizontal eddy diﬀusivity across an ocean 2263 front. Journal of Geophysical Research: Oceans, 118(12):7066–7080.
2264 Nilsson, J. A. U., D¨o¨os, K., Ruti, P. M., Artale, V., Coward, A. C., and 2265 Brodeau, L. (2013). Observed and modeled global ocean turbulence regimes 2266 as deduced from surface trajectory data. Journal of Physical Oceanography, 2267 43:2249–2269.
2268 Olascoaga, M. J., Rypina, I. I., Brown, M. G., Beron Vera, F. J., Kocak, H., 2269 Brand, L. E., Halliwell, G. R., and Shay, L. K. (2006). Persistent transport 2270 barrier on the West Florida Shelf. Geophys. Res. Lett., 33(22).
2271 Ollitrault, M. and Rannou, J.-P. (2013). ANDRO: An Argo-Based Deep 2272 Displacement Dataset. Journal of Atmospheric and Oceanic Technology, 2273 30(4):759–788.
2274 Paris, C. B., Atema, J., Irisson, J.-O., Kingsford, M., Gerlach, G., and 2275 Guigand, C. M. (2013a). Reef Odor: A Wake Up Call for Navigation in 2276 Reef Fish Larvae. PLOS One, 8(8):e72808–8.
2277 Paris, C. B., Cowen, R. K., Claro, R., and Lindeman, K. C. (2005). Larval 2278 transport pathways from Cuban snapper (Lutjanidae) spawning aggre2279 gations based on biophysical modeling. Marine Ecology-Progress Series, 2280 296:93–106.
83

2281 Paris, C. B., Helgers, J., van Sebille, E., and Srinivasan, A. (2013b). Connec2282 tivity Modeling System: A probabilistic modeling tool for the multi-scale 2283 tracking of biotic and abiotic variability in the ocean. Environmental 2284 Modelling & Software, 42:47–54.
2285 Paris, C. B., Le H´enaﬀ, M., Aman, Z. M., Subramaniam, A., Helgers, J., 2286 Wang, D.-P., Kourafalou, V. H., and Srinivasan, A. (2012). Evolution of 2287 the Macondo Well Blowout: Simulating the Eﬀects of the Circulation and 2288 Synthetic Dispersants on the Subsea Oil Transport. Environmental Science 2289 & Technology, page 121203084426001.
2290 Pavia, E. G. and Cushman-Roisin, B. (1988). Modeling of oceanic fronts using 2291 a particle method. Journal of Geophysical Research: Oceans, 93:3554–3562.
2292 Peacock, T. and Dabiri, J. (2010). Introduction to focus issue: Lagrangian 2293 coherent structures. Chaos: An Interdisciplinary Journal of Nonlinear 2294 Science, 20(1):017501.
2295 Peacock, T. and Haller, G. (2013). Lagrangian coherent structures: The 2296 hidden skeleton of ﬂuid ﬂows. Physics today, 66(2):41.
2297 Perot, B. (2000). Conservation properties of unstructured staggered mesh 2298 schemes. Journal of Computational Physics, 159(1):58–89.
2299 Phelps, J. J., Polton, J. A., Souza, A. J., and Robinson, L. A. (2013). 2300 Hydrodynamic timescales in a hyper-tidal region of freshwater inﬂuence. 2301 Continental Shelf Research, 63:13–22.
2302 Phelps, J. J. C., Polton, J. A., Souza, A. J., and Robinson, L. A. (2015). 2303 Behaviour inﬂuences larval dispersal in shelf sea gyres: Nephrops norvegicus 2304 in the Irish Sea. Marine Ecology Progress Series, 518:177–191.
2305 Pin˜ones, A., Hofmann, E. E., Dinniman, M. S., and Klinck, J. M. (2011). 2306 Lagrangian simulation of transport pathways and residence times along the 2307 western Antarctic Peninsula. Deep Sea Research Part II: Topical Studies 2308 in Oceanography, 58(1316):1524–1539.
2309 Pierrehumbert, R. and Yang, H. (1993). Global chaotic mixing on isentropic 2310 surfaces. Journal of the atmospheric sciences, 50(15):2462–2480.
84

2311 Poje, A. C., Haza, A. C., O¨ zg¨okmen, T. M., Magaldi, M. G., and Garraﬀo, 2312 Z. D. (2010). Resolution dependent relative dispersion statistics in a 2313 hierarchy of ocean models. Ocean Modelling, 31(1-2):36–50.
2314 Poje, A. C., O¨ zg¨okmen, T. M., Lipphardt, B. L., Haus, B. K., Ryan, E. H., 2315 Haza, A. C., Jacobs, G. A., Reniers, A. J. H. M., Olascoaga, M. J., Novelli, 2316 G., Griﬀa, A., Beron Vera, F. J., Chen, S. S., Coelho, E., Hogan, P. J., 2317 Kirwan, A. D., Huntley, H. S., and Mariano, A. J. (2014). Submesoscale 2318 dispersion in the vicinity of the Deepwater Horizon spill. Proceedings of 2319 the National Academy of Sciences, 111(35):12693–12698.
2320 Pujolar, J. M., Schiavina, M., Di Franco, A., Meli`a, P., Guidetti, P., Gatto, 2321 M., De Leo, G. A., and Zane, L. (2013). Understanding the eﬀectiveness of 2322 marine protected areas using genetic connectivity patterns and Lagrangian 2323 simulations. Diversity and Distributions, 19(12):1531–1542.
2324 Qin, X., van Sebille, E., and Gupta, A. S. (2014). Quantiﬁcation of errors 2325 induced by temporal resolution on lagrangian particles in an eddy-resolving 2326 model. Ocean Modelling, 76:20–30.
2327 Redi, M. H. (1982). Oceanic isopycnal mixing by coordinate rotation. Journal 2328 of physical Oceanography, 12(10):1154–1158.
2329 Reverdin, G., Morisset, S., Mari´e, L., Bourras, D., Sutherland, G., Ward, 2330 B., Salvador, J., Font, J., Cuypers, Y., Centurioni, L., Hormann, V., 2331 Koldziejczyk, N., Boutin, J., D’Ovidio, F., Nencioli, F., Martin, N., Diverres, 2332 D., Alory, G., and Lumpkin, R. (2015). Surface salinity in the North 2333 Atlantic subtropical gyre during the STRASSE/SPURS summer 2012 2334 cruise. Oceanography, 28:114–123.
2335 Ringler, T., Petersen, M., Higdon, R. L., Jacobsen, D., Jones, P. W., and 2336 Maltrud, M. (2013). A multi-resolution approach to global ocean modeling. 2337 Ocean Modelling, 69:211–232.
2338 Ringler, T. D., Saenz, J. A., Wolfram, P. J., and van Roekel, L. (2016). 2339 A thickness-weighted average perspective of force balance in an idealized 2340 circumpolar current. Journal of Physical Oceanography.
2341 Roche, D. M. (2013). δ18O water isotope in the iloveclim model (version 1.0) 2342 part 1: Implementation and veriﬁcation. Geoscientiﬁc Model Development, 2343 6(5):1481–1491.
85

2344 Ross, O. N. and Sharples, J. (2004). Recipe for 1-D Lagrangian particle 2345 tracking models in space-varying diﬀusivity. Limnol. Oceanogr.: Methods, 2346 pages 289–302.
2347 Rossi, V., van Sebille, E., Sen Gupta, A., Gar¸con, V., and England, M. H. 2348 (2013). Deep-Sea Research I. Deep-Sea Research Part I-Oceanographic 2349 Research Papers, 80(C):37–46.
2350 Ru¨hs, S., Durgadoo, J. V., Behrens, E., and Biastoch, A. (2013). Advective 2351 timescales and pathways of Agulhas leakage. Geophysical Research Letters, 2352 40(15):3997–4000.
2353 Rypina, I., Kamenkovich, I., Berloﬀ, P., and Pratt, L. (2012). Eddy-induced 2354 particle dispersion in the upper-ocean north atlantic. Journal of Physical 2355 Oceanography, 42:2206–2228.
2356 Rypina, I., Scott, S., Pratt, L., and Brown, M. (2011). Investigating the 2357 connection between complexity of isolated trajectories and lagrangian 2358 coherent structures. Nonlinear Processes in Geophysics, 18(6):977–987.
2359 Salama, N. K. G. and Rabe, B. (2013). Developing models for investigating 2360 the environmental transmission of disease-causing agents within open-cage 2361 salmon aquaculture. Aquaculture Environment Interactions, 4(2):91–115.
2362 Salmon, R. (1998). Lectures on Geophysical Fluid Dynamics. Oxford Univer2363 sity Press, Oxford, England. 378 + xiii pp.
2364 Sammarco, P. W., Brazeau, D. A., and Sinclair, J. (2012). Genetic connectivity 2365 in scleractinian corals across the northern gulf of mexico: Oil/gas platforms, 2366 and relationship to the ﬂower garden banks. PLoS ONE, 7(4):e30144.
2367 Schroeder, K., Haza, A. C., Griﬀa, A., O¨ zg¨okmen, T. M., Poulain, P. M., 2368 Gerin, R., Peggion, G., and Rixen, M. (2011). Relative dispersion in the 2369 Liguro-Provencal basin: From sub-mesoscale to mesoscale. Deep Sea Res. 2370 I, 58(3):209–228.
2371 Scott, R., Biastoch, A., Roder, C., Stiebens, V. A., and Eizaguirre, C. (2014). 2372 Nano-tags for neonates and ocean-mediated swimming behaviours linked 2373 to rapid dispersal of hatchling sea turtles. Proceedings of the Royal Society 2374 B: Biological Sciences, 281(1796):20141209–20141209.
86

2375 Shah, S., Primeau, F., Deleersnijder, E., and Heemink, A. (2017). Tracing 2376 the ventilation pathways of the deep North Paciﬁc Ocean using Lagrangian 2377 particles and Eulerian tracers. Journal of Physical Oceanography, 47:1261– 2378 1280.
2379 Shah, S. H. A. M., Heemink, A. W., and Deleersnijder, E. (2011). Assessing 2380 lagrangian schemes for simulating diﬀusion on non-ﬂat isopycnal surfaces. 2381 Ocean Modelling, 39(3–4):351–361.
2382 Shah, S. H. A. M., Heemink, A. W., Gra¨we, U., and Deleersnijder, E. (2013). 2383 Adaptive time stepping algorithm for lagrangian transport models: Theory 2384 and idealised test cases. Ocean Modelling, 68:9–21.
2385 Shchepetkin, A. F. and McWilliams, J. C. (2005). The regional oceanic mod2386 eling system (ROMS): a split-explicit, free-surface, topography-following2387 coordinate oceanic model. Ocean Modelling, 9(4):347–404.
2388 Shevchenko, I. V. and Berloﬀ, P. S. (2015). Multi-layer quasi-geostrophic 2389 ocean dynamics in Eddy-resolving regimes. Ocean Modelling, 94(C):1–14.
2390 Simons, R. D., Siegel, D. A., and Brown, K. S. (2013). Model sensitivity 2391 and robustness in the estimation of larval transport: a study of particle 2392 tracking parameters. Journal of Marine Systems, 119.
2393 Skliris, N., Marsh, R., Josey, S. A., Good, S. A., Liu, C., and Allan, R. P. 2394 (2014). Salinity changes in the World Ocean since 1950 in relation to 2395 changing surface freshwater ﬂuxes. Climate Dynamics, 43(3-4):709–736.
2396 Skliris, N., Zika, J., Nurser, A., Josey, S. A., and Marsh, R. (2016). Global 2397 water cycle amplifying at less than the Clausius-Clapeyron rate. Scientiﬁc 2398 Reports, in press.
2399 Smetacek, V., Klaas, C., Strass, V. H., Assmy, P., Montresor, M., Cisewski, 2400 B., Savoye, N., Webb, A., d/’Ovidio, F., Arrieta, J. M., Bathmann, U., 2401 Bellerby, R., Berg, G. M., Croot, P., Gonzalez, S., Henjes, J., Herndl, 2402 G. J., Hoﬀmann, L. J., Leach, H., Losch, M., Mills, M. M., Neill, C., 2403 Peeken, I., Rottgers, R., Sachs, O., Sauter, E., Schmidt, M. M., Schwarz, J., 2404 Terbruggen, A., and Wolf Gladrow, D. (2012). Deep carbon export from a 2405 Southern Ocean iron-fertilized diatom bloom. Nature, 487(7407):313–319.
87

2406 Spagnol, S., Wolanski, E., Deleersnijder, E., Brinkman, R., McAllister, F., 2407 Cushman-Roisin, B., and Hanert, E. (2002). An error frequently made 2408 in the evaluation of advective transport in two-dimensional Lagrangian 2409 models of advection-diﬀusion in coral reef waters. Marine Ecology Progress 2410 Series, 235:299–302.
2411 Speich, S. (1992). Etude du forcage de la circulation oceanique par les detroits: 2412 cas de la Mer d’Alboran. PhD thesis, Universit´e de Paris 06.
2413 Speich, S., Blanke, B., de Vries, P., Drijfhout, S. S., Do¨o¨s, K., Ganachaud, A., 2414 and Marsh, R. (2002). Tasman leakage: A new route in the global ocean 2415 conveyor belt. Geophysical Research Letters, 29(10):1416.
2416 Speich, S., Blanke, B., and Madec, G. (2001). Warm and cold water routes of 2417 an OGCM thermohaline conveyor belt. Geophys. Res. Lett., 28(2):311–314.
2418 Spivakovskaya, D., Heemink, A. W., and Deleersnijder, E. (2007a). The 2419 backward ˆIto method for the lagrangian simulation of transport processes 2420 with large space variations of the diﬀusivity. Ocean Sciences, 3:525–535.
2421 Spivakovskaya, D., Heemink, A. W., and Deleersnijder, E. (2007b). Lagrangian 2422 modelling of multidimensional advection-diﬀusion with space-varying diﬀu2423 sivites: theory and idealized test cases. Ocean Dynamics, 57(3):189–203.
2424 Spivakovskaya, D., Heemink, A. W., Milstein, G. N., and Schoenmakers, 2425 J. G. M. (2005). Simulation of the transport particles in coastal waters 2426 usinf forward and reverse time diﬀusion. Advances in Water Resources, 2427 28(9):927–938.
2428 Staaterman, E. and Paris, C. B. (2013). Modelling larval ﬁsh navigation: the 2429 way forward. ICES Journal of Marine Science: Journal du Conseil, page 2430 fst103.
2431 Stohl, A. (1998). Computation, accuracy and applications of trajectories: a 2432 review and bibliography. Atmospheric Environment, 32(6):947 – 966.
2433 Stohl, A. and James, P. (2005). A Lagrangian analysis of the atmospheric 2434 branch of the global water cycle. Part II: Moisture transports between 2435 earth’s ocean basins and river catchments. Journal of Hydrometeorology, 2436 6(6):961–984.
88

2437 Stouﬀer, R. J. (2004). Time scales of climate response. Journal of Climate, 2438 17:209–217.
2439 Sunagawa, S., Coelho, L. P., Chaﬀron, S., Kultima, J. R., Labadie, K., 2440 Salazar, G., Djahanschiri, B., Zeller, G., Mende, D. R., Alberti, A., et al. 2441 (2015). Structure and function of the global ocean microbiome. Science, 2442 348(6237):1261359.
2443 Swift, D. D. and Riser, S. C. (1994). RAFOS ﬂoats: Deﬁning and targeting 2444 surfaces of neutral buoyancy. Journal of atmospheric and Oceanic . . . , 2445 11(4):1079–1092.
2446 Taylor, G. I. (1921). Diﬀusion by continuous movements. Proc. London Math. 2447 Soc., 20:196–212.
2448 Teske, P. R., Sandoval-Castillo, J., van Sebille, E., Waters, J., and Beheregaray, 2449 L. B. (2015). On-shelf larval retention limits population connectivity in a 2450 coastal broadcast spawner. Marine Ecology-Progress Series, 532:1–12.
2451 Thomas, C. et al. (2015a). Modelling marine connectivity in the Great Barrier 2452 Reef and exploring its ecological implications. PhD thesis, UCL.
2453 Thomas, C. J., Lambrechts, J., Wolanski, E., Traag, V. A., Blondel, V. D., 2454 Deleersnijder, E., and Hanert, E. (2014). Numerical modelling and graph 2455 theory tools to study ecological connectivity in the Great Barrier Reef. 2456 Ecological Modelling, 272:160–174.
2457 Thomas, M. D., Tr´eguier, A.-M., Blanke, B., Deshayes, J., and Voldoire, 2458 A. (2015b). A Lagrangian Method to Isolate the Impacts of Mixed Layer 2459 Subduction on the Meridional Overturning Circulation in a Numerical 2460 Model. Journal of Climate, 28:7503–7517.
2461 Treml, E. A., Halpin, P. N., Urban, D. L., and Pratson, L. F. (2008). Modeling 2462 population connectivity by ocean currents, a graph-theoretic approach for 2463 marine conservation. Landscape Ecology, 23:19–36.
2464 Trenberth, K. E. (1998). Atmospheric moisture residence times and cy2465 cling: Implications for rainfall rates and climate change. Climatic change, 2466 39(4):667–694.
89

2467 Ullman, D. S., O’Donnell, J., Kohut, J., Fake, T., and Allen, A. (2006). 2468 Trajectory prediction using HF radar surface currents: Monte Carlo simula2469 tions of prediction uncertainties. Journal of Geophysical Research: Oceans, 2470 111(C12):C12005–14.
2471 Valdivieso Da Costa, M. and Blanke, B. (2004). Lagrangian methods for ﬂow 2472 climatologies and trajectory error assessment. Ocean Modelling, 6(3-4):335– 2473 358.
2474 Vallis, G. K. (2006). Atmospheric and Oceanic Fluid Dynamics: Fundamentals 2475 and Large-scale Circulation. Cambridge University Press, Cambridge, 1st 2476 edition. 745 + xxv pp.
2477 van Sebille, E., Beal, L. M., and Johns, W. E. (2011). Advective time scales of 2478 Agulhas leakage to the North Atlantic in surface drifter observations and the 2479 3D OFES model. Journal of Physical Oceanography, 41(2002):1026–1034.
2480 van Sebille, E., Johns, W. E., and Beal, L. M. (2012). Does the vorticity ﬂux 2481 from Agulhas rings control the zonal pathway of NADW across the South 2482 Atlantic? Journal of Geophysical Research, 29:2753–2768.
2483 van Sebille, E., Scussolini, P., Durgadoo, J. V., Peeters, F. J. C., Biastoch, 2484 A., Weijer, W., Turney, C. S. M., Paris, C. B., and Zahn, R. (2015). Ocean 2485 currents generate large footprints in marine palaeoclimate proxies. Nature 2486 Communications, 6:6521.
2487 van Sebille, E., Spence, P., Mazloﬀ, M. R., England, M. H., Rintoul, S. R., 2488 and Saenko, O. A. (2013). Abyssal connections of Antarctic Bottom Water 2489 in a Southern Ocean State Estimate. Geophysical Research Letters, 40.
2490 van Sebille, E., Sprintall, J., Schwarzkopf, F. U., Sen Gupta, A., Santoso, A., 2491 England, M. H., Biastoch, A., and Bo¨ning, C. W. (2014). Paciﬁc-to-Indian 2492 Ocean connectivity: Tasman leakage, Indonesian Throughﬂow, and the role 2493 of ENSO. J. Geophys. Res. Ocean., 119(2):1365–1382.
2494 Vanderborght, J.-P., Folmer, I. M., Aguilera, D. R., Uhrenholdt, T., and 2495 Regnier, P. (2007). Reactive-transport modelling of C, N , and O2 in a 2496 river-estuarine-coastal zone system: Application to the Scheldt estuary. 2497 Marine Chemistry, 106(1-2):92–110.
90

2498 Veneziani, M., Griﬀa, A., Reynolds, A. M., and Mariano, A. J. (2004). Oceanic 2499 turbulence and stochastic models from subsurface lagrangian data for the 2500 northwest atlantic ocean. Journal of Physical Oceanography, 34(8):1884– 2501 1906.
2502 Villar, E., Farrant, G. K., Follows, M., Garczarek, L., Speich, S., Audic, S., 2503 Bittner, L., Blanke, B., Brum, J. R., Brunet, C., Casotti, R., Chase, A., 2504 Dolan, J. R., d’Ortenzio, F., Gattuso, J.-P., Grima, N., Guidi, L., Hill, C. N., 2505 Jahn, O., Jamet, J.-L., Le Goﬀ, H., Lepoivre, C., Malviya, S., Pelletier, E., 2506 Romagnan, J.-B., Roux, S., Santini, S., Scalco, E., Schwenck, S. M., Tanaka, 2507 A., Testor, P., Vannier, T., Vincent, F., Zingone, A., Dimier, C., Picheral, 2508 M., Searson, S., Kandels-Lewis, S., Tara Oceans Coordinators, Acinas, 2509 S. G., Bork, P., Boss, E., de Vargas, C., Gorsky, G., Ogata, H., Pesant, S., 2510 Sullivan, M. B., Sunagawa, S., Wincker, P., Karsenti, E., Bowler, C., Not, 2511 F., Hingamp, P., and Iudicone, D. (2015). Environmental characteristics of 2512 Agulhas rings aﬀect interocean plankton transport. Science, 348(6237).
2513 Visser, A. W. (1997). Using random walk models to simulate the vertical 2514 distribution of particles in a turbulent water column. Marine Ecology 2515 Progress Series, 158:275–281.
2516 Visser, A. W. (2008). Lagrangian modelling of plankton motion: From 2517 deceptively simple random walks to Fokker–Planck and back again. Journal 2518 of Marine Systems, 70(3-4):287–299.
2519 von Appen, W.-J., Koszalka, I. M., Pickart, R. S., Haine, T. W. N., Mastopole, 2520 D., and Magaldi, M. G. (2014). East Greenland Spill Jet as important part 2521 of the AMOC. Deep Sea Res. I, 192:75–84.
2522 Wallcraft, A. J., Metzger, E. J., and Carroll, S. N. (2009). Software design 2523 description for the HYbrid Coordinate Ocean Model (HYCOM) version 2524 2.2. Technical Report NRL/MR/7320-09-9166, NRL.
2525 Wang, B., Zhao, G., and Fringer, O. (2011). Reconstruction of vector ﬁelds 2526 for semi-lagrangian advection on unstructured, staggered grids. Ocean 2527 Modelling, 40(1):52–71.
2528 Wang, J., Mazloﬀ, M. R., and Gille, S. T. (2016,a). Cross-stream transport 2529 near the Drake Passage. Journal of Physical Oceanography (submitted), 88.
91

2530 Wang, Y., Beron-Vera, F. J., and Olascoaga, M. J. (2016b). The life cycle 2531 of a coherent Lagrangian Agulhas ring. Journal of Geophysical Research: 2532 Oceans, pages 1–11.
2533 Waugh, D. W. and Abraham, E. R. (2008). Stirring in the global surface 2534 ocean. Geophys. Res. Lett., 35(20).
2535 Waugh, D. W., Haine, T. W. N., and Hall, T. M. (2004). Transport times 2536 and anthropogenic carbon in the subpolar North Atlantic Ocean. Deep Sea 2537 Research Part I: Oceanographic Research Papers, 51(11):1475–1491.
2538 Welander, P. (1955). Studies on the general development of motion in a 2539 two-dimensional, ideal ﬂuid. Tellus, 7(2):141–156.
2540 Wilkins, D., van Sebille, E., Rintoul, S. R., Lauro, F. M., and Cavicchioli, 2541 R. (2013). Advection shapes Southern Ocean microbial assemblages in2542 dependent of distance and environment eﬀects. Nature Communications, 2543 4:1–7.
2544 Wolfram, P. J. and Ringler, T. D. (2017a). Computing eddy-driven eﬀective 2545 diﬀusivity using lagrangian particles. Ocean Modelling, 118(Supplement 2546 C):94 – 106.
2547 Wolfram, P. J. and Ringler, T. D. (2017b). Quantifying nonlinearity of eddy2548 induced mixing in an idealized circumpolar current. Journal of Physical 2549 Oceanography, 47(8):1897–1920.
2550 Wolfram, P. J., Ringler, T. D., Maltrud, M. E., Jacobsen, D. W., and Petersen, 2551 M. R. (2015). Diagnosing isopycnal diﬀusivity in an eddying, idealized 2552 midlatitude ocean basin via lagrangian, in situ, global, high-performance 2553 particle tracking (light). Journal of Physical Oceanography, 45(8):2114– 2554 2133.
2555 Wood, S., Paris, C. B., Ridgwell, A., and Hendy, E. J. (2013). Modelling 2556 dispersal and connectivity of broadcast spawning corals at the global scale. 2557 Global Ecology and Biogeography, 23:1–11.
2558 Young, W. R. and Jones, S. (1991). Shear Dispersion. Physics of Fluids 2559 a-Fluid Dynamics, 3(5):1087–1101.
92

2560 Zhurbas, V. (2004). Drifter-derived maps of lateral diﬀusivity in the Paciﬁc 2561 and Atlantic Oceans in relation to surface circulation patterns. Journal of 2562 Geophysical Research: Oceans, 109(C5):C05015. 2563 Zika, J. D., England, M. H., and Sijp, W. P. (2012). The Ocean Circulation 2564 in Thermohaline Coordinates. Journal of Physical Oceanography, 42(5):708– 2565 724.
93

